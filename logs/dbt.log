[0m17:18:47.461371 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:47.461702 [debug] [Thread-4 (]: Began executing node test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code.b2a0348868
[0m17:18:47.471138 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_airports_airport_code.b6c87dbe1e"
[0m17:18:47.472689 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code.b2a0348868"
[0m17:18:47.473129 [debug] [Thread-1 (]: Using postgres connection "test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_airports_airport_code.b6c87dbe1e"
[0m17:18:47.473352 [debug] [Thread-1 (]: On test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_airports_airport_code.b6c87dbe1e: BEGIN
[0m17:18:47.473547 [debug] [Thread-4 (]: Using postgres connection "test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code.b2a0348868"
[0m17:18:47.473705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:47.473859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m17:18:47.474010 [debug] [Thread-4 (]: On test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code.b2a0348868: BEGIN
[0m17:18:47.474215 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"
[0m17:18:47.474376 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:47.474540 [debug] [Thread-2 (]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"} */
truncate table "dbt_course"."bookings_dbt"."dbt_project_evaluator_exceptions"
[0m17:18:47.477285 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m17:18:47.477987 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"
[0m17:18:47.478730 [debug] [Thread-2 (]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: COMMIT
[0m17:18:47.478879 [debug] [Thread-2 (]: Using postgres connection "seed.dbt_project_evaluator.dbt_project_evaluator_exceptions"
[0m17:18:47.479013 [debug] [Thread-2 (]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: COMMIT
[0m17:18:47.480408 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m17:18:47.480593 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.fct_bookings"
[0m17:18:47.480754 [debug] [Thread-3 (]: On model.dbt_prod.fct_bookings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'src_flights__bookings'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m17:18:47.480926 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:47.481358 [debug] [Thread-2 (]: On seed.dbt_project_evaluator.dbt_project_evaluator_exceptions: Close
[0m17:18:47.481646 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11702b830>]}
[0m17:18:47.481903 [info ] [Thread-2 (]: 28 of 111 OK loaded seed file bookings_dbt.dbt_project_evaluator_exceptions .... [[32mINSERT 0[0m in 0.04s]
[0m17:18:47.482344 [debug] [Thread-2 (]: Finished running node seed.dbt_project_evaluator.dbt_project_evaluator_exceptions
[0m17:18:47.482523 [debug] [Thread-2 (]: Began running node model.dbt_prod.fct_flights
[0m17:18:47.482945 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:18:47.483188 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m17:18:47.482742 [info ] [Thread-2 (]: 32 of 111 START sql table model bookings_dbt.fct_flights ....................... [RUN]
[0m17:18:47.483456 [debug] [Thread-1 (]: Using postgres connection "test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_airports_airport_code.b6c87dbe1e"
[0m17:18:47.483618 [debug] [Thread-4 (]: Using postgres connection "test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code.b2a0348868"
[0m17:18:47.483801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_project_evaluator.dbt_project_evaluator_exceptions, now model.dbt_prod.fct_flights)
[0m17:18:47.483972 [debug] [Thread-1 (]: On test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_airports_airport_code.b6c87dbe1e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_airports_airport_code.b6c87dbe1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with
    
    all_values as (

        select 


            trim(airport_code) as airport_code
            
        from "dbt_course"."demo_src"."airports"

    ),

    errors as (

        select * from all_values
        where airport_code = ''

    )

    select * from errors


      
    ) dbt_internal_test
[0m17:18:47.484151 [debug] [Thread-4 (]: On test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code.b2a0348868: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code.b2a0348868"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

    with
    
    all_values as (

        select 


            trim(aircraft_code) as aircraft_code
            
        from "dbt_course"."demo_src"."seats"

    ),

    errors as (

        select * from all_values
        where aircraft_code = ''

    )

    select * from errors


      
    ) dbt_internal_test
[0m17:18:47.484323 [debug] [Thread-2 (]: Began compiling node model.dbt_prod.fct_flights
[0m17:18:47.486355 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_prod.fct_flights"
[0m17:18:47.486541 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.005 seconds
[0m17:18:47.487360 [info ] [Thread-3 (]: Column: PostgresColumn(column='book_ref', dtype='character varying', char_size=8, numeric_precision=None, numeric_scale=None)
[0m17:18:47.487622 [info ] [Thread-3 (]: Column: PostgresColumn(column='book_date', dtype='timestamp with time zone', char_size=None, numeric_precision=None, numeric_scale=None)
[0m17:18:47.487822 [info ] [Thread-3 (]: Column: PostgresColumn(column='total_amount', dtype='numeric', char_size=None, numeric_precision=10, numeric_scale=2)
[0m17:18:47.488080 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_prod.fct_bookings"
[0m17:18:47.488253 [debug] [Thread-2 (]: Began executing node model.dbt_prod.fct_flights
[0m17:18:47.489969 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_prod.fct_flights"
[0m17:18:47.490156 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m17:18:47.490308 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m17:18:47.491891 [debug] [Thread-1 (]: On test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_airports_airport_code.b6c87dbe1e: ROLLBACK
[0m17:18:47.492066 [debug] [Thread-3 (]: Began executing node model.dbt_prod.fct_bookings
[0m17:18:47.492640 [debug] [Thread-4 (]: On test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code.b2a0348868: ROLLBACK
[0m17:18:47.494484 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_prod.fct_bookings"
[0m17:18:47.494673 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.fct_flights"
[0m17:18:47.494805 [debug] [Thread-1 (]: On test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_airports_airport_code.b6c87dbe1e: Close
[0m17:18:47.494987 [debug] [Thread-2 (]: On model.dbt_prod.fct_flights: BEGIN
[0m17:18:47.495438 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:47.495585 [debug] [Thread-4 (]: On test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code.b2a0348868: Close
[0m17:18:47.495300 [info ] [Thread-1 (]: 29 of 111 PASS dbt_utils_source_not_empty_string_demo_src_airports_airport_code  [[32mPASS[0m in 0.05s]
[0m17:18:47.495891 [debug] [Thread-1 (]: Finished running node test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_airports_airport_code.b6c87dbe1e
[0m17:18:47.496399 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.fct_bookings"
[0m17:18:47.496621 [debug] [Thread-1 (]: Began running node snapshot.dbt_prod.dim_flights__aircrafts
[0m17:18:47.496205 [info ] [Thread-4 (]: 30 of 111 PASS dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code .. [[32mPASS[0m in 0.05s]
[0m17:18:47.496898 [debug] [Thread-3 (]: On model.dbt_prod.fct_bookings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_bookings"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_bookings__dbt_tmp"
  
  
    as
  
  (
    

select 
    book_ref, 
  

    book_date, 
  

    total_amount
  



 
from "dbt_course"."bookings_dbt"."src_flights__bookings"
  );
  
[0m17:18:47.497197 [info ] [Thread-1 (]: 33 of 111 START snapshot snapshot.dim_flights__aircrafts ....................... [RUN]
[0m17:18:47.497446 [debug] [Thread-4 (]: Finished running node test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code.b2a0348868
[0m17:18:47.497666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_airports_airport_code.b6c87dbe1e, now snapshot.dbt_prod.dim_flights__aircrafts)
[0m17:18:47.497874 [debug] [Thread-4 (]: Began running node model.dbt_prod.fct_ticket_flights
[0m17:18:47.498096 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_prod.dim_flights__aircrafts
[0m17:18:47.498349 [info ] [Thread-4 (]: 34 of 111 START sql table model bookings_dbt.fct_ticket_flights ................ [RUN]
[0m17:18:47.500063 [debug] [Thread-1 (]: Began executing node snapshot.dbt_prod.dim_flights__aircrafts
[0m17:18:47.500270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_prod.dbt_utils_source_not_empty_string_demo_src_seats_aircraft_code.b2a0348868, now model.dbt_prod.fct_ticket_flights)
[0m17:18:47.512522 [debug] [Thread-4 (]: Began compiling node model.dbt_prod.fct_ticket_flights
[0m17:18:47.519098 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m17:18:47.521458 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.522752 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_prod.fct_ticket_flights"
[0m17:18:47.522912 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.fct_flights"
[0m17:18:47.523057 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */
select * from (
        select aircraft_code, model, range from (
                




select 
aircraft_code,
 model,
"range"

from "dbt_course"."bookings_dbt"."stg_flights__aircrafts"


            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m17:18:47.523232 [debug] [Thread-2 (]: On model.dbt_prod.fct_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_flights"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_flights__dbt_tmp"
  
  
    as
  
  (
    

select 
    flight_id, 
   md5(cast(coalesce(cast(flight_no as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) surrogat_k, 
    flight_no
    scheduled_departure, 
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure, 
    actual_arrival
    
from "dbt_course"."bookings_dbt"."src_flights__flights"
  );
  
[0m17:18:47.523399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:47.523640 [debug] [Thread-4 (]: Began executing node model.dbt_prod.fct_ticket_flights
[0m17:18:47.529609 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_ticket_flights"
[0m17:18:47.529799 [debug] [Thread-4 (]: On model.dbt_prod.fct_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_ticket_flights"} */
select * from (
        

select
  ticket_no, 
   flight_id, 
   fare_conditions, 
   amount
from "dbt_course"."bookings_dbt"."stg_flights__ticket_flights"
    ) as __dbt_sbq
    where false
    limit 0

[0m17:18:47.529918 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:47.530388 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.007 seconds
[0m17:18:47.531621 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.531771 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: BEGIN
[0m17:18:47.532086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m17:18:47.532221 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.532337 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__aircrafts'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:47.534707 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.005 seconds
[0m17:18:47.538762 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_ticket_flights"
[0m17:18:47.538936 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m17:18:47.539087 [debug] [Thread-4 (]: On model.dbt_prod.fct_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_ticket_flights"} */
select * from (
        select
    
      
    cast(null as bpchar(13))
 as ticket_no, 
      
    cast(null as int4)
 as flight_id, 
      
    cast(null as varchar(10))
 as fare_conditions, 
      
    cast(null as numeric(10, 2))
 as amount
    ) as __dbt_sbq
    where false
    limit 0

[0m17:18:47.541485 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.541672 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__aircrafts'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:47.542002 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.000 seconds
[0m17:18:47.549322 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.007 seconds
[0m17:18:47.550390 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_prod.fct_ticket_flights"
[0m17:18:47.564677 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.564932 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */

        
  
    

  create temporary table "dim_flights__aircrafts__dbt_tmp171847564270"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        




select 
aircraft_code,
 model,
"range"

from "dbt_course"."bookings_dbt"."stg_flights__aircrafts"



    ),

    snapshotted_data as (

        select *, 
    
        aircraft_code as dbt_unique_key
    

        from "dbt_course"."snapshot"."dim_flights__aircrafts"
        where
            
		
		

		
                ( (dbt_effective_date_to = '9999-01-01'::date)
 or dbt_effective_date_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        aircraft_code as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_effective_date_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), '9999-01-01'::date)
  as dbt_effective_date_to
,
            md5(coalesce(cast(aircraft_code as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        aircraft_code as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_effective_date_from,
            now()::timestamp without time zone as dbt_effective_date_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."aircraft_code" != source_data."aircraft_code"
        or
        (
            ((snapshotted_data."aircraft_code" is null) and not (source_data."aircraft_code" is null))
            or
            ((not snapshotted_data."aircraft_code" is null) and (source_data."aircraft_code" is null))
        ) or snapshotted_data."model" != source_data."model"
        or
        (
            ((snapshotted_data."model" is null) and not (source_data."model" is null))
            or
            ((not snapshotted_data."model" is null) and (source_data."model" is null))
        ) or snapshotted_data."range" != source_data."range"
        or
        (
            ((snapshotted_data."range" is null) and not (source_data."range" is null))
            or
            ((not snapshotted_data."range" is null) and (source_data."range" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."aircraft_code" != source_data."aircraft_code"
        or
        (
            ((snapshotted_data."aircraft_code" is null) and not (source_data."aircraft_code" is null))
            or
            ((not snapshotted_data."aircraft_code" is null) and (source_data."aircraft_code" is null))
        ) or snapshotted_data."model" != source_data."model"
        or
        (
            ((snapshotted_data."model" is null) and not (source_data."model" is null))
            or
            ((not snapshotted_data."model" is null) and (source_data."model" is null))
        ) or snapshotted_data."range" != source_data."range"
        or
        (
            ((snapshotted_data."range" is null) and not (source_data."range" is null))
            or
            ((not snapshotted_data."range" is null) and (source_data."range" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m17:18:47.565238 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_ticket_flights"
[0m17:18:47.565374 [debug] [Thread-4 (]: On model.dbt_prod.fct_ticket_flights: BEGIN
[0m17:18:47.565829 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m17:18:47.565982 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_ticket_flights"
[0m17:18:47.566094 [debug] [Thread-4 (]: On model.dbt_prod.fct_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_ticket_flights"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_ticket_flights__dbt_tmp"
  
  
    
  
  (
    ticket_no bpchar(13),
    flight_id int4 not null,
    fare_conditions varchar(10),
    amount numeric(10, 2) check (amount > 0)
    
    )
 ;
    insert into "dbt_course"."bookings_dbt"."fct_ticket_flights__dbt_tmp" (
      ticket_no, flight_id, fare_conditions, amount
    )
  
  (
    
    select ticket_no, flight_id, fare_conditions, amount
    from (
        

select
  ticket_no, 
   flight_id, 
   fare_conditions, 
   amount
from "dbt_course"."bookings_dbt"."stg_flights__ticket_flights"
    ) as model_subq
  );
  
[0m17:18:47.566783 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m17:18:47.567865 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.567997 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__aircrafts__dbt_tmp171847564270'
        
      order by ordinal_position

  
[0m17:18:47.569342 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:18:47.570726 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.570877 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__aircrafts'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:47.572030 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.001 seconds
[0m17:18:47.573075 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.573198 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__aircrafts__dbt_tmp171847564270'
        
      order by ordinal_position

  
[0m17:18:47.574333 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:18:47.575909 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.576085 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__aircrafts'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:47.577482 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.001 seconds
[0m17:18:47.580012 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.580158 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__aircrafts__dbt_tmp171847564270'
        
      order by ordinal_position

  
[0m17:18:47.581302 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:18:47.586471 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.586719 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */
select * from (
        
    
    with snapshot_query as (

        




select 
aircraft_code,
 model,
"range"

from "dbt_course"."bookings_dbt"."stg_flights__aircrafts"



    ),

    snapshotted_data as (

        select *, 
    
        aircraft_code as dbt_unique_key
    

        from "dbt_course"."snapshot"."dim_flights__aircrafts"
        where
            
		
		

		
                ( (dbt_effective_date_to = '9999-01-01'::date)
 or dbt_effective_date_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        aircraft_code as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_effective_date_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), '9999-01-01'::date)
  as dbt_effective_date_to
,
            md5(coalesce(cast(aircraft_code as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        aircraft_code as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_effective_date_from,
            now()::timestamp without time zone as dbt_effective_date_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."aircraft_code" != source_data."aircraft_code"
        or
        (
            ((snapshotted_data."aircraft_code" is null) and not (source_data."aircraft_code" is null))
            or
            ((not snapshotted_data."aircraft_code" is null) and (source_data."aircraft_code" is null))
        ) or snapshotted_data."model" != source_data."model"
        or
        (
            ((snapshotted_data."model" is null) and not (source_data."model" is null))
            or
            ((not snapshotted_data."model" is null) and (source_data."model" is null))
        ) or snapshotted_data."range" != source_data."range"
        or
        (
            ((snapshotted_data."range" is null) and not (source_data."range" is null))
            or
            ((not snapshotted_data."range" is null) and (source_data."range" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."aircraft_code" != source_data."aircraft_code"
        or
        (
            ((snapshotted_data."aircraft_code" is null) and not (source_data."aircraft_code" is null))
            or
            ((not snapshotted_data."aircraft_code" is null) and (source_data."aircraft_code" is null))
        ) or snapshotted_data."model" != source_data."model"
        or
        (
            ((snapshotted_data."model" is null) and not (source_data."model" is null))
            or
            ((not snapshotted_data."model" is null) and (source_data."model" is null))
        ) or snapshotted_data."range" != source_data."range"
        or
        (
            ((snapshotted_data."range" is null) and not (source_data."range" is null))
            or
            ((not snapshotted_data."range" is null) and (source_data."range" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m17:18:47.587350 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m17:18:47.588421 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.588544 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m17:18:47.588901 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m17:18:47.589089 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.589411 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.589545 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__aircrafts"} */

      update "dbt_course"."snapshot"."dim_flights__aircrafts"
    set dbt_effective_date_to = DBT_INTERNAL_SOURCE.dbt_effective_date_to
    from "dim_flights__aircrafts__dbt_tmp171847564270" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dbt_course"."snapshot"."dim_flights__aircrafts".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and ("dbt_course"."snapshot"."dim_flights__aircrafts".dbt_effective_date_to = '9999-01-01'::date or "dbt_course"."snapshot"."dim_flights__aircrafts".dbt_effective_date_to is null);
      


    insert into "dbt_course"."snapshot"."dim_flights__aircrafts" ("aircraft_code", "model", "range", "dbt_updated_at", "dbt_effective_date_from", "dbt_effective_date_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."aircraft_code",DBT_INTERNAL_SOURCE."model",DBT_INTERNAL_SOURCE."range",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_effective_date_from",DBT_INTERNAL_SOURCE."dbt_effective_date_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "dim_flights__aircrafts__dbt_tmp171847564270" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:18:47.590156 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m17:18:47.590609 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: COMMIT
[0m17:18:47.590724 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__aircrafts"
[0m17:18:47.590834 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: COMMIT
[0m17:18:47.593689 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:18:47.594954 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__aircrafts: Close
[0m17:18:47.595191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116aad190>]}
[0m17:18:47.595513 [info ] [Thread-1 (]: 33 of 111 OK snapshotted snapshot.dim_flights__aircrafts ....................... [[32mINSERT 0 0[0m in 0.10s]
[0m17:18:47.595713 [debug] [Thread-1 (]: Finished running node snapshot.dbt_prod.dim_flights__aircrafts
[0m17:18:47.595853 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.stg_exposure_relationships
[0m17:18:47.596038 [info ] [Thread-1 (]: 35 of 111 START sql view model bookings_dbt.stg_exposure_relationships ......... [RUN]
[0m17:18:47.596180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_prod.dim_flights__aircrafts, now model.dbt_project_evaluator.stg_exposure_relationships)
[0m17:18:47.596296 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.stg_exposure_relationships
[0m17:18:47.597759 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_exposure_relationships"
[0m17:18:47.598042 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.stg_exposure_relationships
[0m17:18:47.599551 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.stg_exposure_relationships"
[0m17:18:47.599794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m17:18:47.599906 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_exposure_relationships: BEGIN
[0m17:18:47.600011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:47.604966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m17:18:47.605174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m17:18:47.605308 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposure_relationships"} */

  create view "dbt_course"."bookings_dbt"."stg_exposure_relationships__dbt_tmp"
    
    
  as (
    with 

_base_exposure_relationships as (
    select * from "dbt_course"."bookings_dbt"."base_exposure_relationships"
),

final as (
    select 
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id, 
        *
    from _base_exposure_relationships
)

select distinct * from final
  );
[0m17:18:47.606451 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m17:18:47.607583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m17:18:47.607709 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposure_relationships"} */
alter table "dbt_course"."bookings_dbt"."stg_exposure_relationships__dbt_tmp" rename to "stg_exposure_relationships"
[0m17:18:47.608204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.609231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m17:18:47.609391 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposure_relationships"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'stg_exposure_relationships'
);
      
[0m17:18:47.609886 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:47.610512 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.610697 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.610823 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.610944 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.611061 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.611204 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.611378 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.611516 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.611636 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.611834 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.611960 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.612082 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.612198 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.612310 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.612424 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.612536 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.612647 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.612759 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.612867 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.612963 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.613061 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.613175 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.613286 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.613389 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.613502 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.613605 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.613714 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.613818 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.613926 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.614040 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.614142 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.614294 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.614439 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_exposure_relationships: COMMIT
[0m17:18:47.614539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m17:18:47.614632 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_exposure_relationships: COMMIT
[0m17:18:47.618135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:18:47.619072 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."stg_exposure_relationships__dbt_backup"
[0m17:18:47.619482 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_exposure_relationships"
[0m17:18:47.619589 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_exposure_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_exposure_relationships"} */
drop view if exists "dbt_course"."bookings_dbt"."stg_exposure_relationships__dbt_backup" cascade
[0m17:18:47.620007 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:47.620515 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_exposure_relationships: Close
[0m17:18:47.620716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f36210>]}
[0m17:18:47.620939 [info ] [Thread-1 (]: 35 of 111 OK created sql view model bookings_dbt.stg_exposure_relationships .... [[32mCREATE VIEW[0m in 0.02s]
[0m17:18:47.621126 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.stg_exposure_relationships
[0m17:18:47.621250 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.stg_metric_relationships
[0m17:18:47.621431 [info ] [Thread-1 (]: 36 of 111 START sql view model bookings_dbt.stg_metric_relationships ........... [RUN]
[0m17:18:47.621564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_exposure_relationships, now model.dbt_project_evaluator.stg_metric_relationships)
[0m17:18:47.621674 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.stg_metric_relationships
[0m17:18:47.622828 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_metric_relationships"
[0m17:18:47.623087 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.stg_metric_relationships
[0m17:18:47.624514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.stg_metric_relationships"
[0m17:18:47.624713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m17:18:47.624807 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_metric_relationships: BEGIN
[0m17:18:47.624899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:47.629728 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m17:18:47.629873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m17:18:47.629994 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metric_relationships"} */

  create view "dbt_course"."bookings_dbt"."stg_metric_relationships__dbt_tmp"
    
    
  as (
    with 

_base_metric_relationships as (
    select * from "dbt_course"."bookings_dbt"."base_metric_relationships"
),

final as (
    select 
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id, 
        *
    from _base_metric_relationships
)

select distinct * from final
  );
[0m17:18:47.631327 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m17:18:47.632552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m17:18:47.632694 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metric_relationships"} */
alter table "dbt_course"."bookings_dbt"."stg_metric_relationships__dbt_tmp" rename to "stg_metric_relationships"
[0m17:18:47.633182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.634023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m17:18:47.634135 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metric_relationships"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'stg_metric_relationships'
);
      
[0m17:18:47.634608 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:47.635065 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.635217 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.635341 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.635457 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.635580 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.635690 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.635796 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.635905 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.636017 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.636125 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.636228 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.636345 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.636455 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.636564 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.636688 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.636813 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.636928 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.637040 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.637163 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.637276 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.637385 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.637501 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.637602 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.637702 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.637804 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.637908 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.638015 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.638117 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.638222 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.638328 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.638432 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.638577 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.638714 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_metric_relationships: COMMIT
[0m17:18:47.638813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m17:18:47.638901 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_metric_relationships: COMMIT
[0m17:18:47.642271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:18:47.643519 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."stg_metric_relationships__dbt_backup"
[0m17:18:47.643734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_metric_relationships"
[0m17:18:47.643858 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_metric_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_metric_relationships"} */
drop view if exists "dbt_course"."bookings_dbt"."stg_metric_relationships__dbt_backup" cascade
[0m17:18:47.644369 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:47.644858 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_metric_relationships: Close
[0m17:18:47.645067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11001c770>]}
[0m17:18:47.645311 [info ] [Thread-1 (]: 36 of 111 OK created sql view model bookings_dbt.stg_metric_relationships ...... [[32mCREATE VIEW[0m in 0.02s]
[0m17:18:47.645503 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.stg_metric_relationships
[0m17:18:47.645639 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.stg_node_relationships
[0m17:18:47.645784 [info ] [Thread-1 (]: 37 of 111 START sql table model bookings_dbt.stg_node_relationships ............ [RUN]
[0m17:18:47.645932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_metric_relationships, now model.dbt_project_evaluator.stg_node_relationships)
[0m17:18:47.646049 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.stg_node_relationships
[0m17:18:47.647624 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_node_relationships"
[0m17:18:47.647820 [debug] [Thread-4 (]: SQL status: INSERT 0 100000 in 0.082 seconds
[0m17:18:47.649296 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_ticket_flights"
[0m17:18:47.649431 [debug] [Thread-4 (]: On model.dbt_prod.fct_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_ticket_flights"} */
alter table "dbt_course"."bookings_dbt"."fct_ticket_flights" rename to "fct_ticket_flights__dbt_backup"
[0m17:18:47.649642 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.stg_node_relationships
[0m17:18:47.650931 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.stg_node_relationships"
[0m17:18:47.651112 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:18:47.652137 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_ticket_flights"
[0m17:18:47.652429 [debug] [Thread-4 (]: On model.dbt_prod.fct_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_ticket_flights"} */
alter table "dbt_course"."bookings_dbt"."fct_ticket_flights__dbt_tmp" rename to "fct_ticket_flights"
[0m17:18:47.652673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m17:18:47.652798 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_node_relationships: BEGIN
[0m17:18:47.652941 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.653080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:47.653947 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_ticket_flights"
[0m17:18:47.654157 [debug] [Thread-4 (]: On model.dbt_prod.fct_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_ticket_flights"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_ticket_flights'
);
      
[0m17:18:47.654653 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:47.655250 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.655414 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.655532 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.655649 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.655767 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.655880 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.655993 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.656104 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.656216 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.656328 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.656437 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.656548 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.656658 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.656779 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.656892 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.657005 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.657132 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.657249 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.657358 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.657470 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.657583 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.657694 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.657805 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.657917 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.658030 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.658141 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.658242 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.658342 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.658451 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.658702 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.658968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:18:47.658855 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.659120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m17:18:47.659292 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.659448 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */

  
    

  create  table "dbt_course"."bookings_dbt"."stg_node_relationships__dbt_tmp"
  
  
    as
  
  (
    with 

_base_node_relationships as (
    select * from "dbt_course"."bookings_dbt"."base_node_relationships"
),

final as (
    select 
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id, 
        *
    from _base_node_relationships
)

-- we need distinct as the graph lists relationships multiple times if they are ref'd multiple times
select distinct * from final
  );
  
[0m17:18:47.659756 [debug] [Thread-4 (]: On model.dbt_prod.fct_ticket_flights: COMMIT
[0m17:18:47.659895 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_ticket_flights"
[0m17:18:47.660003 [debug] [Thread-4 (]: On model.dbt_prod.fct_ticket_flights: COMMIT
[0m17:18:47.662380 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:47.663361 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_ticket_flights__dbt_backup"
[0m17:18:47.663510 [debug] [Thread-1 (]: SQL status: SELECT 169 in 0.004 seconds
[0m17:18:47.663768 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_ticket_flights"
[0m17:18:47.665147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m17:18:47.665284 [debug] [Thread-4 (]: On model.dbt_prod.fct_ticket_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_ticket_flights"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_ticket_flights__dbt_backup" cascade
[0m17:18:47.665399 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */
alter table "dbt_course"."bookings_dbt"."stg_node_relationships" rename to "stg_node_relationships__dbt_backup"
[0m17:18:47.665842 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.666817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m17:18:47.666953 [debug] [Thread-2 (]: SQL status: SELECT 68504 in 0.143 seconds
[0m17:18:47.667082 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */
alter table "dbt_course"."bookings_dbt"."stg_node_relationships__dbt_tmp" rename to "stg_node_relationships"
[0m17:18:47.668155 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.fct_flights"
[0m17:18:47.668263 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:18:47.668384 [debug] [Thread-2 (]: On model.dbt_prod.fct_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_flights"} */
alter table "dbt_course"."bookings_dbt"."fct_flights" rename to "fct_flights__dbt_backup"
[0m17:18:47.668851 [debug] [Thread-4 (]: On model.dbt_prod.fct_ticket_flights: Close
[0m17:18:47.668972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.669767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m17:18:47.669965 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117564f50>]}
[0m17:18:47.670099 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'stg_node_relationships'
);
      
[0m17:18:47.670224 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.670490 [info ] [Thread-4 (]: 34 of 111 OK created sql table model bookings_dbt.fct_ticket_flights ........... [[32mINSERT 0 100000[0m in 0.17s]
[0m17:18:47.671840 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.fct_flights"
[0m17:18:47.671991 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.002 seconds
[0m17:18:47.672183 [debug] [Thread-4 (]: Finished running node model.dbt_prod.fct_ticket_flights
[0m17:18:47.672403 [debug] [Thread-2 (]: On model.dbt_prod.fct_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_flights"} */
alter table "dbt_course"."bookings_dbt"."fct_flights__dbt_tmp" rename to "fct_flights"
[0m17:18:47.673019 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.673183 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.stg_columns
[0m17:18:47.673368 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.673676 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.673535 [info ] [Thread-4 (]: 38 of 111 START sql view model bookings_dbt.stg_columns ........................ [RUN]
[0m17:18:47.673825 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.674508 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.fct_flights"
[0m17:18:47.674645 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_prod.fct_ticket_flights, now model.dbt_project_evaluator.stg_columns)
[0m17:18:47.674785 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.674973 [debug] [Thread-2 (]: On model.dbt_prod.fct_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_flights"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_flights'
);
      
[0m17:18:47.675119 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.stg_columns
[0m17:18:47.675261 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.687199 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.012 seconds
[0m17:18:47.688191 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m17:18:47.687444 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.688791 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.688935 [debug] [Thread-4 (]: On model.dbt_project_evaluator.stg_columns: BEGIN
[0m17:18:47.689055 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.689207 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.689329 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:47.689431 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.689555 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.689766 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.689915 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.690068 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.690214 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.690372 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.690531 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.690681 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.690821 [debug] [Thread-3 (]: SQL status: SELECT 731514 in 0.193 seconds
[0m17:18:47.690974 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.691127 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.692489 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.fct_bookings"
[0m17:18:47.692632 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.692757 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.692978 [debug] [Thread-3 (]: On model.dbt_prod.fct_bookings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_bookings"} */
alter table "dbt_course"."bookings_dbt"."fct_bookings" rename to "fct_bookings__dbt_backup"
[0m17:18:47.693115 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.693252 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.693427 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.693612 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.693816 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.693982 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.694108 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.694247 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.694403 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.695457 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.fct_bookings"
[0m17:18:47.695602 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m17:18:47.695740 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.695876 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.696020 [debug] [Thread-3 (]: On model.dbt_prod.fct_bookings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_bookings"} */
alter table "dbt_course"."bookings_dbt"."fct_bookings__dbt_tmp" rename to "fct_bookings"
[0m17:18:47.696172 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m17:18:47.696322 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.696442 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.696628 [debug] [Thread-4 (]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'base_node_columns'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m17:18:47.696800 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.696946 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.697077 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.697226 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.697364 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.698324 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.fct_bookings"
[0m17:18:47.698480 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.698630 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.698876 [debug] [Thread-3 (]: On model.dbt_prod.fct_bookings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_bookings"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_bookings'
);
      
[0m17:18:47.699072 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.699239 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.699434 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.699589 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.699730 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.699870 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m17:18:47.700027 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.700171 [debug] [Thread-3 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:47.701517 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m17:18:47.700285 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.701654 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.702435 [info ] [Thread-3 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.702578 [debug] [Thread-4 (]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'base_source_columns'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m17:18:47.702723 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.702851 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.703011 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.703152 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.703283 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.703428 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.703559 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.703740 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.703860 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.704038 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.704207 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.704427 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.001 seconds
[0m17:18:47.704578 [info ] [Thread-3 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.704745 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.704949 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.705925 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.stg_columns"
[0m17:18:47.706047 [info ] [Thread-3 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.706465 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_node_relationships: COMMIT
[0m17:18:47.706188 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.706761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m17:18:47.706650 [info ] [Thread-3 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.706927 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.707066 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_node_relationships: COMMIT
[0m17:18:47.707207 [info ] [Thread-3 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.707318 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.707500 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.stg_columns
[0m17:18:47.707617 [info ] [Thread-3 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.707745 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.709382 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.stg_columns"
[0m17:18:47.709538 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:47.709667 [info ] [Thread-3 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.709815 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.710783 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."stg_node_relationships__dbt_backup"
[0m17:18:47.710921 [info ] [Thread-3 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.711121 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.711325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.stg_node_relationships"
[0m17:18:47.711456 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m17:18:47.711573 [info ] [Thread-3 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.711841 [debug] [Thread-2 (]: On model.dbt_prod.fct_flights: COMMIT
[0m17:18:47.711976 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_node_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_node_relationships"} */
drop table if exists "dbt_course"."bookings_dbt"."stg_node_relationships__dbt_backup" cascade
[0m17:18:47.712122 [debug] [Thread-4 (]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

  create view "dbt_course"."bookings_dbt"."stg_columns__dbt_tmp"
    
    
  as (
    with

final as (

    
    

        (
            select
                cast('"dbt_course"."bookings_dbt"."base_node_columns"' as TEXT) as _dbt_source_relation,

                
                    cast("node_unique_id" as text) as "node_unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("description" as text) as "description" ,
                    cast("data_type" as text) as "data_type" ,
                    cast("constraints" as text) as "constraints" ,
                    cast("has_not_null_constraint" as boolean) as "has_not_null_constraint" ,
                    cast("constraints_count" as integer) as "constraints_count" ,
                    cast("quote" as text) as "quote" 

            from "dbt_course"."bookings_dbt"."base_node_columns"

            
        )

        union all
        

        (
            select
                cast('"dbt_course"."bookings_dbt"."base_source_columns"' as TEXT) as _dbt_source_relation,

                
                    cast("node_unique_id" as text) as "node_unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("description" as text) as "description" ,
                    cast("data_type" as text) as "data_type" ,
                    cast("constraints" as text) as "constraints" ,
                    cast("has_not_null_constraint" as boolean) as "has_not_null_constraint" ,
                    cast("constraints_count" as integer) as "constraints_count" ,
                    cast("quote" as text) as "quote" 

            from "dbt_course"."bookings_dbt"."base_source_columns"

            
        )

        
)

select * from final
  );
[0m17:18:47.712268 [info ] [Thread-3 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.712390 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.fct_flights"
[0m17:18:47.712550 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.712707 [debug] [Thread-2 (]: On model.dbt_prod.fct_flights: COMMIT
[0m17:18:47.712883 [info ] [Thread-3 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.713078 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.713205 [info ] [Thread-3 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.713427 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m17:18:47.713327 [info ] [Thread-3 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.714507 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m17:18:47.714740 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:18:47.714915 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:47.714635 [info ] [Thread-3 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.715070 [debug] [Thread-4 (]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */
alter table "dbt_course"."bookings_dbt"."stg_columns__dbt_tmp" rename to "stg_columns"
[0m17:18:47.715538 [debug] [Thread-1 (]: On model.dbt_project_evaluator.stg_node_relationships: Close
[0m17:18:47.716275 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_flights__dbt_backup"
[0m17:18:47.716406 [info ] [Thread-3 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.716818 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.fct_flights"
[0m17:18:47.717025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117740230>]}
[0m17:18:47.717247 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.717146 [info ] [Thread-3 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.717401 [debug] [Thread-2 (]: On model.dbt_prod.fct_flights: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_flights"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_flights__dbt_backup" cascade
[0m17:18:47.717666 [info ] [Thread-1 (]: 37 of 111 OK created sql table model bookings_dbt.stg_node_relationships ....... [[32mSELECT 169[0m in 0.07s]
[0m17:18:47.718574 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m17:18:47.718711 [info ] [Thread-3 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.718922 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.stg_node_relationships
[0m17:18:47.719046 [debug] [Thread-4 (]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'stg_columns'
);
      
[0m17:18:47.719181 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.719355 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.int_all_graph_resources
[0m17:18:47.719536 [info ] [Thread-3 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.719753 [info ] [Thread-1 (]: 39 of 111 START sql table model bookings_dbt.int_all_graph_resources ........... [RUN]
[0m17:18:47.719934 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:47.720061 [info ] [Thread-3 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.720221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_node_relationships, now model.dbt_project_evaluator.int_all_graph_resources)
[0m17:18:47.720361 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:18:47.721031 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.721216 [info ] [Thread-3 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.721395 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.int_all_graph_resources
[0m17:18:47.721888 [debug] [Thread-2 (]: On model.dbt_prod.fct_flights: Close
[0m17:18:47.722024 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.722161 [info ] [Thread-3 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.728045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.728215 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.728359 [info ] [Thread-3 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.728533 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: BEGIN
[0m17:18:47.728729 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f2a030>]}
[0m17:18:47.728859 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.729033 [info ] [Thread-3 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.729223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:47.729438 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.729631 [info ] [Thread-2 (]: 32 of 111 OK created sql table model bookings_dbt.fct_flights .................. [[32mSELECT 68504[0m in 0.24s]
[0m17:18:47.729812 [info ] [Thread-3 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.730065 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.730264 [debug] [Thread-2 (]: Finished running node model.dbt_prod.fct_flights
[0m17:18:47.730391 [info ] [Thread-3 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.730520 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.730703 [debug] [Thread-2 (]: Began running node model.dbt_prod.stg_dict_indentificat_passenger
[0m17:18:47.730933 [info ] [Thread-3 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.731113 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.731589 [debug] [Thread-3 (]: On model.dbt_prod.fct_bookings: COMMIT
[0m17:18:47.731299 [info ] [Thread-2 (]: 40 of 111 START sql table model bookings_dbt.stg_dict_indentificat_passenger ... [RUN]
[0m17:18:47.731751 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.731902 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.fct_bookings"
[0m17:18:47.732063 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_prod.fct_flights, now model.dbt_prod.stg_dict_indentificat_passenger)
[0m17:18:47.732200 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.732337 [debug] [Thread-3 (]: On model.dbt_prod.fct_bookings: COMMIT
[0m17:18:47.732455 [debug] [Thread-2 (]: Began compiling node model.dbt_prod.stg_dict_indentificat_passenger
[0m17:18:47.732570 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.733668 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_prod.stg_dict_indentificat_passenger"
[0m17:18:47.733817 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:47.733951 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.734986 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_bookings__dbt_backup"
[0m17:18:47.735160 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.735405 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.fct_bookings"
[0m17:18:47.735567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:18:47.735696 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.735839 [debug] [Thread-2 (]: Began executing node model.dbt_prod.stg_dict_indentificat_passenger
[0m17:18:47.735972 [debug] [Thread-3 (]: On model.dbt_prod.fct_bookings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_bookings"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_bookings__dbt_backup" cascade
[0m17:18:47.736135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.736293 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.737716 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_prod.stg_dict_indentificat_passenger"
[0m17:18:47.737881 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'stg_nodes'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m17:18:47.738048 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.738273 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.738433 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.738753 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_indentificat_passenger"
[0m17:18:47.738599 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.738914 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_indentificat_passenger: BEGIN
[0m17:18:47.739033 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.739167 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:47.739282 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.739458 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.739574 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.739686 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.739796 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.739906 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.740018 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.740232 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:18:47.740767 [debug] [Thread-3 (]: On model.dbt_prod.fct_bookings: Close
[0m17:18:47.740128 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.741037 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e28cb0>]}
[0m17:18:47.741188 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.741359 [debug] [Thread-1 (]: SQL status: SELECT 28 in 0.003 seconds
[0m17:18:47.741627 [info ] [Thread-3 (]: 31 of 111 OK created sql table model bookings_dbt.fct_bookings ................. [[32mSELECT 731514[0m in 0.30s]
[0m17:18:47.743527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.741740 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.743783 [debug] [Thread-3 (]: Finished running node model.dbt_prod.fct_bookings
[0m17:18:47.743949 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'stg_exposures'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m17:18:47.744128 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.744296 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m17:18:47.744474 [debug] [Thread-3 (]: Began running node test.dbt_prod.unique_city_region_city.aceab31475
[0m17:18:47.744706 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.744844 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_indentificat_passenger"
[0m17:18:47.744974 [info ] [Thread-3 (]: 41 of 111 START test unique_city_region_city ................................... [RUN]
[0m17:18:47.745153 [debug] [Thread-4 (]: On model.dbt_project_evaluator.stg_columns: COMMIT
[0m17:18:47.745290 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_indentificat_passenger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_dict_indentificat_passenger"} */

  
    

  create  table "dbt_course"."bookings_dbt"."stg_dict_indentificat_passenger__dbt_tmp"
  
  
    as
  
  (
    


select

    passenger_id
   
from "dbt_course"."bookings_dbt_seeds"."indentificat_passenger"
  );
  
[0m17:18:47.745443 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_prod.fct_bookings, now test.dbt_prod.unique_city_region_city.aceab31475)
[0m17:18:47.745568 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m17:18:47.745702 [debug] [Thread-3 (]: Began compiling node test.dbt_prod.unique_city_region_city.aceab31475
[0m17:18:47.745838 [debug] [Thread-4 (]: On model.dbt_project_evaluator.stg_columns: COMMIT
[0m17:18:47.745980 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.001 seconds
[0m17:18:47.748064 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_prod.unique_city_region_city.aceab31475"
[0m17:18:47.748217 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.003 seconds
[0m17:18:47.749618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.749950 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:47.751026 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_indentificat_passenger"
[0m17:18:47.751160 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'stg_metrics'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m17:18:47.751955 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."stg_columns__dbt_backup"
[0m17:18:47.752122 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_indentificat_passenger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_dict_indentificat_passenger"} */
alter table "dbt_course"."bookings_dbt"."stg_dict_indentificat_passenger" rename to "stg_dict_indentificat_passenger__dbt_backup"
[0m17:18:47.752369 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.stg_columns"
[0m17:18:47.752501 [debug] [Thread-3 (]: Began executing node test.dbt_prod.unique_city_region_city.aceab31475
[0m17:18:47.752631 [debug] [Thread-4 (]: On model.dbt_project_evaluator.stg_columns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.stg_columns"} */
drop view if exists "dbt_course"."bookings_dbt"."stg_columns__dbt_backup" cascade
[0m17:18:47.753599 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_prod.unique_city_region_city.aceab31475"
[0m17:18:47.753745 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.001 seconds
[0m17:18:47.753897 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.755266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.756271 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_indentificat_passenger"
[0m17:18:47.756392 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:18:47.756544 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sources'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m17:18:47.756681 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_indentificat_passenger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_dict_indentificat_passenger"} */
alter table "dbt_course"."bookings_dbt"."stg_dict_indentificat_passenger__dbt_tmp" rename to "stg_dict_indentificat_passenger"
[0m17:18:47.756821 [debug] [Thread-3 (]: Using postgres connection "test.dbt_prod.unique_city_region_city.aceab31475"
[0m17:18:47.757309 [debug] [Thread-4 (]: On model.dbt_project_evaluator.stg_columns: Close
[0m17:18:47.757464 [debug] [Thread-3 (]: On test.dbt_prod.unique_city_region_city.aceab31475: BEGIN
[0m17:18:47.757590 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:47.757724 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.757910 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174532f0>]}
[0m17:18:47.758734 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_indentificat_passenger"
[0m17:18:47.758893 [debug] [Thread-1 (]: SQL status: SELECT 18 in 0.001 seconds
[0m17:18:47.759240 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_indentificat_passenger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_dict_indentificat_passenger"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'stg_dict_indentificat_passenger'
);
      
[0m17:18:47.759122 [info ] [Thread-4 (]: 38 of 111 OK created sql view model bookings_dbt.stg_columns ................... [[32mCREATE VIEW[0m in 0.08s]
[0m17:18:47.765284 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.765612 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.stg_columns
[0m17:18:47.765836 [debug] [Thread-4 (]: Began running node model.dbt_prod.fct_tickets
[0m17:18:47.766011 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m17:18:47.766209 [info ] [Thread-4 (]: 42 of 111 START sql table model bookings_dbt.fct_tickets ....................... [RUN]
[0m17:18:47.766371 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:47.766482 [debug] [Thread-3 (]: Using postgres connection "test.dbt_prod.unique_city_region_city.aceab31475"
[0m17:18:47.766652 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.stg_columns, now model.dbt_prod.fct_tickets)
[0m17:18:47.767320 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.767465 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.int_all_graph_resources
[0m17:18:47.767594 [debug] [Thread-3 (]: On test.dbt_prod.unique_city_region_city.aceab31475: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_prod.unique_city_region_city.aceab31475"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    city as unique_field,
    count(*) as n_records

from "dbt_course"."bookings_dbt_seeds"."city_region"
where city is not null
group by city
having count(*) > 1



      
    ) dbt_internal_test
[0m17:18:47.767731 [debug] [Thread-4 (]: Began compiling node model.dbt_prod.fct_tickets
[0m17:18:47.767877 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.769491 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.770669 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_prod.fct_tickets"
[0m17:18:47.770829 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:47.770983 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.771656 [debug] [Thread-3 (]: On test.dbt_prod.unique_city_region_city.aceab31475: ROLLBACK
[0m17:18:47.771813 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.772037 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.772296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.772168 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.772446 [debug] [Thread-3 (]: On test.dbt_prod.unique_city_region_city.aceab31475: Close
[0m17:18:47.772882 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

  
    

  create  table "dbt_course"."bookings_dbt"."int_all_graph_resources__dbt_tmp"
  
  
    as
  
  (
    -- one row for each resource in the graph



with unioned as (

    
    

        (
            select
                cast('"dbt_course"."bookings_dbt"."stg_nodes"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast("is_enabled" as boolean) as "is_enabled" ,
                    cast("materialized" as text) as "materialized" ,
                    cast("on_schema_change" as text) as "on_schema_change" ,
                    cast("model_group" as text) as "model_group" ,
                    cast("access" as text) as "access" ,
                    cast("latest_version" as text) as "latest_version" ,
                    cast("version" as text) as "version" ,
                    cast("deprecation_date" as text) as "deprecation_date" ,
                    cast("is_contract_enforced" as boolean) as "is_contract_enforced" ,
                    cast("total_defined_columns" as integer) as "total_defined_columns" ,
                    cast("total_described_columns" as integer) as "total_described_columns" ,
                    cast("database" as text) as "database" ,
                    cast("schema" as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast("alias" as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast("column_name" as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast("hard_coded_references" as text) as "hard_coded_references" ,
                    cast("number_lines" as integer) as "number_lines" ,
                    cast("sql_complexity" as double precision) as "sql_complexity" ,
                    cast("macro_dependencies" as text) as "macro_dependencies" ,
                    cast("is_generic_test" as boolean) as "is_generic_test" ,
                    cast("is_excluded" as boolean) as "is_excluded" ,
                    cast(null as text) as "exposure_type" ,
                    cast(null as text) as "maturity" ,
                    cast(null as text) as "url" ,
                    cast(null as text) as "owner_name" ,
                    cast(null as text) as "owner_email" ,
                    cast(null as text) as "metric_type" ,
                    cast(null as text) as "label" ,
                    cast(null as text) as "metric_filter" ,
                    cast(null as text) as "metric_measure" ,
                    cast(null as text) as "metric_measure_alias" ,
                    cast(null as text) as "numerator" ,
                    cast(null as text) as "denominator" ,
                    cast(null as text) as "expr" ,
                    cast(null as text) as "metric_window" ,
                    cast(null as text) as "grain_to_date" ,
                    cast(null as text) as "source_name" ,
                    cast(null as boolean) as "is_source_described" ,
                    cast(null as text) as "loaded_at_field" ,
                    cast(null as boolean) as "is_freshness_enabled" ,
                    cast(null as text) as "loader" ,
                    cast(null as text) as "identifier" 

            from "dbt_course"."bookings_dbt"."stg_nodes"

            
        )

        union all
        

        (
            select
                cast('"dbt_course"."bookings_dbt"."stg_exposures"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast(null as boolean) as "is_enabled" ,
                    cast(null as text) as "materialized" ,
                    cast(null as text) as "on_schema_change" ,
                    cast(null as text) as "model_group" ,
                    cast(null as text) as "access" ,
                    cast(null as text) as "latest_version" ,
                    cast(null as text) as "version" ,
                    cast(null as text) as "deprecation_date" ,
                    cast(null as boolean) as "is_contract_enforced" ,
                    cast(null as integer) as "total_defined_columns" ,
                    cast(null as integer) as "total_described_columns" ,
                    cast(null as text) as "database" ,
                    cast(null as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast(null as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast(null as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast(null as text) as "hard_coded_references" ,
                    cast(null as integer) as "number_lines" ,
                    cast(null as double precision) as "sql_complexity" ,
                    cast(null as text) as "macro_dependencies" ,
                    cast(null as boolean) as "is_generic_test" ,
                    cast(null as boolean) as "is_excluded" ,
                    cast("exposure_type" as text) as "exposure_type" ,
                    cast("maturity" as text) as "maturity" ,
                    cast("url" as text) as "url" ,
                    cast("owner_name" as text) as "owner_name" ,
                    cast("owner_email" as text) as "owner_email" ,
                    cast(null as text) as "metric_type" ,
                    cast(null as text) as "label" ,
                    cast(null as text) as "metric_filter" ,
                    cast(null as text) as "metric_measure" ,
                    cast(null as text) as "metric_measure_alias" ,
                    cast(null as text) as "numerator" ,
                    cast(null as text) as "denominator" ,
                    cast(null as text) as "expr" ,
                    cast(null as text) as "metric_window" ,
                    cast(null as text) as "grain_to_date" ,
                    cast(null as text) as "source_name" ,
                    cast(null as boolean) as "is_source_described" ,
                    cast(null as text) as "loaded_at_field" ,
                    cast(null as boolean) as "is_freshness_enabled" ,
                    cast(null as text) as "loader" ,
                    cast(null as text) as "identifier" 

            from "dbt_course"."bookings_dbt"."stg_exposures"

            
        )

        union all
        

        (
            select
                cast('"dbt_course"."bookings_dbt"."stg_metrics"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast(null as boolean) as "is_enabled" ,
                    cast(null as text) as "materialized" ,
                    cast(null as text) as "on_schema_change" ,
                    cast(null as text) as "model_group" ,
                    cast(null as text) as "access" ,
                    cast(null as text) as "latest_version" ,
                    cast(null as text) as "version" ,
                    cast(null as text) as "deprecation_date" ,
                    cast(null as boolean) as "is_contract_enforced" ,
                    cast(null as integer) as "total_defined_columns" ,
                    cast(null as integer) as "total_described_columns" ,
                    cast(null as text) as "database" ,
                    cast(null as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast(null as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast(null as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast(null as text) as "hard_coded_references" ,
                    cast(null as integer) as "number_lines" ,
                    cast(null as double precision) as "sql_complexity" ,
                    cast(null as text) as "macro_dependencies" ,
                    cast(null as boolean) as "is_generic_test" ,
                    cast(null as boolean) as "is_excluded" ,
                    cast(null as text) as "exposure_type" ,
                    cast(null as text) as "maturity" ,
                    cast(null as text) as "url" ,
                    cast(null as text) as "owner_name" ,
                    cast(null as text) as "owner_email" ,
                    cast("metric_type" as text) as "metric_type" ,
                    cast("label" as text) as "label" ,
                    cast("metric_filter" as text) as "metric_filter" ,
                    cast("metric_measure" as text) as "metric_measure" ,
                    cast("metric_measure_alias" as text) as "metric_measure_alias" ,
                    cast("numerator" as text) as "numerator" ,
                    cast("denominator" as text) as "denominator" ,
                    cast("expr" as text) as "expr" ,
                    cast("metric_window" as text) as "metric_window" ,
                    cast("grain_to_date" as text) as "grain_to_date" ,
                    cast(null as text) as "source_name" ,
                    cast(null as boolean) as "is_source_described" ,
                    cast(null as text) as "loaded_at_field" ,
                    cast(null as boolean) as "is_freshness_enabled" ,
                    cast(null as text) as "loader" ,
                    cast(null as text) as "identifier" 

            from "dbt_course"."bookings_dbt"."stg_metrics"

            
        )

        union all
        

        (
            select
                cast('"dbt_course"."bookings_dbt"."stg_sources"' as TEXT) as _dbt_source_relation,

                
                    cast("unique_id" as text) as "unique_id" ,
                    cast("name" as text) as "name" ,
                    cast("resource_type" as text) as "resource_type" ,
                    cast("file_path" as text) as "file_path" ,
                    cast("is_enabled" as boolean) as "is_enabled" ,
                    cast(null as text) as "materialized" ,
                    cast(null as text) as "on_schema_change" ,
                    cast(null as text) as "model_group" ,
                    cast(null as text) as "access" ,
                    cast(null as text) as "latest_version" ,
                    cast(null as text) as "version" ,
                    cast(null as text) as "deprecation_date" ,
                    cast(null as boolean) as "is_contract_enforced" ,
                    cast(null as integer) as "total_defined_columns" ,
                    cast(null as integer) as "total_described_columns" ,
                    cast("database" as text) as "database" ,
                    cast("schema" as text) as "schema" ,
                    cast("package_name" as text) as "package_name" ,
                    cast("alias" as text) as "alias" ,
                    cast("is_described" as boolean) as "is_described" ,
                    cast(null as text) as "column_name" ,
                    cast("meta" as text) as "meta" ,
                    cast(null as text) as "hard_coded_references" ,
                    cast(null as integer) as "number_lines" ,
                    cast(null as double precision) as "sql_complexity" ,
                    cast(null as text) as "macro_dependencies" ,
                    cast(null as boolean) as "is_generic_test" ,
                    cast("is_excluded" as boolean) as "is_excluded" ,
                    cast(null as text) as "exposure_type" ,
                    cast(null as text) as "maturity" ,
                    cast(null as text) as "url" ,
                    cast(null as text) as "owner_name" ,
                    cast(null as text) as "owner_email" ,
                    cast(null as text) as "metric_type" ,
                    cast(null as text) as "label" ,
                    cast(null as text) as "metric_filter" ,
                    cast(null as text) as "metric_measure" ,
                    cast(null as text) as "metric_measure_alias" ,
                    cast(null as text) as "numerator" ,
                    cast(null as text) as "denominator" ,
                    cast(null as text) as "expr" ,
                    cast(null as text) as "metric_window" ,
                    cast(null as text) as "grain_to_date" ,
                    cast("source_name" as text) as "source_name" ,
                    cast("is_source_described" as boolean) as "is_source_described" ,
                    cast("loaded_at_field" as text) as "loaded_at_field" ,
                    cast("is_freshness_enabled" as boolean) as "is_freshness_enabled" ,
                    cast("loader" as text) as "loader" ,
                    cast("identifier" as text) as "identifier" 

            from "dbt_course"."bookings_dbt"."stg_sources"

            
        )

        

),

naming_convention_prefixes as (
    select * from "dbt_course"."bookings_dbt"."stg_naming_convention_prefixes"
), 

naming_convention_folders as (
    select * from "dbt_course"."bookings_dbt"."stg_naming_convention_folders"
), 

unioned_with_calc as (
    select 
        *,
        case 
            when resource_type = 'source' then  source_name || '.' || name
            when coalesce(version, '') != '' then name || '.v' || version 
            else name 
        end as resource_name,
        case
            when resource_type = 'source' then null
            else 

  
    

    split_part(
        name,
        '_',
        1
        )


  

||'_' 
        end as prefix,
        
  

    replace(
        file_path,
        regexp_replace(file_path,'.*/',''),
        ''
    )



    
  
 as directory_path,
        regexp_replace(file_path,'.*/','') as file_name
    from unioned
    where coalesce(is_enabled, True) = True and package_name != 'dbt_project_evaluator'
), 

joined as (

    select
        unioned_with_calc.unique_id as resource_id, 
        unioned_with_calc.resource_name, 
        unioned_with_calc.prefix, 
        unioned_with_calc.resource_type, 
        unioned_with_calc.file_path, 
        unioned_with_calc.directory_path,
        unioned_with_calc.is_generic_test,
        unioned_with_calc.file_name,
        case 
            when unioned_with_calc.resource_type in ('test', 'source', 'metric', 'exposure', 'seed') then null
            else nullif(naming_convention_prefixes.model_type, '')
        end as model_type_prefix,
        case 
            when unioned_with_calc.resource_type in ('test', 'source', 'metric', 'exposure', 'seed') then null
            when 

    position(
        
  
    '/'
  
 || naming_convention_folders.folder_name_value || 
  
    '/'
  
 in unioned_with_calc.directory_path
    ) = 0 then null
            else naming_convention_folders.model_type 
        end as model_type_folder,
        

    position(
        
  
    '/'
  
 || naming_convention_folders.folder_name_value || 
  
    '/'
  
 in unioned_with_calc.directory_path
    ) as position_folder,  
        nullif(unioned_with_calc.column_name, '') as column_name,
        
        unioned_with_calc.macro_dependencies like '%macro.dbt.test_unique%' and unioned_with_calc.resource_type = 'test' as is_test_unique,  
        
        unioned_with_calc.macro_dependencies like '%macro.dbt.test_not_null%' and unioned_with_calc.resource_type = 'test' as is_test_not_null,  
        
        unioned_with_calc.macro_dependencies like '%macro.dbt_utils.test_unique_combination_of_columns%' and unioned_with_calc.resource_type = 'test' as is_test_unique_combination_of_columns,  
        
        unioned_with_calc.is_enabled, 
        unioned_with_calc.materialized, 
        unioned_with_calc.on_schema_change, 
        unioned_with_calc.database, 
        unioned_with_calc.schema, 
        unioned_with_calc.package_name, 
        unioned_with_calc.alias, 
        unioned_with_calc.is_described, 
        unioned_with_calc.model_group, 
        unioned_with_calc.access, 
        unioned_with_calc.access = 'public' as is_public, 
        unioned_with_calc.latest_version, 
        unioned_with_calc.version, 
        unioned_with_calc.deprecation_date, 
        unioned_with_calc.is_contract_enforced, 
        unioned_with_calc.total_defined_columns, 
        unioned_with_calc.total_described_columns, 
        unioned_with_calc.exposure_type, 
        unioned_with_calc.maturity, 
        unioned_with_calc.url, 
        unioned_with_calc.owner_name,
        unioned_with_calc.owner_email,
        unioned_with_calc.meta,
        unioned_with_calc.macro_dependencies,
        unioned_with_calc.metric_type, 
        unioned_with_calc.label, 
        unioned_with_calc.metric_filter,
        unioned_with_calc.metric_measure,
        unioned_with_calc.metric_measure_alias,
        unioned_with_calc.numerator,
        unioned_with_calc.denominator,
        unioned_with_calc.expr,
        unioned_with_calc.metric_window,
        unioned_with_calc.grain_to_date,
        unioned_with_calc.source_name, -- NULL for non-source resources
        unioned_with_calc.is_source_described, 
        unioned_with_calc.loaded_at_field, 
        unioned_with_calc.is_freshness_enabled, 
        unioned_with_calc.loader, 
        unioned_with_calc.identifier,
        unioned_with_calc.hard_coded_references, -- NULL for non-model resources
        unioned_with_calc.number_lines, -- NULL for non-model resources
        unioned_with_calc.sql_complexity, -- NULL for non-model resources
        unioned_with_calc.is_excluded -- NULL for metrics and exposures

    from unioned_with_calc
    left join naming_convention_prefixes
        on unioned_with_calc.prefix = naming_convention_prefixes.prefix_value

    cross join naming_convention_folders   

), 

calculate_model_type as (
    select 
        *, 
        case 
            when resource_type in ('test', 'source', 'metric', 'exposure', 'seed') then null
            -- by default we will define the model type based on its prefix in the case prefix and folder types are different
            else coalesce(model_type_prefix, model_type_folder, 'other') 
        end as model_type,
        row_number() over (partition by resource_id order by position_folder desc) as folder_name_rank
    from joined
),

final as (
    select
        *
    from calculate_model_type
    where folder_name_rank = 1
)

select 
    *
from final
  );
  
[0m17:18:47.773302 [debug] [Thread-4 (]: Began executing node model.dbt_prod.fct_tickets
[0m17:18:47.773428 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.773672 [info ] [Thread-3 (]: 41 of 111 PASS unique_city_region_city ......................................... [[32mPASS[0m in 0.03s]
[0m17:18:47.777975 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_prod.fct_tickets"
[0m17:18:47.778146 [debug] [Thread-1 (]: SQL status: SELECT 53 in 0.004 seconds
[0m17:18:47.778304 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.778519 [debug] [Thread-3 (]: Finished running node test.dbt_prod.unique_city_region_city.aceab31475
[0m17:18:47.779845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.780005 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.780198 [debug] [Thread-3 (]: Began running node model.dbt_prod.src_flights__airports
[0m17:18:47.780397 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */
alter table "dbt_course"."bookings_dbt"."int_all_graph_resources" rename to "int_all_graph_resources__dbt_backup"
[0m17:18:47.780598 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_tickets"
[0m17:18:47.780721 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.780903 [info ] [Thread-3 (]: 43 of 111 START sql table model bookings_dbt.src_flights__airports ............. [RUN]
[0m17:18:47.781058 [debug] [Thread-4 (]: On model.dbt_prod.fct_tickets: BEGIN
[0m17:18:47.781179 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.781331 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_prod.unique_city_region_city.aceab31475, now model.dbt_prod.src_flights__airports)
[0m17:18:47.781449 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:47.781567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.781674 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.781800 [debug] [Thread-3 (]: Began compiling node model.dbt_prod.src_flights__airports
[0m17:18:47.783137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.783317 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.784515 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_prod.src_flights__airports"
[0m17:18:47.784664 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */
alter table "dbt_course"."bookings_dbt"."int_all_graph_resources__dbt_tmp" rename to "int_all_graph_resources"
[0m17:18:47.784806 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.784982 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.785103 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.785229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.786158 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.786287 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'int_all_graph_resources'
);
      
[0m17:18:47.786439 [debug] [Thread-3 (]: Began executing node model.dbt_prod.src_flights__airports
[0m17:18:47.788010 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_prod.src_flights__airports"
[0m17:18:47.788161 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.002 seconds
[0m17:18:47.785357 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.788362 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m17:18:47.789016 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.789215 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.789410 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_tickets"
[0m17:18:47.789565 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.src_flights__airports"
[0m17:18:47.789717 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.789868 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.790002 [debug] [Thread-4 (]: On model.dbt_prod.fct_tickets: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_tickets"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_tickets__dbt_tmp"
  
  
    as
  
  (
    

select
  ticket_no, 
    book_ref, 
    passenger_id, 
    passenger_name, 
    contact_data
from "dbt_course"."bookings_dbt"."stg_flights__tickets"

where passenger_id in (select passenger_id from "dbt_course"."bookings_dbt_seeds"."indentificat_passenger")
  );
  
[0m17:18:47.790124 [debug] [Thread-3 (]: On model.dbt_prod.src_flights__airports: BEGIN
[0m17:18:47.790252 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.790393 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.790532 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:47.790650 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.790788 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.790964 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.791109 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.791227 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.791381 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.791593 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.791763 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.791920 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.792051 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.792255 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.792436 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.792589 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.792747 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.792890 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.793027 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.793157 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.793279 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.793402 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.793524 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.793642 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.793825 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.793946 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.794198 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.794347 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.794680 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_indentificat_passenger: COMMIT
[0m17:18:47.794825 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.795023 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_indentificat_passenger"
[0m17:18:47.795167 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.795318 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_indentificat_passenger: COMMIT
[0m17:18:47.795619 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m17:18:47.795488 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.795822 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.src_flights__airports"
[0m17:18:47.796072 [debug] [Thread-3 (]: On model.dbt_prod.src_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.src_flights__airports"} */

  
    

  create  table "dbt_course"."bookings_dbt"."src_flights__airports__dbt_tmp"
  
  
    as
  
  (
    

 select 
  airport_code,
  airport_name, 
  city, 
  coordinates, 
  timezone
  from "dbt_course"."demo_src"."airports"
  );
  
[0m17:18:47.795954 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.796240 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.796364 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.796479 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.796609 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:47.796721 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.797636 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."stg_dict_indentificat_passenger__dbt_backup"
[0m17:18:47.797762 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.797974 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_indentificat_passenger"
[0m17:18:47.798106 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.798244 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_indentificat_passenger: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_dict_indentificat_passenger"} */
drop table if exists "dbt_course"."bookings_dbt"."stg_dict_indentificat_passenger__dbt_backup" cascade
[0m17:18:47.798365 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.798506 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.798622 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.798774 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.798894 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.799055 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.799350 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: COMMIT
[0m17:18:47.799469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.799577 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: COMMIT
[0m17:18:47.799697 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:18:47.800247 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_indentificat_passenger: Close
[0m17:18:47.800384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:47.800590 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117df8cb0>]}
[0m17:18:47.801775 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."int_all_graph_resources__dbt_backup"
[0m17:18:47.801910 [debug] [Thread-3 (]: SQL status: SELECT 104 in 0.006 seconds
[0m17:18:47.802333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.int_all_graph_resources"
[0m17:18:47.802147 [info ] [Thread-2 (]: 40 of 111 OK created sql table model bookings_dbt.stg_dict_indentificat_passenger  [[32mSELECT 6[0m in 0.07s]
[0m17:18:47.803297 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.src_flights__airports"
[0m17:18:47.803409 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_graph_resources"} */
drop table if exists "dbt_course"."bookings_dbt"."int_all_graph_resources__dbt_backup" cascade
[0m17:18:47.803570 [debug] [Thread-2 (]: Finished running node model.dbt_prod.stg_dict_indentificat_passenger
[0m17:18:47.803682 [debug] [Thread-3 (]: On model.dbt_prod.src_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.src_flights__airports"} */
alter table "dbt_course"."bookings_dbt"."src_flights__airports__dbt_tmp" rename to "src_flights__airports"
[0m17:18:47.803834 [debug] [Thread-2 (]: Began running node model.dbt_prod.stg_demo_src__airports
[0m17:18:47.804049 [info ] [Thread-2 (]: 44 of 111 START sql view model bookings_dbt.stg_demo_src__airports ............. [RUN]
[0m17:18:47.804193 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_prod.stg_dict_indentificat_passenger, now model.dbt_prod.stg_demo_src__airports)
[0m17:18:47.804436 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.804577 [debug] [Thread-2 (]: Began compiling node model.dbt_prod.stg_demo_src__airports
[0m17:18:47.805551 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.src_flights__airports"
[0m17:18:47.806892 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_prod.stg_demo_src__airports"
[0m17:18:47.807049 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:18:47.807177 [debug] [Thread-3 (]: On model.dbt_prod.src_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.src_flights__airports"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'src_flights__airports'
);
      
[0m17:18:47.807671 [debug] [Thread-1 (]: On model.dbt_project_evaluator.int_all_graph_resources: Close
[0m17:18:47.807903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117173230>]}
[0m17:18:47.808257 [debug] [Thread-3 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:47.808135 [info ] [Thread-1 (]: 39 of 111 OK created sql table model bookings_dbt.int_all_graph_resources ...... [[32mSELECT 53[0m in 0.09s]
[0m17:18:47.808862 [info ] [Thread-3 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.809007 [debug] [Thread-2 (]: Began executing node model.dbt_prod.stg_demo_src__airports
[0m17:18:47.809177 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.int_all_graph_resources
[0m17:18:47.809310 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.810554 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_prod.stg_demo_src__airports"
[0m17:18:47.810677 [debug] [Thread-1 (]: Began running node model.dbt_prod.stg_flights__seats
[0m17:18:47.810802 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.811183 [info ] [Thread-1 (]: 45 of 111 START sql table model bookings_dbt.stg_flights__seats ................ [RUN]
[0m17:18:47.811344 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.811533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_all_graph_resources, now model.dbt_prod.stg_flights__seats)
[0m17:18:47.811679 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_demo_src__airports"
[0m17:18:47.811800 [info ] [Thread-3 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.811958 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.stg_flights__seats
[0m17:18:47.812094 [debug] [Thread-2 (]: On model.dbt_prod.stg_demo_src__airports: BEGIN
[0m17:18:47.812244 [info ] [Thread-3 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.813475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.stg_flights__seats"
[0m17:18:47.813619 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:47.813776 [info ] [Thread-3 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.814043 [info ] [Thread-3 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.814185 [info ] [Thread-3 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.814303 [info ] [Thread-3 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.814424 [info ] [Thread-3 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.814579 [debug] [Thread-1 (]: Began executing node model.dbt_prod.stg_flights__seats
[0m17:18:47.814707 [info ] [Thread-3 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.816137 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.stg_flights__seats"
[0m17:18:47.816269 [info ] [Thread-3 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.816424 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.816570 [info ] [Thread-3 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.816708 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.816852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.stg_flights__seats"
[0m17:18:47.816962 [info ] [Thread-3 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.817088 [debug] [Thread-1 (]: On model.dbt_prod.stg_flights__seats: BEGIN
[0m17:18:47.817203 [info ] [Thread-3 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.817337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:47.817460 [info ] [Thread-3 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.817627 [info ] [Thread-3 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.817743 [info ] [Thread-3 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.817859 [info ] [Thread-3 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.818051 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.818184 [info ] [Thread-3 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.818411 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m17:18:47.818302 [info ] [Thread-3 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.818566 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_demo_src__airports"
[0m17:18:47.818699 [info ] [Thread-3 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.818885 [debug] [Thread-2 (]: On model.dbt_prod.stg_demo_src__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_demo_src__airports"} */

  create view "dbt_course"."bookings_dbt"."stg_demo_src__airports__dbt_tmp"
    
    
  as (
    with source as (

    select * from "dbt_course"."demo_src"."airports"

),

renamed as (

    select
        airport_code,
        airport_name,
        city,
        coordinates,
        timezone

    from source

)

select * from renamed
  );
[0m17:18:47.819046 [info ] [Thread-3 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.819225 [info ] [Thread-3 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.819341 [info ] [Thread-3 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.819452 [info ] [Thread-3 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.819554 [info ] [Thread-3 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.819726 [info ] [Thread-3 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.821601 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."src_flights__airports_dbt_backup_new"
[0m17:18:47.821779 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:18:47.822014 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.src_flights__airports"
[0m17:18:47.822140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m17:18:47.823261 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_demo_src__airports"
[0m17:18:47.823393 [debug] [Thread-3 (]: On model.dbt_prod.src_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.src_flights__airports"} */
drop table if exists "dbt_course"."bookings_dbt"."src_flights__airports_dbt_backup_new" cascade
[0m17:18:47.823516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.stg_flights__seats"
[0m17:18:47.823634 [debug] [Thread-2 (]: On model.dbt_prod.stg_demo_src__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_demo_src__airports"} */
alter table "dbt_course"."bookings_dbt"."stg_demo_src__airports" rename to "stg_demo_src__airports__dbt_backup"
[0m17:18:47.823769 [debug] [Thread-1 (]: On model.dbt_prod.stg_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_flights__seats"} */

  
    

  create  table "dbt_course"."bookings_dbt"."stg_flights__seats__dbt_tmp"
  
  
    as
  
  (
    


select
    aircraft_code, 
    seat_no, 
    fare_conditions
from "dbt_course"."demo_src"."seats"
  );
  
[0m17:18:47.824147 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.825442 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_demo_src__airports"
[0m17:18:47.825576 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:18:47.825711 [debug] [Thread-2 (]: On model.dbt_prod.stg_demo_src__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_demo_src__airports"} */
alter table "dbt_course"."bookings_dbt"."stg_demo_src__airports__dbt_tmp" rename to "stg_demo_src__airports"
[0m17:18:47.826721 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.src_flights__airports"
[0m17:18:47.826869 [debug] [Thread-3 (]: On model.dbt_prod.src_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.src_flights__airports"} */
alter table "dbt_course"."bookings_dbt"."src_flights__airports" rename to "src_flights__airports_dbt_backup_new"
[0m17:18:47.827194 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.827309 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.828257 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_demo_src__airports"
[0m17:18:47.828392 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.004 seconds
[0m17:18:47.828922 [debug] [Thread-3 (]: On model.dbt_prod.src_flights__airports: COMMIT
[0m17:18:47.829083 [debug] [Thread-2 (]: On model.dbt_prod.stg_demo_src__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_demo_src__airports"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'stg_demo_src__airports'
);
      
[0m17:18:47.830461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.stg_flights__seats"
[0m17:18:47.830601 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.src_flights__airports"
[0m17:18:47.830752 [debug] [Thread-1 (]: On model.dbt_prod.stg_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_flights__seats"} */
alter table "dbt_course"."bookings_dbt"."stg_flights__seats" rename to "stg_flights__seats__dbt_backup"
[0m17:18:47.830877 [debug] [Thread-3 (]: On model.dbt_prod.src_flights__airports: COMMIT
[0m17:18:47.831255 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:47.832005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.832153 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:47.833042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.stg_flights__seats"
[0m17:18:47.831857 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.833866 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."src_flights__airports__dbt_backup"
[0m17:18:47.833988 [debug] [Thread-1 (]: On model.dbt_prod.stg_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_flights__seats"} */
alter table "dbt_course"."bookings_dbt"."stg_flights__seats__dbt_tmp" rename to "stg_flights__seats"
[0m17:18:47.834135 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.834332 [debug] [Thread-3 (]: Using postgres connection "model.dbt_prod.src_flights__airports"
[0m17:18:47.834471 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.834600 [debug] [Thread-3 (]: On model.dbt_prod.src_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.src_flights__airports"} */
drop table if exists "dbt_course"."bookings_dbt"."src_flights__airports__dbt_backup" cascade
[0m17:18:47.834725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.834845 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.835634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.stg_flights__seats"
[0m17:18:47.835757 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:18:47.835884 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.836021 [debug] [Thread-1 (]: On model.dbt_prod.stg_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_flights__seats"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'stg_flights__seats'
);
      
[0m17:18:47.836477 [debug] [Thread-3 (]: On model.dbt_prod.src_flights__airports: Close
[0m17:18:47.836610 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.836986 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117df8e90>]}
[0m17:18:47.837274 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:47.837140 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.837572 [info ] [Thread-3 (]: 43 of 111 OK created sql table model bookings_dbt.src_flights__airports ........ [[32mSELECT 104[0m in 0.06s]
[0m17:18:47.838355 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.838521 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.838726 [debug] [Thread-3 (]: Finished running node model.dbt_prod.src_flights__airports
[0m17:18:47.838876 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.839008 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.839162 [debug] [Thread-3 (]: Began running node test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998
[0m17:18:47.839314 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.839470 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.839613 [info ] [Thread-3 (]: 46 of 111 START test dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_  [RUN]
[0m17:18:47.839748 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.839871 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.840026 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_prod.src_flights__airports, now test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998)
[0m17:18:47.840147 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.840272 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.840395 [debug] [Thread-3 (]: Began compiling node test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998
[0m17:18:47.840512 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.840610 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.842619 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998"
[0m17:18:47.842781 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.842904 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.843074 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.843236 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.843420 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.843551 [debug] [Thread-3 (]: Began executing node test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998
[0m17:18:47.843655 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.843780 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.844706 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998"
[0m17:18:47.844821 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.844949 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.845133 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.845276 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.845436 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.845589 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.845741 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.846068 [debug] [Thread-3 (]: Using postgres connection "test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998"
[0m17:18:47.845889 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.846214 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.846342 [debug] [Thread-3 (]: On test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998: BEGIN
[0m17:18:47.846466 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.846594 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.846714 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:47.846827 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.846929 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.847139 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.847266 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.847390 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.847509 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.847682 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.847854 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.847967 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.848155 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.848294 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.848428 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.848562 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.848672 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.848870 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.849001 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.849127 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.849254 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.849355 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.849558 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.849677 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.849838 [debug] [Thread-2 (]: On model.dbt_prod.stg_demo_src__airports: COMMIT
[0m17:18:47.849958 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.850083 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_demo_src__airports"
[0m17:18:47.850197 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.850323 [debug] [Thread-2 (]: On model.dbt_prod.stg_demo_src__airports: COMMIT
[0m17:18:47.850435 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.850570 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.850686 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.850843 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.851124 [debug] [Thread-1 (]: On model.dbt_prod.stg_flights__seats: COMMIT
[0m17:18:47.851240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.stg_flights__seats"
[0m17:18:47.851376 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:47.851486 [debug] [Thread-1 (]: On model.dbt_prod.stg_flights__seats: COMMIT
[0m17:18:47.852325 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."stg_demo_src__airports__dbt_backup"
[0m17:18:47.852447 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m17:18:47.852639 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_demo_src__airports"
[0m17:18:47.852758 [debug] [Thread-3 (]: Using postgres connection "test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998"
[0m17:18:47.852879 [debug] [Thread-2 (]: On model.dbt_prod.stg_demo_src__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_demo_src__airports"} */
drop view if exists "dbt_course"."bookings_dbt"."stg_demo_src__airports__dbt_backup" cascade
[0m17:18:47.853015 [debug] [Thread-3 (]: On test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998"} */
select
      sum(coalesce(diff_count, 0)) as failures,
      sum(coalesce(diff_count, 0)) != 0 as should_warn,
      sum(coalesce(diff_count, 0)) != 0 as should_error
    from (
      




with a as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_a 
    from "dbt_course"."demo_src"."flights"
    group by id_dbtutils_test_equal_rowcount


),
b as (

    select 
      
      1 as id_dbtutils_test_equal_rowcount,
      count(*) as count_b 
    from "dbt_course"."bookings_dbt"."fct_flights"
    group by id_dbtutils_test_equal_rowcount

),
final as (

    select
    
        a.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_a,
          b.id_dbtutils_test_equal_rowcount as id_dbtutils_test_equal_rowcount_b,
        

        count_a,
        count_b,
        abs(count_a - count_b) as diff_count

    from a
    full join b
    on
    a.id_dbtutils_test_equal_rowcount = b.id_dbtutils_test_equal_rowcount
    


)

select * from final


      
    ) dbt_internal_test
[0m17:18:47.853143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:47.854407 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."stg_flights__seats__dbt_backup"
[0m17:18:47.854553 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:18:47.854743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.stg_flights__seats"
[0m17:18:47.855297 [debug] [Thread-2 (]: On model.dbt_prod.stg_demo_src__airports: Close
[0m17:18:47.855425 [debug] [Thread-1 (]: On model.dbt_prod.stg_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_flights__seats"} */
drop table if exists "dbt_course"."bookings_dbt"."stg_flights__seats__dbt_backup" cascade
[0m17:18:47.855661 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117173230>]}
[0m17:18:47.855906 [info ] [Thread-2 (]: 44 of 111 OK created sql view model bookings_dbt.stg_demo_src__airports ........ [[32mCREATE VIEW[0m in 0.05s]
[0m17:18:47.856139 [debug] [Thread-2 (]: Finished running node model.dbt_prod.stg_demo_src__airports
[0m17:18:47.856318 [debug] [Thread-2 (]: Began running node model.dbt_prod.stg_dict_sity_region
[0m17:18:47.856451 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:18:47.856628 [info ] [Thread-2 (]: 47 of 111 START sql table model bookings_dbt.stg_dict_sity_region .............. [RUN]
[0m17:18:47.857136 [debug] [Thread-1 (]: On model.dbt_prod.stg_flights__seats: Close
[0m17:18:47.857274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_prod.stg_demo_src__airports, now model.dbt_prod.stg_dict_sity_region)
[0m17:18:47.857408 [debug] [Thread-2 (]: Began compiling node model.dbt_prod.stg_dict_sity_region
[0m17:18:47.857610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116aad310>]}
[0m17:18:47.858797 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_prod.stg_dict_sity_region"
[0m17:18:47.859054 [info ] [Thread-1 (]: 45 of 111 OK created sql table model bookings_dbt.stg_flights__seats ........... [[32mSELECT 1339[0m in 0.05s]
[0m17:18:47.859270 [debug] [Thread-1 (]: Finished running node model.dbt_prod.stg_flights__seats
[0m17:18:47.859404 [debug] [Thread-1 (]: Began running node snapshot.dbt_prod.snap_city_region
[0m17:18:47.859579 [info ] [Thread-1 (]: 48 of 111 START snapshot snapshot.snap_city_region ............................. [RUN]
[0m17:18:47.859780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_prod.stg_flights__seats, now snapshot.dbt_prod.snap_city_region)
[0m17:18:47.859894 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_prod.snap_city_region
[0m17:18:47.860009 [debug] [Thread-2 (]: Began executing node model.dbt_prod.stg_dict_sity_region
[0m17:18:47.861354 [debug] [Thread-1 (]: Began executing node snapshot.dbt_prod.snap_city_region
[0m17:18:47.865239 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_prod.stg_dict_sity_region"
[0m17:18:47.865445 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m17:18:47.865573 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.075 seconds
[0m17:18:47.868979 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.869593 [debug] [Thread-3 (]: On test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998: ROLLBACK
[0m17:18:47.870641 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_tickets"
[0m17:18:47.870849 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: BEGIN
[0m17:18:47.871040 [debug] [Thread-4 (]: On model.dbt_prod.fct_tickets: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_tickets"} */
alter table "dbt_course"."bookings_dbt"."fct_tickets" rename to "fct_tickets__dbt_backup"
[0m17:18:47.871167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:47.871325 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_sity_region"
[0m17:18:47.871484 [debug] [Thread-3 (]: On test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998: Close
[0m17:18:47.871674 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_sity_region: BEGIN
[0m17:18:47.871831 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:47.872250 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.872058 [info ] [Thread-3 (]: 46 of 111 PASS dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_  [[32mPASS[0m in 0.03s]
[0m17:18:47.873654 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_tickets"
[0m17:18:47.873855 [debug] [Thread-3 (]: Finished running node test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998
[0m17:18:47.873988 [debug] [Thread-4 (]: On model.dbt_prod.fct_tickets: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_tickets"} */
alter table "dbt_course"."bookings_dbt"."fct_tickets__dbt_tmp" rename to "fct_tickets"
[0m17:18:47.874144 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_documentation_coverage
[0m17:18:47.874351 [info ] [Thread-3 (]: 49 of 111 START sql view model bookings_dbt.fct_documentation_coverage ......... [RUN]
[0m17:18:47.874499 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_prod.dbt_utils_source_equal_rowcount_demo_src_flights_ref_fct_flights_.38740a4998, now model.dbt_project_evaluator.fct_documentation_coverage)
[0m17:18:47.874615 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_documentation_coverage
[0m17:18:47.874729 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.877836 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_documentation_coverage"
[0m17:18:47.878691 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_tickets"
[0m17:18:47.878985 [debug] [Thread-4 (]: On model.dbt_prod.fct_tickets: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_tickets"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_tickets'
);
      
[0m17:18:47.879216 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_documentation_coverage
[0m17:18:47.880753 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_documentation_coverage"
[0m17:18:47.880913 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m17:18:47.881073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:18:47.881210 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.002 seconds
[0m17:18:47.881376 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_sity_region"
[0m17:18:47.881517 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.882195 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.882385 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m17:18:47.882517 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_sity_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_dict_sity_region"} */

  
    

  create  table "dbt_course"."bookings_dbt"."stg_dict_sity_region__dbt_tmp"
  
  
    as
  
  (
    


select
    city,
    region

from "dbt_course"."bookings_dbt_seeds"."city_region"
  );
  
[0m17:18:47.882645 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'snap_city_region'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:47.882789 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.882929 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_documentation_coverage: BEGIN
[0m17:18:47.883090 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.883239 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:47.883366 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.883553 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.883677 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.883896 [debug] [Thread-2 (]: SQL status: SELECT 6 in 0.001 seconds
[0m17:18:47.883797 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.885265 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_sity_region"
[0m17:18:47.885426 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.885616 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_sity_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_dict_sity_region"} */
alter table "dbt_course"."bookings_dbt"."stg_dict_sity_region" rename to "stg_dict_sity_region__dbt_backup"
[0m17:18:47.885767 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.003 seconds
[0m17:18:47.885919 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.887182 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.887330 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.887501 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.887716 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'snap_city_region'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:47.888747 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_sity_region"
[0m17:18:47.888871 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m17:18:47.889002 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.889167 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_sity_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_dict_sity_region"} */
alter table "dbt_course"."bookings_dbt"."stg_dict_sity_region__dbt_tmp" rename to "stg_dict_sity_region"
[0m17:18:47.889294 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m17:18:47.889431 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.889628 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_documentation_coverage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_documentation_coverage"} */

  create view "dbt_course"."bookings_dbt"."fct_documentation_coverage__dbt_tmp"
    
    
  as (
    with

models as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where resource_type = 'model'
    and not is_excluded
),

conversion as (
    select
        resource_id,
        case when is_described then 1 else 0 end as is_described_model,
        
            case when model_type = 'base' then 1.0 else NULL end as is_base_model,
            case when is_described and model_type = 'base' then 1.0 else 0 end as is_described_base_model,
        
            case when model_type = 'staging' then 1.0 else NULL end as is_staging_model,
            case when is_described and model_type = 'staging' then 1.0 else 0 end as is_described_staging_model,
        
            case when model_type = 'intermediate' then 1.0 else NULL end as is_intermediate_model,
            case when is_described and model_type = 'intermediate' then 1.0 else 0 end as is_described_intermediate_model,
        
            case when model_type = 'marts' then 1.0 else NULL end as is_marts_model,
            case when is_described and model_type = 'marts' then 1.0 else 0 end as is_described_marts_model,
        
            case when model_type = 'other' then 1.0 else NULL end as is_other_model,
            case when is_described and model_type = 'other' then 1.0 else 0 end as is_described_other_model
        

    from models
),

final as (
    select
        now() as measured_at,
        cast(count(*) as integer) as total_models,
        cast(sum(is_described_model) as integer) as documented_models,
        round(sum(is_described_model) * 100.00 / count(*), 2) as documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_base_model) * 100 ) / nullif( ( count(is_base_model) ), 0)

            , 2) as base_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_staging_model) * 100 ) / nullif( ( count(is_staging_model) ), 0)

            , 2) as staging_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_intermediate_model) * 100 ) / nullif( ( count(is_intermediate_model) ), 0)

            , 2) as intermediate_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_marts_model) * 100 ) / nullif( ( count(is_marts_model) ), 0)

            , 2) as marts_documentation_coverage_pct,
        
            round(
                
    ( sum(is_described_other_model) * 100 ) / nullif( ( count(is_other_model) ), 0)

            , 2) as other_documentation_coverage_pct
        

    from models
    left join conversion
    on models.resource_id = conversion.resource_id
)

select * from final
  );
[0m17:18:47.889948 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.889824 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.890830 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_sity_region"
[0m17:18:47.890959 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m17:18:47.891207 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_sity_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_dict_sity_region"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'stg_dict_sity_region'
);
      
[0m17:18:47.891087 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.892434 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.892554 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:47.892698 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.892832 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */
select * from (
        



select 
    city,
    region,
    updated_at

from "dbt_course"."bookings_dbt_seeds"."city_region"


    ) as __dbt_sbq
    where false
    limit 0

[0m17:18:47.893834 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m17:18:47.893958 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:47.894079 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.894244 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_documentation_coverage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_documentation_coverage"} */
alter table "dbt_course"."bookings_dbt"."fct_documentation_coverage__dbt_tmp" rename to "fct_documentation_coverage"
[0m17:18:47.894825 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.894959 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m17:18:47.895094 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.896078 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.895282 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.896244 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.896364 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.896506 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */
select * from (
        



select 
    city,
    region,
    updated_at

from "dbt_course"."bookings_dbt_seeds"."city_region"


    ) as __dbt_sbq
    where false
    limit 0

[0m17:18:47.896646 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.897719 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m17:18:47.897835 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.897987 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.898138 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_documentation_coverage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_documentation_coverage"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_documentation_coverage'
);
      
[0m17:18:47.898280 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.898404 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m17:18:47.898513 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.898666 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.899150 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.899292 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.899442 [debug] [Thread-3 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:47.899570 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.899781 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */

        
  
    

  create temporary table "snap_city_region__dbt_tmp171847895543"
  
  
    as
  
  (
    
    
        
    
    with snapshot_query as (

        



select 
    city,
    region,
    updated_at

from "dbt_course"."bookings_dbt_seeds"."city_region"



    ),

    snapshotted_data as (

        select *, 
    
        city as dbt_unique_key
    

        from "dbt_course"."snapshot"."snap_city_region"
        where
            
		
		

		
                ( (dbt_valid_to = '9999-01-01'::date)
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        city as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), '9999-01-01'::date)
  as dbt_valid_to
,
            md5(coalesce(cast(city as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*,'False' as dbt_is_deleted

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id, snapshotted_data.dbt_is_deleted

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id, snapshotted_data.dbt_is_deleted
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )
        
    ,
    deletion_records as (

        select
            'insert' as dbt_change_type,snapshotted_data."city",
            snapshotted_data."region",
            snapshotted_data."updated_at",
            snapshotted_data.dbt_unique_key as dbt_unique_key,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            snapshotted_data.dbt_valid_to as dbt_valid_to,
            md5(coalesce(cast(dbt_scd_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
            'True' as dbt_is_deleted
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where 
    
        source_data.dbt_unique_key is null
    


    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes
    union all
    select * from deletion_records

  );
  
    
[0m17:18:47.899954 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.900441 [info ] [Thread-3 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.900574 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.900722 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.900907 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.901052 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.901180 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.901307 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.901429 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.901548 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.901665 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.901785 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.901901 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.902033 [info ] [Thread-3 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.902151 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.902289 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.902469 [debug] [Thread-1 (]: SQL status: SELECT 23 in 0.002 seconds
[0m17:18:47.902645 [info ] [Thread-3 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.902783 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.902919 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.903970 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.904097 [info ] [Thread-3 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.904220 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.904369 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.904536 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_city_region__dbt_tmp171847895543'
        
      order by ordinal_position

  
[0m17:18:47.904679 [info ] [Thread-3 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.904811 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.904944 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.905098 [info ] [Thread-3 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.905241 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.905370 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.905507 [info ] [Thread-3 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.905687 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.905838 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.905985 [info ] [Thread-3 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.906283 [debug] [Thread-4 (]: On model.dbt_prod.fct_tickets: COMMIT
[0m17:18:47.906419 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m17:18:47.906538 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.906672 [info ] [Thread-3 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.906810 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_tickets"
[0m17:18:47.908126 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.908261 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.908370 [info ] [Thread-3 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.908536 [debug] [Thread-4 (]: On model.dbt_prod.fct_tickets: COMMIT
[0m17:18:47.908660 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'snap_city_region'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:47.908783 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.908910 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.909095 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.909248 [info ] [Thread-3 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.909415 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.909683 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:47.909521 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.910622 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_tickets__dbt_backup"
[0m17:18:47.909804 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.910784 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.002 seconds
[0m17:18:47.910909 [info ] [Thread-3 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.911126 [debug] [Thread-4 (]: Using postgres connection "model.dbt_prod.fct_tickets"
[0m17:18:47.912285 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.911258 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.912437 [info ] [Thread-3 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.912568 [debug] [Thread-4 (]: On model.dbt_prod.fct_tickets: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.fct_tickets"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_tickets__dbt_backup" cascade
[0m17:18:47.912689 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_city_region__dbt_tmp171847895543'
        
      order by ordinal_position

  
[0m17:18:47.912812 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.912965 [info ] [Thread-3 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.913188 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.913327 [info ] [Thread-3 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.913476 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.913608 [info ] [Thread-3 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.913780 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.913945 [info ] [Thread-3 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.914132 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.914415 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m17:18:47.914540 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:18:47.914275 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.914668 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.916088 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.916548 [debug] [Thread-4 (]: On model.dbt_prod.fct_tickets: Close
[0m17:18:47.916669 [info ] [Thread-3 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.916803 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.916939 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'snap_city_region'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:47.917081 [info ] [Thread-3 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.917297 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117d2f4d0>]}
[0m17:18:47.917502 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.917654 [info ] [Thread-3 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.918006 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_sity_region: COMMIT
[0m17:18:47.918202 [info ] [Thread-4 (]: 42 of 111 OK created sql table model bookings_dbt.fct_tickets .................. [[32mSELECT 5[0m in 0.15s]
[0m17:18:47.918446 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_sity_region"
[0m17:18:47.918339 [info ] [Thread-3 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.918644 [debug] [Thread-4 (]: Finished running node model.dbt_prod.fct_tickets
[0m17:18:47.918769 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.001 seconds
[0m17:18:47.918889 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_sity_region: COMMIT
[0m17:18:47.919142 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_duplicate_sources
[0m17:18:47.919007 [info ] [Thread-3 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.920467 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.920765 [info ] [Thread-4 (]: 50 of 111 START sql table model bookings_dbt.fct_duplicate_sources ............. [RUN]
[0m17:18:47.921105 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snap_city_region__dbt_tmp171847895543'
        
      order by ordinal_position

  
[0m17:18:47.920912 [info ] [Thread-3 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.921281 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:47.921425 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_prod.fct_tickets, now model.dbt_project_evaluator.fct_duplicate_sources)
[0m17:18:47.922609 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."stg_dict_sity_region__dbt_backup"
[0m17:18:47.921564 [info ] [Thread-3 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.922770 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.001 seconds
[0m17:18:47.922891 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_duplicate_sources
[0m17:18:47.923106 [debug] [Thread-2 (]: Using postgres connection "model.dbt_prod.stg_dict_sity_region"
[0m17:18:47.923230 [info ] [Thread-3 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.923947 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.929380 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_duplicate_sources"
[0m17:18:47.929558 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_sity_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.stg_dict_sity_region"} */
drop table if exists "dbt_course"."bookings_dbt"."stg_dict_sity_region__dbt_backup" cascade
[0m17:18:47.929746 [info ] [Thread-3 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.929950 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */
select * from (
        
    
        
    
    with snapshot_query as (

        



select 
    city,
    region,
    updated_at

from "dbt_course"."bookings_dbt_seeds"."city_region"



    ),

    snapshotted_data as (

        select *, 
    
        city as dbt_unique_key
    

        from "dbt_course"."snapshot"."snap_city_region"
        where
            
		
		

		
                ( (dbt_valid_to = '9999-01-01'::date)
 or dbt_valid_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        city as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), '9999-01-01'::date)
  as dbt_valid_to
,
            md5(coalesce(cast(city as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        city as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        city as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*,'False' as dbt_is_deleted

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id, snapshotted_data.dbt_is_deleted

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )
    ,
    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_to,
            snapshotted_data.dbt_scd_id, snapshotted_data.dbt_is_deleted
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )
        
    ,
    deletion_records as (

        select
            'insert' as dbt_change_type,snapshotted_data."city",
            snapshotted_data."region",
            snapshotted_data."updated_at",
            snapshotted_data.dbt_unique_key as dbt_unique_key,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_updated_at,
            snapshotted_data.dbt_valid_to as dbt_valid_to,
            md5(coalesce(cast(dbt_scd_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
            'True' as dbt_is_deleted
        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where 
    
        source_data.dbt_unique_key is null
    


    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes
    union all
    select * from deletion_records

    ) as __dbt_sbq
    where false
    limit 0

[0m17:18:47.930242 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_documentation_coverage: COMMIT
[0m17:18:47.930430 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m17:18:47.930552 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_documentation_coverage: COMMIT
[0m17:18:47.930742 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_duplicate_sources
[0m17:18:47.930879 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m17:18:47.932274 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_duplicate_sources"
[0m17:18:47.932537 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.932654 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:18:47.932780 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:47.932921 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m17:18:47.933422 [debug] [Thread-2 (]: On model.dbt_prod.stg_dict_sity_region: Close
[0m17:18:47.934310 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_documentation_coverage__dbt_backup"
[0m17:18:47.934469 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m17:18:47.934651 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bf8770>]}
[0m17:18:47.934836 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_documentation_coverage"
[0m17:18:47.934956 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m17:18:47.935074 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_duplicate_sources: BEGIN
[0m17:18:47.935427 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_documentation_coverage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_documentation_coverage"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_documentation_coverage__dbt_backup" cascade
[0m17:18:47.935314 [info ] [Thread-2 (]: 47 of 111 OK created sql table model bookings_dbt.stg_dict_sity_region ......... [[32mSELECT 6[0m in 0.08s]
[0m17:18:47.935690 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.935812 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:47.936014 [debug] [Thread-2 (]: Finished running node model.dbt_prod.stg_dict_sity_region
[0m17:18:47.936179 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:47.936407 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_hard_coded_references
[0m17:18:47.936999 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_documentation_coverage: Close
[0m17:18:47.937198 [info ] [Thread-2 (]: 51 of 111 START sql table model bookings_dbt.fct_hard_coded_references ......... [RUN]
[0m17:18:47.937390 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.937559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_prod.stg_dict_sity_region, now model.dbt_project_evaluator.fct_hard_coded_references)
[0m17:18:47.937735 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117742d50>]}
[0m17:18:47.937872 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.snap_city_region"} */

      update "dbt_course"."snapshot"."snap_city_region"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snap_city_region__dbt_tmp171847895543" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dbt_course"."snapshot"."snap_city_region".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and ("dbt_course"."snapshot"."snap_city_region".dbt_valid_to = '9999-01-01'::date or "dbt_course"."snapshot"."snap_city_region".dbt_valid_to is null);
      


    insert into "dbt_course"."snapshot"."snap_city_region" ("city", "region", "updated_at", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id", "dbt_is_deleted")
    select DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."region",DBT_INTERNAL_SOURCE."updated_at",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id",DBT_INTERNAL_SOURCE."dbt_is_deleted"
    from "snap_city_region__dbt_tmp171847895543" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:18:47.938020 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_hard_coded_references
[0m17:18:47.938257 [info ] [Thread-3 (]: 49 of 111 OK created sql view model bookings_dbt.fct_documentation_coverage .... [[32mCREATE VIEW[0m in 0.06s]
[0m17:18:47.939615 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_hard_coded_references"
[0m17:18:47.939754 [debug] [Thread-1 (]: SQL status: INSERT 0 12 in 0.001 seconds
[0m17:18:47.939942 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_documentation_coverage
[0m17:18:47.940440 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: COMMIT
[0m17:18:47.940651 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_model_naming_conventions
[0m17:18:47.940815 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.snap_city_region"
[0m17:18:47.940978 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m17:18:47.941333 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_hard_coded_references
[0m17:18:47.941217 [info ] [Thread-3 (]: 52 of 111 START sql view model bookings_dbt.fct_model_naming_conventions ....... [RUN]
[0m17:18:47.941481 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: COMMIT
[0m17:18:47.941601 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m17:18:47.944997 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_hard_coded_references"
[0m17:18:47.945146 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_documentation_coverage, now model.dbt_project_evaluator.fct_model_naming_conventions)
[0m17:18:47.945307 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_duplicate_sources__dbt_tmp"
  
  
    as
  
  (
    with sources as (
    select
        resource_name,
        case 
            -- if you're using databricks but not the unity catalog, database will be null
            when database is NULL then schema || '.' || identifier 
            else database || '.' || schema || '.' || identifier 
        end as source_db_location 
    from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where resource_type = 'source'
    and not is_excluded
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by 1, 2
),

source_duplicates as (
    select
        source_db_location,
        
    string_agg(
        resource_name,
        ', '
        
        ) as source_names
    from sources
    group by source_db_location
    having count(*) > 1
)

select * from source_duplicates



    

    
    

    

    


  );
  
[0m17:18:47.945505 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_model_naming_conventions
[0m17:18:47.947310 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m17:18:47.947485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:47.947649 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.002 seconds
[0m17:18:47.947802 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m17:18:47.948128 [debug] [Thread-1 (]: On snapshot.dbt_prod.snap_city_region: Close
[0m17:18:47.949523 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m17:18:47.949682 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_hard_coded_references: BEGIN
[0m17:18:47.949825 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_model_naming_conventions
[0m17:18:47.949950 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */
alter table "dbt_course"."bookings_dbt"."fct_duplicate_sources" rename to "fct_duplicate_sources__dbt_backup"
[0m17:18:47.950133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116cfca10>]}
[0m17:18:47.950250 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:47.951578 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m17:18:47.952049 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.951892 [info ] [Thread-1 (]: 48 of 111 OK snapshotted snapshot.snap_city_region ............................. [[32mINSERT 0 12[0m in 0.09s]
[0m17:18:47.953375 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m17:18:47.953631 [debug] [Thread-1 (]: Finished running node snapshot.dbt_prod.snap_city_region
[0m17:18:47.953783 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */
alter table "dbt_course"."bookings_dbt"."fct_duplicate_sources__dbt_tmp" rename to "fct_duplicate_sources"
[0m17:18:47.953947 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m17:18:47.954099 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_public_models_without_contract
[0m17:18:47.954296 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_naming_conventions: BEGIN
[0m17:18:47.954482 [info ] [Thread-1 (]: 53 of 111 START sql view model bookings_dbt.fct_public_models_without_contract . [RUN]
[0m17:18:47.954649 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:47.954775 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.954929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_prod.snap_city_region, now model.dbt_project_evaluator.fct_public_models_without_contract)
[0m17:18:47.955822 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m17:18:47.955954 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_public_models_without_contract
[0m17:18:47.956084 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_duplicate_sources'
);
      
[0m17:18:47.957360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m17:18:47.957515 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m17:18:47.957684 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m17:18:47.957809 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_hard_coded_references__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model has hard coded references

with models as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where resource_type = 'model'
    and not is_excluded
),

final as (
    select
        resource_name as model,
        hard_coded_references
    from models
    where hard_coded_references != ''
)

select * from final



    

    
    

    

    


  );
  
[0m17:18:47.958008 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:47.958155 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_public_models_without_contract
[0m17:18:47.960305 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m17:18:47.958733 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.960470 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.003 seconds
[0m17:18:47.960673 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.961789 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m17:18:47.961915 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.962077 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m17:18:47.962201 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */
alter table "dbt_course"."bookings_dbt"."fct_hard_coded_references" rename to "fct_hard_coded_references__dbt_backup"
[0m17:18:47.962442 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m17:18:47.962568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m17:18:47.962337 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.962767 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_naming_conventions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_naming_conventions"} */

  create view "dbt_course"."bookings_dbt"."fct_model_naming_conventions__dbt_tmp"
    
    
  as (
    -- all models with inappropriate (or lack of) pre-fix
-- ensure dbt project has consistent naming conventions

with all_graph_resources as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where not is_excluded
    -- exclude required metricflow time spine
    and resource_name != 'metricflow_time_spine'
),

naming_convention_prefixes as (
    select * from "dbt_course"."bookings_dbt"."stg_naming_convention_prefixes"
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by prefix_value
), 

appropriate_prefixes as (
    select 
        model_type, 
        
    string_agg(
        prefix_value,
        ', '
        
        ) as appropriate_prefixes
    from naming_convention_prefixes
    group by model_type
), 

models as (
    select
        all_graph_resources.resource_name,
        all_graph_resources.prefix,
        all_graph_resources.model_type,
        naming_convention_prefixes.prefix_value
    from all_graph_resources 
    left join naming_convention_prefixes
        on all_graph_resources.model_type = naming_convention_prefixes.model_type
        and all_graph_resources.prefix = naming_convention_prefixes.prefix_value
    where resource_type = 'model'
),

inappropriate_model_names as (
    select 
        models.resource_name,
        models.prefix,
        models.model_type,
        appropriate_prefixes.appropriate_prefixes
    from models
    left join appropriate_prefixes
        on models.model_type = appropriate_prefixes.model_type
    where nullif(models.prefix_value, '') is null

)

select * from inappropriate_model_names



    

    
    

    

    


  );
[0m17:18:47.962966 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_public_models_without_contract: BEGIN
[0m17:18:47.963114 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.963240 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.963427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:47.964690 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m17:18:47.964866 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.965062 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:47.965191 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */
alter table "dbt_course"."bookings_dbt"."fct_hard_coded_references__dbt_tmp" rename to "fct_hard_coded_references"
[0m17:18:47.965322 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.966373 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m17:18:47.966532 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.966701 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_naming_conventions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_naming_conventions"} */
alter table "dbt_course"."bookings_dbt"."fct_model_naming_conventions__dbt_tmp" rename to "fct_model_naming_conventions"
[0m17:18:47.966840 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.966981 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.967895 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m17:18:47.968018 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:47.968138 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.968277 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_hard_coded_references'
);
      
[0m17:18:47.969061 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m17:18:47.969213 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.969373 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_naming_conventions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_naming_conventions"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_model_naming_conventions'
);
      
[0m17:18:47.969504 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.969703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:18:47.969862 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:47.969988 [debug] [Thread-3 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:47.970104 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.970316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m17:18:47.970913 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.971520 [info ] [Thread-3 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.971686 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.971849 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_public_models_without_contract: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_public_models_without_contract"} */

  create view "dbt_course"."bookings_dbt"."fct_public_models_without_contract__dbt_tmp"
    
    
  as (
    with 

all_resources as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where not is_excluded
),

final as (

    select 
        resource_name,
        is_public,
        is_contract_enforced
        
    from all_resources
    where 
        is_public 
        and not is_contract_enforced
)

select * from final



    

    
    

    

    


  );
[0m17:18:47.972026 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.972205 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.972337 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.972491 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.972617 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.972750 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.972903 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.973008 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.973137 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.973296 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.973400 [info ] [Thread-3 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.973555 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.973678 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.973817 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m17:18:47.973934 [info ] [Thread-3 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.974056 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.974184 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.975524 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m17:18:47.975690 [info ] [Thread-3 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.975872 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.976020 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.976152 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_public_models_without_contract: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_public_models_without_contract"} */
alter table "dbt_course"."bookings_dbt"."fct_public_models_without_contract__dbt_tmp" rename to "fct_public_models_without_contract"
[0m17:18:47.976262 [info ] [Thread-3 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.976390 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.976512 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.976655 [info ] [Thread-3 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.976791 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.976918 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.977051 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:47.977157 [info ] [Thread-3 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.977280 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.977416 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.978225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m17:18:47.978340 [info ] [Thread-3 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.978459 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.978586 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.978714 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_public_models_without_contract: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_public_models_without_contract"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_public_models_without_contract'
);
      
[0m17:18:47.978842 [info ] [Thread-3 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.978958 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.979085 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.979231 [info ] [Thread-3 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.979407 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.979572 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.979719 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:47.979832 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.979986 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.980154 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.980732 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:47.980870 [info ] [Thread-3 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.981039 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.981177 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.981349 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:47.981486 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.981622 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.981763 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.981888 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:47.982010 [info ] [Thread-3 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.982145 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.982273 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.982394 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:47.982511 [info ] [Thread-3 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.982638 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.982769 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.982894 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:47.983021 [info ] [Thread-3 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.983188 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.983314 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.983438 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:47.983586 [info ] [Thread-3 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.983969 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_duplicate_sources: COMMIT
[0m17:18:47.984131 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.984321 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:47.984497 [info ] [Thread-3 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.984680 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m17:18:47.984827 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.984973 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:47.985106 [info ] [Thread-3 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.985260 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_duplicate_sources: COMMIT
[0m17:18:47.985434 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.985672 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:47.985835 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.986044 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.986220 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:47.986352 [info ] [Thread-3 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.986485 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.986687 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:47.986839 [info ] [Thread-3 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.987299 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.988124 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:47.987968 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:47.988350 [info ] [Thread-3 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:47.988528 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.989426 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_duplicate_sources__dbt_backup"
[0m17:18:47.989554 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:47.989693 [info ] [Thread-3 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:47.989837 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.990102 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_duplicate_sources"
[0m17:18:47.990254 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:47.990399 [info ] [Thread-3 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:47.990526 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.990676 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_duplicate_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_duplicate_sources"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_duplicate_sources__dbt_backup" cascade
[0m17:18:47.990838 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:47.990988 [info ] [Thread-3 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:47.991114 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.991250 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:47.991355 [info ] [Thread-3 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:47.991516 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.991660 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:47.991800 [info ] [Thread-3 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:47.992019 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.992166 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:47.992385 [info ] [Thread-3 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:47.992515 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:18:47.992785 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_hard_coded_references: COMMIT
[0m17:18:47.992912 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:47.993094 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_naming_conventions: COMMIT
[0m17:18:47.993645 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_duplicate_sources: Close
[0m17:18:47.993775 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m17:18:47.993900 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:47.994037 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m17:18:47.994169 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_hard_coded_references: COMMIT
[0m17:18:47.994378 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117dfadb0>]}
[0m17:18:47.994518 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:47.994656 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_naming_conventions: COMMIT
[0m17:18:47.994924 [info ] [Thread-4 (]: 50 of 111 OK created sql table model bookings_dbt.fct_duplicate_sources ........ [[32mSELECT 0[0m in 0.07s]
[0m17:18:47.995035 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:47.995409 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_duplicate_sources
[0m17:18:47.995557 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:47.995697 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m17:18:47.995993 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_source_directories
[0m17:18:47.995830 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:47.997376 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_hard_coded_references__dbt_backup"
[0m17:18:47.998188 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_model_naming_conventions__dbt_backup"
[0m17:18:47.998376 [info ] [Thread-4 (]: 54 of 111 START sql view model bookings_dbt.fct_source_directories ............. [RUN]
[0m17:18:47.998532 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:47.998755 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_hard_coded_references"
[0m17:18:47.998948 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_naming_conventions"
[0m17:18:47.999102 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_duplicate_sources, now model.dbt_project_evaluator.fct_source_directories)
[0m17:18:47.999229 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:47.999388 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_hard_coded_references: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_hard_coded_references"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_hard_coded_references__dbt_backup" cascade
[0m17:18:47.999547 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_naming_conventions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_naming_conventions"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_model_naming_conventions__dbt_backup" cascade
[0m17:18:47.999681 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_source_directories
[0m17:18:47.999811 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:48.001604 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_source_directories"
[0m17:18:48.001757 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:18:48.001997 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:18:48.001888 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:48.002629 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_hard_coded_references: Close
[0m17:18:48.003155 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_naming_conventions: Close
[0m17:18:48.003284 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:48.003539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117742d50>]}
[0m17:18:48.003697 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:48.003873 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1174529f0>]}
[0m17:18:48.004032 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_source_directories
[0m17:18:48.004342 [info ] [Thread-2 (]: 51 of 111 OK created sql table model bookings_dbt.fct_hard_coded_references .... [[32mSELECT 0[0m in 0.07s]
[0m17:18:48.004588 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:48.004868 [info ] [Thread-3 (]: 52 of 111 OK created sql view model bookings_dbt.fct_model_naming_conventions .. [[32mCREATE VIEW[0m in 0.06s]
[0m17:18:48.006240 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_source_directories"
[0m17:18:48.006407 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_hard_coded_references
[0m17:18:48.006588 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:48.006856 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_model_naming_conventions
[0m17:18:48.007050 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_sources_without_freshness
[0m17:18:48.007284 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:48.007470 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_undocumented_models
[0m17:18:48.007692 [info ] [Thread-2 (]: 55 of 111 START sql view model bookings_dbt.fct_sources_without_freshness ...... [RUN]
[0m17:18:48.007888 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m17:18:48.008067 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_public_models_without_contract: COMMIT
[0m17:18:48.008252 [info ] [Thread-3 (]: 56 of 111 START sql view model bookings_dbt.fct_undocumented_models ............ [RUN]
[0m17:18:48.008439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_hard_coded_references, now model.dbt_project_evaluator.fct_sources_without_freshness)
[0m17:18:48.008570 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_directories: BEGIN
[0m17:18:48.008698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m17:18:48.008830 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_naming_conventions, now model.dbt_project_evaluator.fct_undocumented_models)
[0m17:18:48.008952 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_sources_without_freshness
[0m17:18:48.009065 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:48.009177 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_public_models_without_contract: COMMIT
[0m17:18:48.009288 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_undocumented_models
[0m17:18:48.010817 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m17:18:48.012152 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_models"
[0m17:18:48.012347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:48.013515 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_public_models_without_contract__dbt_backup"
[0m17:18:48.015228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_public_models_without_contract"
[0m17:18:48.016342 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_public_models_without_contract: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_public_models_without_contract"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_public_models_without_contract__dbt_backup" cascade
[0m17:18:48.018386 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_sources_without_freshness
[0m17:18:48.023960 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m17:18:48.024192 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m17:18:48.024900 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_public_models_without_contract: Close
[0m17:18:48.025061 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_undocumented_models
[0m17:18:48.025225 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m17:18:48.025463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116d81df0>]}
[0m17:18:48.027134 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_models"
[0m17:18:48.027330 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m17:18:48.027570 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m17:18:48.027816 [info ] [Thread-1 (]: 53 of 111 OK created sql view model bookings_dbt.fct_public_models_without_contract  [[32mCREATE VIEW[0m in 0.07s]
[0m17:18:48.028009 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_directories"} */

  create view "dbt_course"."bookings_dbt"."fct_source_directories__dbt_tmp"
    
    
  as (
    -- Because we often work with multiple data sources, in our staging directory, we create one directory per source.

-- This model finds all cases where a source definition is NOT in the appropriate subdirectory.



with all_graph_resources as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where not is_excluded
),

-- find all sources that are definied in a .yml file NOT in their subdirectory
inappropriate_subdirectories_sources as (
    select 
        resource_name,
        resource_type,
        file_path as current_file_path,
        'models/' || 'staging' || '/' || source_name || '/' || file_name as change_file_path_to
    from all_graph_resources
    where resource_type = 'source'
    and directory_path not like '%' || source_name || '%'
)

select * from inappropriate_subdirectories_sources



    

    
    

    

    


  );
[0m17:18:48.028189 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_sources_without_freshness: BEGIN
[0m17:18:48.028454 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_public_models_without_contract
[0m17:18:48.028633 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m17:18:48.028808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:48.028974 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_undocumented_public_models
[0m17:18:48.029138 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_undocumented_models: BEGIN
[0m17:18:48.029538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:48.029425 [info ] [Thread-1 (]: 57 of 111 START sql view model bookings_dbt.fct_undocumented_public_models ..... [RUN]
[0m17:18:48.029803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_public_models_without_contract, now model.dbt_project_evaluator.fct_undocumented_public_models)
[0m17:18:48.029922 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_undocumented_public_models
[0m17:18:48.031323 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m17:18:48.031511 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:18:48.032723 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m17:18:48.033059 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_directories"} */
alter table "dbt_course"."bookings_dbt"."fct_source_directories__dbt_tmp" rename to "fct_source_directories"
[0m17:18:48.033335 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_undocumented_public_models
[0m17:18:48.035477 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m17:18:48.035710 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:18:48.036752 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m17:18:48.036907 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m17:18:48.037056 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m17:18:48.037208 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_directories"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_source_directories'
);
      
[0m17:18:48.037360 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m17:18:48.037485 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m17:18:48.037624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m17:18:48.037774 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_undocumented_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_models"} */

  create view "dbt_course"."bookings_dbt"."fct_undocumented_models__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select
        resource_name,
        model_type

    from all_resources
    where not is_described and resource_type = 'model'

)

select * from final



    

    
    

    

    


  );
[0m17:18:48.037956 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_sources_without_freshness: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_sources_without_freshness"} */

  create view "dbt_course"."bookings_dbt"."fct_sources_without_freshness__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select distinct
        resource_name

    from all_resources
    where not is_freshness_enabled and resource_type = 'source'

)

select * from final



    

    
    

    

    


  );
[0m17:18:48.038110 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_undocumented_public_models: BEGIN
[0m17:18:48.038241 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:48.038399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.039088 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:48.039323 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:48.039449 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:48.039585 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:48.039907 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:48.039775 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:48.040083 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:48.043340 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m17:18:48.043512 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:48.044659 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m17:18:48.044792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:18:48.044915 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_undocumented_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_models"} */
alter table "dbt_course"."bookings_dbt"."fct_undocumented_models__dbt_tmp" rename to "fct_undocumented_models"
[0m17:18:48.045056 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:48.045209 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_sources_without_freshness: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_sources_without_freshness"} */
alter table "dbt_course"."bookings_dbt"."fct_sources_without_freshness__dbt_tmp" rename to "fct_sources_without_freshness"
[0m17:18:48.045336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m17:18:48.045486 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:48.045661 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_undocumented_public_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_public_models"} */

  create view "dbt_course"."bookings_dbt"."fct_undocumented_public_models__dbt_tmp"
    
    
  as (
    with 

all_resources as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where not is_excluded
),

final as (
    select 
        resource_name,
        access, 
        is_described, 
        total_defined_columns,
        total_described_columns
    
    from all_resources
    where 
        is_public 
        and (
            -- no model level description
            not is_described
            -- not all columns defined have descriptions
            or total_described_columns < total_defined_columns
            -- no columns defined at all
            or total_defined_columns = 0
        )
)

select * from final



    

    
    

    

    


  );
[0m17:18:48.045803 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:48.046120 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:48.046000 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:48.046294 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:48.047285 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m17:18:48.047420 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:48.047541 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:48.048318 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m17:18:48.048451 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_sources_without_freshness: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_sources_without_freshness"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_sources_without_freshness'
);
      
[0m17:18:48.049668 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m17:18:48.049782 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:48.049939 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_undocumented_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_models"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_undocumented_models'
);
      
[0m17:18:48.050135 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_undocumented_public_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_public_models"} */
alter table "dbt_course"."bookings_dbt"."fct_undocumented_public_models__dbt_tmp" rename to "fct_undocumented_public_models"
[0m17:18:48.050289 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:48.050486 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:48.050616 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:48.051136 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:48.051265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:48.051379 [debug] [Thread-3 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:48.051499 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:48.051660 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:48.052358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m17:18:48.052770 [info ] [Thread-3 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:48.052945 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:48.053073 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:48.053205 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_undocumented_public_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_public_models"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_undocumented_public_models'
);
      
[0m17:18:48.053360 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:48.053564 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:48.053705 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:48.053872 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:48.054028 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:48.054207 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:48.054379 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:48.054495 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:48.054628 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:48.054824 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:48.055392 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:48.055531 [info ] [Thread-3 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:48.055660 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:48.055799 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:48.055966 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:48.056106 [info ] [Thread-3 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:48.056245 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:48.056368 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:48.056523 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:48.056656 [info ] [Thread-3 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:48.056783 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:48.056922 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:48.057059 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:48.057197 [info ] [Thread-3 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:48.057316 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:48.057455 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:48.057610 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:48.057838 [info ] [Thread-3 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:48.057990 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:48.058146 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:48.058317 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:48.058476 [info ] [Thread-3 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:48.058646 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:48.058830 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:48.058959 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:48.059091 [info ] [Thread-3 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:48.059217 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:48.059358 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:48.059503 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:48.059664 [info ] [Thread-3 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:48.059860 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:48.060014 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:48.060149 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:48.060292 [info ] [Thread-3 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:48.060417 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:48.060535 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:48.060656 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:48.060786 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:48.060905 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:48.061125 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:48.061265 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:48.061407 [info ] [Thread-3 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:48.061575 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:48.061741 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:48.061860 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:48.061977 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:48.062095 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:48.062222 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:48.062337 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:48.062454 [info ] [Thread-3 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:48.062632 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:48.062785 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:48.062901 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:48.063015 [info ] [Thread-3 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:48.063188 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_directories: COMMIT
[0m17:18:48.063305 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:48.063432 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:48.063555 [info ] [Thread-3 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:48.063699 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m17:18:48.063830 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:48.063957 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:48.064077 [info ] [Thread-3 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:48.064294 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_directories: COMMIT
[0m17:18:48.064460 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:48.064662 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:48.064796 [info ] [Thread-3 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:48.064961 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:48.065127 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:48.065280 [info ] [Thread-3 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:48.065415 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:48.065566 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:48.065711 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:48.065903 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:48.066037 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:48.066145 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:48.066259 [info ] [Thread-3 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:48.066373 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:48.067260 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_source_directories__dbt_backup"
[0m17:18:48.067385 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:48.067530 [info ] [Thread-3 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:48.067680 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:48.067891 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_directories"
[0m17:18:48.068023 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:48.068166 [info ] [Thread-3 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:48.068303 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:48.068431 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_directories"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_source_directories__dbt_backup" cascade
[0m17:18:48.068547 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:48.068683 [info ] [Thread-3 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:48.068810 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:48.068948 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:48.069051 [info ] [Thread-3 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:48.069230 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:48.069343 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:48.069465 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:48.070155 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_directories: Close
[0m17:18:48.069587 [info ] [Thread-3 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:48.070310 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:48.070428 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:48.070585 [info ] [Thread-3 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:48.070809 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117eed5b0>]}
[0m17:18:48.070979 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:48.071097 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:48.071242 [info ] [Thread-3 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:48.071497 [info ] [Thread-4 (]: 54 of 111 OK created sql view model bookings_dbt.fct_source_directories ........ [[32mCREATE VIEW[0m in 0.07s]
[0m17:18:48.071678 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_sources_without_freshness: COMMIT
[0m17:18:48.071786 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:48.071973 [info ] [Thread-3 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:48.072182 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_source_directories
[0m17:18:48.072310 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m17:18:48.072428 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:48.072584 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_undocumented_models: COMMIT
[0m17:18:48.072718 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m17:18:48.072833 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_sources_without_freshness: COMMIT
[0m17:18:48.073020 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:48.073151 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m17:18:48.073329 [info ] [Thread-4 (]: 58 of 111 START sql view model bookings_dbt.fct_undocumented_source_tables ..... [RUN]
[0m17:18:48.073493 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:48.073628 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_undocumented_models: COMMIT
[0m17:18:48.073775 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_source_directories, now model.dbt_project_evaluator.fct_undocumented_source_tables)
[0m17:18:48.073947 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:48.074072 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:48.074200 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m17:18:48.074375 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_undocumented_public_models: COMMIT
[0m17:18:48.074524 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m17:18:48.075627 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_sources_without_freshness__dbt_backup"
[0m17:18:48.076935 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m17:18:48.077103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m17:18:48.078032 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_undocumented_models__dbt_backup"
[0m17:18:48.078233 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_sources_without_freshness"
[0m17:18:48.078376 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_undocumented_public_models: COMMIT
[0m17:18:48.078568 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_models"
[0m17:18:48.078738 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_sources_without_freshness: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_sources_without_freshness"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_sources_without_freshness__dbt_backup" cascade
[0m17:18:48.078896 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_undocumented_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_models"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_undocumented_models__dbt_backup" cascade
[0m17:18:48.079045 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m17:18:48.080479 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m17:18:48.080652 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:18:48.080785 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:18:48.080903 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:48.081539 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_sources_without_freshness: Close
[0m17:18:48.082031 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_undocumented_models: Close
[0m17:18:48.082987 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_undocumented_public_models__dbt_backup"
[0m17:18:48.083209 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bf8710>]}
[0m17:18:48.083407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_public_models"
[0m17:18:48.083548 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117173230>]}
[0m17:18:48.083674 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m17:18:48.084011 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_undocumented_public_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_public_models"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_undocumented_public_models__dbt_backup" cascade
[0m17:18:48.083904 [info ] [Thread-2 (]: 55 of 111 OK created sql view model bookings_dbt.fct_sources_without_freshness . [[32mCREATE VIEW[0m in 0.07s]
[0m17:18:48.084397 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_undocumented_source_tables: BEGIN
[0m17:18:48.084289 [info ] [Thread-3 (]: 56 of 111 OK created sql view model bookings_dbt.fct_undocumented_models ....... [[32mCREATE VIEW[0m in 0.07s]
[0m17:18:48.084616 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_sources_without_freshness
[0m17:18:48.084743 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:48.084881 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:48.085043 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_undocumented_models
[0m17:18:48.085178 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_undocumented_sources
[0m17:18:48.085788 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_undocumented_public_models: Close
[0m17:18:48.085957 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.int_direct_relationships
[0m17:18:48.086151 [info ] [Thread-2 (]: 59 of 111 START sql view model bookings_dbt.fct_undocumented_sources ........... [RUN]
[0m17:18:48.086596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bf8830>]}
[0m17:18:48.086443 [info ] [Thread-3 (]: 60 of 111 START sql view model bookings_dbt.int_direct_relationships ........... [RUN]
[0m17:18:48.086814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_sources_without_freshness, now model.dbt_project_evaluator.fct_undocumented_sources)
[0m17:18:48.087018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_models, now model.dbt_project_evaluator.int_direct_relationships)
[0m17:18:48.087225 [info ] [Thread-1 (]: 57 of 111 OK created sql view model bookings_dbt.fct_undocumented_public_models  [[32mCREATE VIEW[0m in 0.06s]
[0m17:18:48.087403 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_undocumented_sources
[0m17:18:48.087552 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.int_direct_relationships
[0m17:18:48.087757 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_undocumented_public_models
[0m17:18:48.089123 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_undocumented_sources"
[0m17:18:48.090981 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.int_direct_relationships"
[0m17:18:48.091176 [debug] [Thread-1 (]: Began running node snapshot.dbt_prod.dim_fligths__airports
[0m17:18:48.091520 [info ] [Thread-1 (]: 61 of 111 START snapshot snapshot.dim_fligths__airports ........................ [RUN]
[0m17:18:48.091700 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m17:18:48.091875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_public_models, now snapshot.dbt_prod.dim_fligths__airports)
[0m17:18:48.092027 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m17:18:48.092182 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_prod.dim_fligths__airports
[0m17:18:48.092330 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_undocumented_sources
[0m17:18:48.092461 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_undocumented_source_tables: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_source_tables"} */

  create view "dbt_course"."bookings_dbt"."fct_undocumented_source_tables__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select
        resource_name

    from all_resources
    where not is_described and resource_type = 'source'

)

select * from final



    

    
    

    

    


  );
[0m17:18:48.092587 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.int_direct_relationships
[0m17:18:48.093810 [debug] [Thread-1 (]: Began executing node snapshot.dbt_prod.dim_fligths__airports
[0m17:18:48.095252 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_undocumented_sources"
[0m17:18:48.096637 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.int_direct_relationships"
[0m17:18:48.096824 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m17:18:48.099524 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_fligths__airports"
[0m17:18:48.100718 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m17:18:48.100868 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_fligths__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_fligths__airports"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(airport_code as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        now()::timestamp without time zone as dbt_updated_at,
        now()::timestamp without time zone as dbt_effective_date_from,
        
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_effective_date_to
from (
        



SELECT
    airport_code,
    airport_name,
    city,
    coordinates,
    timezone
FROM
    "dbt_course"."bookings_dbt"."src_flights__airports"

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m17:18:48.101055 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_undocumented_source_tables: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_source_tables"} */
alter table "dbt_course"."bookings_dbt"."fct_undocumented_source_tables__dbt_tmp" rename to "fct_undocumented_source_tables"
[0m17:18:48.101234 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m17:18:48.101350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.101466 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m17:18:48.101605 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_undocumented_sources: BEGIN
[0m17:18:48.101774 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_direct_relationships: BEGIN
[0m17:18:48.101881 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:48.101987 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:48.102182 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:48.103095 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m17:18:48.103255 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_undocumented_source_tables: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_source_tables"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_undocumented_source_tables'
);
      
[0m17:18:48.103792 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:48.104538 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:48.104720 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:48.104841 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:48.104952 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:48.105064 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:48.105178 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:48.105286 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:48.105397 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:48.105508 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:48.105616 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:48.105728 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:48.105838 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:48.105948 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:48.106055 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:48.106166 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:48.106277 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:48.106385 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:48.106499 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:48.106608 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:48.106717 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:48.106828 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:48.106940 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:48.107053 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:48.107161 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:48.107271 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:48.107378 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:48.107487 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:48.107602 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:48.107708 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:48.107808 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:48.107905 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:48.108045 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:48.108203 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_undocumented_source_tables: COMMIT
[0m17:18:48.108402 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m17:18:48.108558 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_undocumented_source_tables: COMMIT
[0m17:18:48.108768 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m17:18:48.108924 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m17:18:48.109061 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m17:18:48.109227 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m17:18:48.109384 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:48.109580 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_direct_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_direct_relationships"} */

  create view "dbt_course"."bookings_dbt"."int_direct_relationships__dbt_tmp"
    
    
  as (
    -- one record for each resource in the graph and its direct parent
with 

all_graph_resources as (
    select
        resource_id,
        resource_name,
        resource_type,
        file_path,
        directory_path, 
        file_name,
        model_type,
        materialized,
        is_public, 
        access, 
        source_name,
        is_excluded
    from "dbt_course"."bookings_dbt"."int_all_graph_resources"
),

direct_model_relationships as (
    select  
        resource_id,
        direct_parent_id,
        is_primary_relationship
    from "dbt_course"."bookings_dbt"."stg_node_relationships"
),

direct_exposure_relationships as (
    select  
        resource_id,
        direct_parent_id,
        is_primary_relationship
    from "dbt_course"."bookings_dbt"."stg_exposure_relationships"
),

direct_metrics_relationships as (
    select  
        resource_id,
        direct_parent_id,
        is_primary_relationship
    from "dbt_course"."bookings_dbt"."stg_metric_relationships"
),

-- for all resources in the graph, find their direct parent
direct_relationships as (
    select
        all_graph_resources.resource_id,
        all_graph_resources.resource_name,
        all_graph_resources.resource_type,
        all_graph_resources.file_path,
        all_graph_resources.directory_path, 
        all_graph_resources.file_name,
        all_graph_resources.model_type,
        all_graph_resources.materialized,
        all_graph_resources.is_public, 
        all_graph_resources.access, 
        all_graph_resources.source_name,
        all_graph_resources.is_excluded,
        case 
            when all_graph_resources.resource_type = 'source' then null
            when all_graph_resources.resource_type = 'exposure' then exposures.direct_parent_id
            when all_graph_resources.resource_type = 'metric' then metrics.direct_parent_id
            when all_graph_resources.resource_type in ('model', 'snapshot', 'test') then models.direct_parent_id
            else null
        end as direct_parent_id,
        (
            all_graph_resources.resource_type = 'test'
            and models.is_primary_relationship
        ) as is_primary_test_relationship
    from all_graph_resources
    left join direct_model_relationships as models
        on all_graph_resources.resource_id = models.resource_id
    left join direct_exposure_relationships as exposures
        on all_graph_resources.resource_id = exposures.resource_id
    left join direct_metrics_relationships as metrics
        on all_graph_resources.resource_id = metrics.resource_id
),

final as (
    select
        md5(cast(coalesce(cast(resource_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(direct_parent_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as unique_id,
        *
    from direct_relationships
)

select * from final
  );
[0m17:18:48.109780 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bookings_dbt.src_flights__airports" does not exist
LINE 28:     "dbt_course"."bookings_dbt"."src_flights__airports"
             ^

[0m17:18:48.109922 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_undocumented_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_sources"} */

  create view "dbt_course"."bookings_dbt"."fct_undocumented_sources__dbt_tmp"
    
    
  as (
    with

all_resources as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where not is_excluded

),

final as (

    select distinct
        source_name

    from all_resources
    where not is_source_described and resource_type = 'source'

)

select * from final



    

    
    

    

    


  );
[0m17:18:48.111084 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_undocumented_source_tables__dbt_backup"
[0m17:18:48.111313 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_fligths__airports: Close
[0m17:18:48.111565 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_source_tables"
[0m17:18:48.112307 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_undocumented_source_tables: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_source_tables"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_undocumented_source_tables__dbt_backup" cascade
[0m17:18:48.112703 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m17:18:48.112859 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:48.114099 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m17:18:48.114228 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:18:48.114729 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_undocumented_source_tables: Close
[0m17:18:48.114875 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_undocumented_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_sources"} */
alter table "dbt_course"."bookings_dbt"."fct_undocumented_sources__dbt_tmp" rename to "fct_undocumented_sources"
[0m17:18:48.116014 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m17:18:48.116256 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117eec1d0>]}
[0m17:18:48.116413 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_direct_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_direct_relationships"} */
alter table "dbt_course"."bookings_dbt"."int_direct_relationships__dbt_tmp" rename to "int_direct_relationships"
[0m17:18:48.116644 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:48.117199 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:48.118115 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m17:18:48.118896 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m17:18:48.119187 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_undocumented_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_sources"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_undocumented_sources'
);
      
[0m17:18:48.119346 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_direct_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_direct_relationships"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'int_direct_relationships'
);
      
[0m17:18:48.119972 [debug] [Thread-3 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:48.120660 [info ] [Thread-3 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:48.120871 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:48.121030 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:48.121666 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:48.121877 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:48.122024 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:48.122180 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:48.122361 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:48.122567 [info ] [Thread-3 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:48.122713 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:48.122890 [info ] [Thread-3 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:48.123061 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:48.123197 [info ] [Thread-3 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:48.123332 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:48.123496 [info ] [Thread-3 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:48.123625 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:48.123754 [info ] [Thread-3 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:48.123888 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:48.124006 [info ] [Thread-3 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:48.124157 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:48.124279 [info ] [Thread-3 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:48.124448 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:48.124574 [info ] [Thread-3 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:48.124704 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:48.124828 [info ] [Thread-3 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:48.125043 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:48.126257 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:48.126684 [debug] [Thread-1 (]: Database Error in snapshot dim_fligths__airports (snapshots/flights/dim_flights__airports.sql)
  relation "bookings_dbt.src_flights__airports" does not exist
  LINE 28:     "dbt_course"."bookings_dbt"."src_flights__airports"
               ^
[0m17:18:48.126825 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:48.126981 [info ] [Thread-3 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:48.127208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bf8830>]}
[0m17:18:48.127359 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:48.127504 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:48.127699 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:48.127825 [info ] [Thread-3 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:48.127949 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:48.128081 [info ] [Thread-3 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:48.128210 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:48.128334 [info ] [Thread-3 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:48.128455 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:48.128581 [info ] [Thread-3 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:48.128709 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:48.128829 [info ] [Thread-3 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:48.128945 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:48.129068 [info ] [Thread-3 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:48.129188 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:48.129309 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:48.129432 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:48.129549 [info ] [Thread-3 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:48.129747 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:48.129910 [info ] [Thread-3 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:48.130076 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:48.130219 [info ] [Thread-3 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:48.130353 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:48.130501 [info ] [Thread-3 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:48.130620 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:48.130805 [info ] [Thread-3 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:48.130979 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:48.131127 [info ] [Thread-3 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:48.131263 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:48.131386 [info ] [Thread-3 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:48.131520 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:48.131647 [info ] [Thread-3 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:48.131765 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:48.131937 [info ] [Thread-3 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:48.132065 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:48.132253 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_direct_relationships: COMMIT
[0m17:18:48.132419 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:48.132562 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m17:18:48.132714 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_undocumented_sources: COMMIT
[0m17:18:48.132831 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_direct_relationships: COMMIT
[0m17:18:48.132943 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m17:18:48.133060 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_undocumented_sources: COMMIT
[0m17:18:48.133703 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:48.133814 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:48.134606 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_undocumented_sources__dbt_backup"
[0m17:18:48.135520 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."int_direct_relationships__dbt_backup"
[0m17:18:48.135691 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_undocumented_sources"
[0m17:18:48.135867 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_direct_relationships"
[0m17:18:48.135980 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_undocumented_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_undocumented_sources"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_undocumented_sources__dbt_backup" cascade
[0m17:18:48.136087 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_direct_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_direct_relationships"} */
drop view if exists "dbt_course"."bookings_dbt"."int_direct_relationships__dbt_backup" cascade
[0m17:18:48.136526 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:48.136672 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:48.137214 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_direct_relationships: Close
[0m17:18:48.137785 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_undocumented_sources: Close
[0m17:18:48.138107 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117ca01d0>]}
[0m17:18:48.138248 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117eef110>]}
[0m17:18:49.083196 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m17:18:49.084807 [error] [Thread-1 (]: 61 of 111 ERROR snapshotting snapshot.dim_fligths__airports .................... [[31mERROR[0m in 0.04s]
[0m17:18:49.085398 [info ] [Thread-2 (]: 59 of 111 OK created sql view model bookings_dbt.fct_undocumented_sources ...... [[32mCREATE VIEW[0m in 0.05s]
[0m17:18:49.087386 [debug] [Thread-1 (]: Finished running node snapshot.dbt_prod.dim_fligths__airports
[0m17:18:49.086292 [info ] [Thread-3 (]: 60 of 111 OK created sql view model bookings_dbt.int_direct_relationships ...... [[32mCREATE VIEW[0m in 0.05s]
[0m17:18:49.086862 [info ] [Thread-4 (]: 58 of 111 OK created sql view model bookings_dbt.fct_undocumented_source_tables  [[32mCREATE VIEW[0m in 0.04s]
[0m17:18:49.088056 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_undocumented_sources
[0m17:18:49.088642 [debug] [Thread-1 (]: Began running node snapshot.dbt_prod.dim_flights__seats
[0m17:18:49.089077 [debug] [Thread-7 (]: Marking all children of 'snapshot.dbt_prod.dim_fligths__airports' to be skipped because of status 'error'.  Reason: Database Error in snapshot dim_fligths__airports (snapshots/flights/dim_flights__airports.sql)
  relation "bookings_dbt.src_flights__airports" does not exist
  LINE 28:     "dbt_course"."bookings_dbt"."src_flights__airports"
               ^.
[0m17:18:49.089704 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.int_direct_relationships
[0m17:18:49.090501 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_undocumented_source_tables
[0m17:18:49.091172 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m17:18:49.091775 [info ] [Thread-1 (]: 62 of 111 START snapshot snapshot.dim_flights__seats ........................... [RUN]
[0m17:18:49.092978 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m17:18:49.093600 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m17:18:49.094201 [info ] [Thread-2 (]: 63 of 111 START test valid_documentation_coverage .............................. [RUN]
[0m17:18:49.094866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_prod.dim_fligths__airports, now snapshot.dbt_prod.dim_flights__seats)
[0m17:18:49.095309 [info ] [Thread-3 (]: 64 of 111 START test is_empty_fct_duplicate_sources_ ........................... [RUN]
[0m17:18:49.095680 [info ] [Thread-4 (]: 65 of 111 START test is_empty_fct_hard_coded_references_ ....................... [RUN]
[0m17:18:49.096063 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_sources, now test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7)
[0m17:18:49.096361 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_prod.dim_flights__seats
[0m17:18:49.096638 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_direct_relationships, now test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31)
[0m17:18:49.096903 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_undocumented_source_tables, now test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113)
[0m17:18:49.097159 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m17:18:49.101847 [debug] [Thread-1 (]: Began executing node snapshot.dbt_prod.dim_flights__seats
[0m17:18:49.102307 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m17:18:49.102558 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m17:18:49.109170 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m17:18:49.111310 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.117672 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m17:18:49.120033 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m17:18:49.120330 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */
select * from (
        select aircraft_code, seat_no, fare_conditions from (
                




select
    aircraft_code, 
    seat_no, 
    fare_conditions
from "dbt_course"."bookings_dbt"."stg_flights__seats"

            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m17:18:49.120761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.121174 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m17:18:49.121359 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m17:18:49.122817 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m17:18:49.122978 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m17:18:49.123941 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m17:18:49.125221 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m17:18:49.125672 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m17:18:49.125881 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m17:18:49.126073 [debug] [Thread-2 (]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: BEGIN
[0m17:18:49.126253 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m17:18:49.126423 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: BEGIN
[0m17:18:49.126578 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.126739 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: BEGIN
[0m17:18:49.126896 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.127096 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.130066 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m17:18:49.131707 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.131926 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: BEGIN
[0m17:18:49.132541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m17:18:49.132683 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.132822 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__seats'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:49.137574 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.137886 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.138076 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"
[0m17:18:49.138219 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.138377 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"
[0m17:18:49.138541 [debug] [Thread-2 (]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "dbt_course"."bookings_dbt"."fct_documentation_coverage"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not documentation_coverage_pct >= 100
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m17:18:49.138706 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"
[0m17:18:49.138889 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m17:18:49.139075 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_hard_coded_references"


      
    ) dbt_internal_test
[0m17:18:49.139281 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_duplicate_sources"


      
    ) dbt_internal_test
[0m17:18:49.140913 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.141101 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:18:49.141321 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__seats'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:49.142028 [debug] [Thread-2 (]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: ROLLBACK
[0m17:18:49.142205 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.142363 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.143053 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: ROLLBACK
[0m17:18:49.143221 [debug] [Thread-2 (]: On test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7: Close
[0m17:18:49.143882 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: ROLLBACK
[0m17:18:49.144058 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.002 seconds
[0m17:18:49.146317 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.144378 [warn ] [Thread-2 (]: 63 of 111 WARN 1 valid_documentation_coverage .................................. [[33mWARN 1[0m in 0.05s]
[0m17:18:49.146600 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31: Close
[0m17:18:49.146752 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113: Close
[0m17:18:49.146995 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */

        
  
    

  create temporary table "dim_flights__seats__dbt_tmp171849145256"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        




select
    aircraft_code, 
    seat_no, 
    fare_conditions
from "dbt_course"."bookings_dbt"."stg_flights__seats"


    ),

    snapshotted_data as (

        select *, 
    
        concat(aircraft_code, '-', seat_no) as dbt_unique_key
    

        from "dbt_course"."snapshot"."dim_flights__seats"
        where
            
		
		

		
                ( (dbt_effective_date_to = '9999-01-01'::date)
 or dbt_effective_date_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        concat(aircraft_code, '-', seat_no) as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_effective_date_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), '9999-01-01'::date)
  as dbt_effective_date_to
,
            md5(coalesce(cast(concat(aircraft_code, '-', seat_no) as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        concat(aircraft_code, '-', seat_no) as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_effective_date_from,
            now()::timestamp without time zone as dbt_effective_date_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."aircraft_code" != source_data."aircraft_code"
        or
        (
            ((snapshotted_data."aircraft_code" is null) and not (source_data."aircraft_code" is null))
            or
            ((not snapshotted_data."aircraft_code" is null) and (source_data."aircraft_code" is null))
        ) or snapshotted_data."seat_no" != source_data."seat_no"
        or
        (
            ((snapshotted_data."seat_no" is null) and not (source_data."seat_no" is null))
            or
            ((not snapshotted_data."seat_no" is null) and (source_data."seat_no" is null))
        ) or snapshotted_data."fare_conditions" != source_data."fare_conditions"
        or
        (
            ((snapshotted_data."fare_conditions" is null) and not (source_data."fare_conditions" is null))
            or
            ((not snapshotted_data."fare_conditions" is null) and (source_data."fare_conditions" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."aircraft_code" != source_data."aircraft_code"
        or
        (
            ((snapshotted_data."aircraft_code" is null) and not (source_data."aircraft_code" is null))
            or
            ((not snapshotted_data."aircraft_code" is null) and (source_data."aircraft_code" is null))
        ) or snapshotted_data."seat_no" != source_data."seat_no"
        or
        (
            ((snapshotted_data."seat_no" is null) and not (source_data."seat_no" is null))
            or
            ((not snapshotted_data."seat_no" is null) and (source_data."seat_no" is null))
        ) or snapshotted_data."fare_conditions" != source_data."fare_conditions"
        or
        (
            ((snapshotted_data."fare_conditions" is null) and not (source_data."fare_conditions" is null))
            or
            ((not snapshotted_data."fare_conditions" is null) and (source_data."fare_conditions" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m17:18:49.147329 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7
[0m17:18:49.147631 [info ] [Thread-4 (]: 65 of 111 PASS is_empty_fct_hard_coded_references_ ............................. [[32mPASS[0m in 0.05s]
[0m17:18:49.147861 [info ] [Thread-3 (]: 64 of 111 PASS is_empty_fct_duplicate_sources_ ................................. [[32mPASS[0m in 0.05s]
[0m17:18:49.148203 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m17:18:49.148494 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113
[0m17:18:49.148708 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31
[0m17:18:49.148883 [info ] [Thread-2 (]: 66 of 111 START test is_empty_fct_model_naming_conventions_ .................... [RUN]
[0m17:18:49.149109 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m17:18:49.149313 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m17:18:49.149517 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.valid_documentation_coverage.67ef7314a7, now test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2)
[0m17:18:49.149685 [info ] [Thread-4 (]: 67 of 111 START test is_empty_fct_public_models_without_contract_ .............. [RUN]
[0m17:18:49.149838 [info ] [Thread-3 (]: 68 of 111 START test is_empty_fct_source_directories_ .......................... [RUN]
[0m17:18:49.150106 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m17:18:49.150306 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_hard_coded_references_.9f62f70113, now test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0)
[0m17:18:49.150468 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_duplicate_sources_.642214de31, now test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c)
[0m17:18:49.152249 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m17:18:49.152406 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m17:18:49.152538 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m17:18:49.154452 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m17:18:49.156368 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m17:18:49.156605 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.009 seconds
[0m17:18:49.156892 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m17:18:49.158051 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.159144 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m17:18:49.159328 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__seats__dbt_tmp171849145256'
        
      order by ordinal_position

  
[0m17:18:49.159492 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m17:18:49.159658 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m17:18:49.160510 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m17:18:49.161424 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m17:18:49.161576 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.002 seconds
[0m17:18:49.161784 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m17:18:49.163047 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.163257 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: BEGIN
[0m17:18:49.163432 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m17:18:49.163576 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__seats'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:49.163750 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m17:18:49.163884 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.164014 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: BEGIN
[0m17:18:49.164161 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: BEGIN
[0m17:18:49.164346 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.164471 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.165441 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.001 seconds
[0m17:18:49.166929 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.167071 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__seats__dbt_tmp171849145256'
        
      order by ordinal_position

  
[0m17:18:49.168229 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:18:49.169288 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.169415 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__seats'
        
        and table_schema = 'snapshot'
        
      order by ordinal_position

  
[0m17:18:49.170448 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.001 seconds
[0m17:18:49.171721 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.171869 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dim_flights__seats__dbt_tmp171849145256'
        
      order by ordinal_position

  
[0m17:18:49.173222 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.001 seconds
[0m17:18:49.174309 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.174549 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */
select * from (
        
    
    with snapshot_query as (

        




select
    aircraft_code, 
    seat_no, 
    fare_conditions
from "dbt_course"."bookings_dbt"."stg_flights__seats"


    ),

    snapshotted_data as (

        select *, 
    
        concat(aircraft_code, '-', seat_no) as dbt_unique_key
    

        from "dbt_course"."snapshot"."dim_flights__seats"
        where
            
		
		

		
                ( (dbt_effective_date_to = '9999-01-01'::date)
 or dbt_effective_date_to is null )
            

    ),

    insertions_source_data as (

        select *, 
    
        concat(aircraft_code, '-', seat_no) as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_effective_date_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), '9999-01-01'::date)
  as dbt_effective_date_to
,
            md5(coalesce(cast(concat(aircraft_code, '-', seat_no) as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        concat(aircraft_code, '-', seat_no) as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_effective_date_from,
            now()::timestamp without time zone as dbt_effective_date_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."aircraft_code" != source_data."aircraft_code"
        or
        (
            ((snapshotted_data."aircraft_code" is null) and not (source_data."aircraft_code" is null))
            or
            ((not snapshotted_data."aircraft_code" is null) and (source_data."aircraft_code" is null))
        ) or snapshotted_data."seat_no" != source_data."seat_no"
        or
        (
            ((snapshotted_data."seat_no" is null) and not (source_data."seat_no" is null))
            or
            ((not snapshotted_data."seat_no" is null) and (source_data."seat_no" is null))
        ) or snapshotted_data."fare_conditions" != source_data."fare_conditions"
        or
        (
            ((snapshotted_data."fare_conditions" is null) and not (source_data."fare_conditions" is null))
            or
            ((not snapshotted_data."fare_conditions" is null) and (source_data."fare_conditions" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."aircraft_code" != source_data."aircraft_code"
        or
        (
            ((snapshotted_data."aircraft_code" is null) and not (source_data."aircraft_code" is null))
            or
            ((not snapshotted_data."aircraft_code" is null) and (source_data."aircraft_code" is null))
        ) or snapshotted_data."seat_no" != source_data."seat_no"
        or
        (
            ((snapshotted_data."seat_no" is null) and not (source_data."seat_no" is null))
            or
            ((not snapshotted_data."seat_no" is null) and (source_data."seat_no" is null))
        ) or snapshotted_data."fare_conditions" != source_data."fare_conditions"
        or
        (
            ((snapshotted_data."fare_conditions" is null) and not (source_data."fare_conditions" is null))
            or
            ((not snapshotted_data."fare_conditions" is null) and (source_data."fare_conditions" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m17:18:49.174846 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.174986 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.175129 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"
[0m17:18:49.175293 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m17:18:49.175417 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"
[0m17:18:49.175537 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.175675 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_model_naming_conventions"


      
    ) dbt_internal_test
[0m17:18:49.175939 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.176065 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_public_models_without_contract"


      
    ) dbt_internal_test
[0m17:18:49.176193 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"
[0m17:18:49.176337 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m17:18:49.176496 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_source_directories"


      
    ) dbt_internal_test
[0m17:18:49.176848 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m17:18:49.177034 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.177216 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.177378 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.177907 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: ROLLBACK
[0m17:18:49.178032 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:18:49.178464 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: ROLLBACK
[0m17:18:49.179047 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: ROLLBACK
[0m17:18:49.179215 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0: Close
[0m17:18:49.179393 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.179600 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "snapshot.dbt_prod.dim_flights__seats"} */

      update "dbt_course"."snapshot"."dim_flights__seats"
    set dbt_effective_date_to = DBT_INTERNAL_SOURCE.dbt_effective_date_to
    from "dim_flights__seats__dbt_tmp171849145256" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dbt_course"."snapshot"."dim_flights__seats".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and ("dbt_course"."snapshot"."dim_flights__seats".dbt_effective_date_to = '9999-01-01'::date or "dbt_course"."snapshot"."dim_flights__seats".dbt_effective_date_to is null);
      


    insert into "dbt_course"."snapshot"."dim_flights__seats" ("aircraft_code", "seat_no", "fare_conditions", "dbt_updated_at", "dbt_effective_date_from", "dbt_effective_date_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."aircraft_code",DBT_INTERNAL_SOURCE."seat_no",DBT_INTERNAL_SOURCE."fare_conditions",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_effective_date_from",DBT_INTERNAL_SOURCE."dbt_effective_date_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "dim_flights__seats__dbt_tmp171849145256" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:18:49.179748 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2: Close
[0m17:18:49.180116 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c: Close
[0m17:18:49.179985 [info ] [Thread-4 (]: 67 of 111 PASS is_empty_fct_public_models_without_contract_ .................... [[32mPASS[0m in 0.03s]
[0m17:18:49.180312 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.000 seconds
[0m17:18:49.180548 [warn ] [Thread-2 (]: 66 of 111 WARN 9 is_empty_fct_model_naming_conventions_ ........................ [[33mWARN 9[0m in 0.03s]
[0m17:18:49.180988 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0
[0m17:18:49.180800 [warn ] [Thread-3 (]: 68 of 111 WARN 8 is_empty_fct_source_directories_ .............................. [[33mWARN 8[0m in 0.03s]
[0m17:18:49.181535 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: COMMIT
[0m17:18:49.181726 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2
[0m17:18:49.181873 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m17:18:49.182080 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c
[0m17:18:49.182217 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_prod.dim_flights__seats"
[0m17:18:49.182360 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m17:18:49.182501 [info ] [Thread-4 (]: 69 of 111 START test is_empty_fct_sources_without_freshness_ ................... [RUN]
[0m17:18:49.182653 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m17:18:49.182785 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: COMMIT
[0m17:18:49.182911 [info ] [Thread-2 (]: 70 of 111 START test is_empty_fct_undocumented_models_ ......................... [RUN]
[0m17:18:49.183061 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_public_models_without_contract_.bcf47f1cb0, now test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283)
[0m17:18:49.183191 [info ] [Thread-3 (]: 71 of 111 START test is_empty_fct_undocumented_public_models_ .................. [RUN]
[0m17:18:49.183352 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_naming_conventions_.a79bc0fbe2, now test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c)
[0m17:18:49.183473 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m17:18:49.183597 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_source_directories_.3ec42bc19c, now test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938)
[0m17:18:49.183712 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m17:18:49.185255 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m17:18:49.185384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:49.185498 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m17:18:49.187207 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m17:18:49.187622 [debug] [Thread-1 (]: On snapshot.dbt_prod.dim_flights__seats: Close
[0m17:18:49.189061 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m17:18:49.189355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1177403b0>]}
[0m17:18:49.189549 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m17:18:49.190299 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m17:18:49.190566 [info ] [Thread-1 (]: 62 of 111 OK snapshotted snapshot.dim_flights__seats ........................... [[32mINSERT 0 0[0m in 0.09s]
[0m17:18:49.190867 [debug] [Thread-1 (]: Finished running node snapshot.dbt_prod.dim_flights__seats
[0m17:18:49.191044 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m17:18:49.191172 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m17:18:49.191283 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m17:18:49.191424 [info ] [Thread-1 (]: 72 of 111 START test is_empty_fct_undocumented_sources_ ........................ [RUN]
[0m17:18:49.192384 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m17:18:49.193067 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m17:18:49.193220 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m17:18:49.193356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_prod.dim_flights__seats, now test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235)
[0m17:18:49.193533 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: BEGIN
[0m17:18:49.193652 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m17:18:49.193805 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.193934 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m17:18:49.195241 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m17:18:49.195388 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m17:18:49.195556 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: BEGIN
[0m17:18:49.195701 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: BEGIN
[0m17:18:49.195811 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.195938 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.196131 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m17:18:49.197078 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m17:18:49.197396 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m17:18:49.197510 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: BEGIN
[0m17:18:49.197613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.204285 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m17:18:49.204459 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"
[0m17:18:49.204582 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_sources_without_freshness"


      
    ) dbt_internal_test
[0m17:18:49.205533 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.205690 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m17:18:49.205835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:18:49.206486 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: ROLLBACK
[0m17:18:49.206623 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.206759 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"
[0m17:18:49.206893 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"
[0m17:18:49.207041 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"
[0m17:18:49.207165 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_undocumented_models"


      
    ) dbt_internal_test
[0m17:18:49.207285 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283: Close
[0m17:18:49.207404 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_undocumented_sources"


      
    ) dbt_internal_test
[0m17:18:49.207542 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_undocumented_public_models"


      
    ) dbt_internal_test
[0m17:18:49.207802 [warn ] [Thread-4 (]: 69 of 111 WARN 5 is_empty_fct_sources_without_freshness_ ....................... [[33mWARN 5[0m in 0.02s]
[0m17:18:49.208104 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283
[0m17:18:49.208254 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_test_directories
[0m17:18:49.208575 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.208727 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.208439 [info ] [Thread-4 (]: 73 of 111 START sql view model bookings_dbt.fct_test_directories ............... [RUN]
[0m17:18:49.209281 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: ROLLBACK
[0m17:18:49.209396 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:18:49.209891 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: ROLLBACK
[0m17:18:49.210038 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_sources_without_freshness_.7793415283, now model.dbt_project_evaluator.fct_test_directories)
[0m17:18:49.210507 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: ROLLBACK
[0m17:18:49.210640 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c: Close
[0m17:18:49.210760 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_test_directories
[0m17:18:49.210864 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938: Close
[0m17:18:49.214481 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_test_directories"
[0m17:18:49.214927 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235: Close
[0m17:18:49.214786 [warn ] [Thread-2 (]: 70 of 111 WARN 22 is_empty_fct_undocumented_models_ ............................ [[33mWARN 22[0m in 0.03s]
[0m17:18:49.215190 [info ] [Thread-3 (]: 71 of 111 PASS is_empty_fct_undocumented_public_models_ ........................ [[32mPASS[0m in 0.03s]
[0m17:18:49.215479 [info ] [Thread-1 (]: 72 of 111 PASS is_empty_fct_undocumented_sources_ .............................. [[32mPASS[0m in 0.02s]
[0m17:18:49.215686 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c
[0m17:18:49.215853 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938
[0m17:18:49.215980 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_test_directories
[0m17:18:49.216149 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235
[0m17:18:49.216279 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.int_all_dag_relationships
[0m17:18:49.216435 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.int_model_test_summary
[0m17:18:49.217847 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_test_directories"
[0m17:18:49.217985 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m17:18:49.218151 [info ] [Thread-2 (]: 74 of 111 START sql view model bookings_dbt.int_all_dag_relationships .......... [RUN]
[0m17:18:49.218320 [info ] [Thread-3 (]: 75 of 111 START sql view model bookings_dbt.int_model_test_summary ............. [RUN]
[0m17:18:49.218495 [info ] [Thread-1 (]: 76 of 111 START test is_empty_fct_undocumented_source_tables_ .................. [RUN]
[0m17:18:49.218690 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_models_.7c2f43109c, now model.dbt_project_evaluator.int_all_dag_relationships)
[0m17:18:49.218848 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m17:18:49.218964 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_public_models_.56938f1938, now model.dbt_project_evaluator.int_model_test_summary)
[0m17:18:49.219077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_sources_.0409327235, now test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166)
[0m17:18:49.219192 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.int_all_dag_relationships
[0m17:18:49.219295 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_test_directories: BEGIN
[0m17:18:49.219389 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.int_model_test_summary
[0m17:18:49.219496 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m17:18:49.224604 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.int_all_dag_relationships"
[0m17:18:49.224760 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.227664 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.int_model_test_summary"
[0m17:18:49.228936 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m17:18:49.229407 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.int_model_test_summary
[0m17:18:49.229562 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m17:18:49.229678 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.int_all_dag_relationships
[0m17:18:49.231356 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.int_model_test_summary"
[0m17:18:49.232016 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m17:18:49.233326 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.int_all_dag_relationships"
[0m17:18:49.233644 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m17:18:49.233774 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_model_test_summary: BEGIN
[0m17:18:49.233900 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m17:18:49.234012 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.234131 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m17:18:49.234239 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_all_dag_relationships: BEGIN
[0m17:18:49.234406 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: BEGIN
[0m17:18:49.234527 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.234634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.237469 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m17:18:49.237591 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m17:18:49.237735 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */

  create view "dbt_course"."bookings_dbt"."fct_test_directories__dbt_tmp"
    
    
  as (
    with

resources as (

    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where not is_excluded

),

relationships as (

    select * from "dbt_course"."bookings_dbt"."int_direct_relationships"

),

models_per_test as (

    select
        resource_name as test_name,
        resource_id as test_id,
        direct_parent_id as parent_model_id
    from relationships
    where resource_type = 'test'
    and is_primary_test_relationship

),

model_file_paths as (

    select
        resources.resource_id as model_id,
        resources.resource_name as model_name,
        resources.directory_path as model_directory_path,
        models_per_test.test_id,
        models_per_test.parent_model_id
    from resources
    inner join models_per_test
    on models_per_test.parent_model_id = resources.resource_id
    where resource_type = 'model'

),

test_file_paths as (

    select
        resource_id as test_id,
        resource_name as test_name,
        file_name as test_yml_name,
        directory_path as test_yml_directory_path
    from resources
    where 
        resource_type = 'test'
        and is_generic_test

),

all_file_paths as (

    select
        test_file_paths.test_id,
        test_file_paths.test_name,
        test_file_paths.test_yml_directory_path,
        test_file_paths.test_yml_name,
        model_file_paths.model_id,
        model_file_paths.model_name,
        model_file_paths.model_directory_path
    from model_file_paths
    inner join test_file_paths
    on model_file_paths.test_id = test_file_paths.test_id

),

different_directories as (

    select
        test_name,
        model_name,
        test_yml_directory_path as current_test_directory,
        model_directory_path as change_test_directory_to
    from all_file_paths
    where model_directory_path != test_yml_directory_path

)

select * from different_directories



    

    
    

    

    


  );
[0m17:18:49.239598 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:49.240731 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m17:18:49.240853 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */
alter table "dbt_course"."bookings_dbt"."fct_test_directories__dbt_tmp" rename to "fct_test_directories"
[0m17:18:49.241360 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.242237 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m17:18:49.242359 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_test_directories'
);
      
[0m17:18:49.242801 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:49.243360 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.243542 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.243665 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.243779 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.243892 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.244004 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.244115 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.244223 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.244334 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.244442 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.244586 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.244743 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.244896 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.245083 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.245221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.245363 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.245548 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m17:18:49.245663 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.245787 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"
[0m17:18:49.245913 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.246095 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */

  create view "dbt_course"."bookings_dbt"."int_model_test_summary__dbt_tmp"
    
    
  as (
    with 

all_graph_resources as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where not is_excluded
),

relationships as (
    select * from "dbt_course"."bookings_dbt"."int_direct_relationships"
),

count_column_tests as (
    
    select 
        relationships.direct_parent_id, 
        all_graph_resources.column_name,
        sum(case
                when all_graph_resources.is_test_unique
                then 1
                else 0
            end
         ) as test_unique_count,count(distinct case when 
                all_graph_resources.is_test_unique or  
                all_graph_resources.is_test_not_null
            then relationships.resource_id else null end
        ) as primary_key_method_1_count,count(distinct case when 
                all_graph_resources.is_test_unique_combination_of_columns
            then relationships.resource_id else null end
        ) as primary_key_method_2_count,
        count(distinct relationships.resource_id) as tests_count
    from all_graph_resources
    left join relationships
        on all_graph_resources.resource_id = relationships.resource_id
    where all_graph_resources.resource_type = 'test'
    and relationships.is_primary_test_relationship
    group by 1,2
),

count_column_constraints as (

    select
        node_unique_id as direct_parent_id,
        name as column_name,
        case
            when has_not_null_constraint
            then 1
            else 0
        end as constraint_not_null_count,
        constraints_count
    from "dbt_course"."bookings_dbt"."base_node_columns"

),

combine_column_counts as (

    select
        count_column_tests.*,
        count_column_tests.test_unique_count + count_column_constraints.constraint_not_null_count as primary_key_mixed_method_count,
        count_column_constraints.constraints_count
    from count_column_tests
    left join count_column_constraints
        on count_column_tests.direct_parent_id = count_column_constraints.direct_parent_id
        and count_column_tests.column_name = count_column_constraints.column_name

),

agg_test_relationships as (

    select 
        direct_parent_id, 
        cast(sum(case 
                when (
                    primary_key_method_1_count >= 2
                        or
                    primary_key_method_2_count >= 1
                        or
                    primary_key_mixed_method_count >= 2
                ) then 1 
                else 0 
            end
        ) >= 1 as boolean) as is_primary_key_tested,
        cast(sum(tests_count) as integer) as number_of_tests_on_model,
        cast(sum(constraints_count) as integer) as number_of_constraints_on_model
    from combine_column_counts
    group by 1

),

final as (
    select 
        all_graph_resources.resource_name,
        all_graph_resources.resource_type,
        all_graph_resources.model_type,
        cast(coalesce(agg_test_relationships.is_primary_key_tested, FALSE) as boolean) as is_primary_key_tested,
        cast(coalesce(agg_test_relationships.number_of_tests_on_model, 0) as integer) as number_of_tests_on_model,
        cast(coalesce(agg_test_relationships.number_of_constraints_on_model, 0) as integer) as number_of_constraints_on_model
    from all_graph_resources
    left join agg_test_relationships
        on all_graph_resources.resource_id = agg_test_relationships.direct_parent_id
    where
        all_graph_resources.resource_type in ('model', 'seed', 'source', 'snapshot')
)

select * from final
  );
[0m17:18:49.246267 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m17:18:49.246387 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_undocumented_source_tables"


      
    ) dbt_internal_test
[0m17:18:49.246510 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.246740 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */

  create view "dbt_course"."bookings_dbt"."int_all_dag_relationships__dbt_tmp"
    
    
  as (
    -- creates a cte called all_relationships that will either use "with recursive" or loops depending on the DW


with recursive direct_relationships as (
    select
        *
    from "dbt_course"."bookings_dbt"."int_direct_relationships"
    where resource_type <> 'test'
),

-- should this be a fct_ model?

-- recursive CTE
-- one record for every resource and each of its downstream children (including itself)
all_relationships (
    parent_id,
    parent,
    parent_resource_type,
    parent_model_type,
    parent_materialized,
    parent_access,
    parent_is_public,
    parent_source_name,
    parent_file_path,
    parent_directory_path,
    parent_file_name,
    parent_is_excluded,
    child_id,
    child,
    child_resource_type,
    child_model_type,
    child_materialized,
    child_access,
    child_is_public,
    child_source_name,
    child_file_path,
    child_directory_path,
    child_file_name,
    child_is_excluded,
    distance,
    path,
    is_dependent_on_chain_of_views
) as (
    -- anchor
    select distinct
        resource_id as parent_id,
        resource_name as parent,
        resource_type as parent_resource_type,
        model_type as parent_model_type,
        materialized as parent_materialized,
        access as parent_access,
        is_public as parent_is_public,
        source_name as parent_source_name,
        file_path as parent_file_path,
        directory_path as parent_directory_path,
        file_name as parent_file_name,
        is_excluded as parent_is_excluded,
        resource_id as child_id,
        resource_name as child,
        resource_type as child_resource_type,
        model_type as child_model_type,
        materialized as child_materialized,
        access as child_access,
        is_public as child_is_public,
        source_name as child_source_name,
        file_path as child_file_path,
        directory_path as child_directory_path,
        file_name as child_file_name,
        is_excluded as child_is_excluded,
        0 as distance,
        
    array[ resource_name ]
     as path,
        cast(null as boolean) as is_dependent_on_chain_of_views

    from direct_relationships
    -- where direct_parent_id is null 

    union all

    -- recursive clause
    select
        all_relationships.parent_id as parent_id,
        all_relationships.parent as parent,
        all_relationships.parent_resource_type as parent_resource_type,
        all_relationships.parent_model_type as parent_model_type,
        all_relationships.parent_materialized as parent_materialized,
        all_relationships.parent_access as parent_access,
        all_relationships.parent_is_public as parent_is_public,
        all_relationships.parent_source_name as parent_source_name,
        all_relationships.parent_file_path as parent_file_path,
        all_relationships.parent_directory_path as parent_directory_path,
        all_relationships.parent_file_name as parent_file_name,
        all_relationships.parent_is_excluded as parent_is_excluded,
        direct_relationships.resource_id as child_id,
        direct_relationships.resource_name as child,
        direct_relationships.resource_type as child_resource_type,
        direct_relationships.model_type as child_model_type,
        direct_relationships.materialized as child_materialized,
        direct_relationships.access as child_access,
        direct_relationships.is_public as child_is_public,
        direct_relationships.source_name as child_source_name,
        direct_relationships.file_path as child_file_path,
        direct_relationships.directory_path as child_directory_path,
        direct_relationships.file_name as child_file_name,
        direct_relationships.is_excluded as child_is_excluded,
        all_relationships.distance+1 as distance,
        array_append(all_relationships.path, direct_relationships.resource_name) as path,
        case
            when
                all_relationships.child_materialized in ('view', 'ephemeral')
                and coalesce(all_relationships.is_dependent_on_chain_of_views, true)
                then true
            else false
        end as is_dependent_on_chain_of_views

    from direct_relationships
    inner join all_relationships
        on all_relationships.child_id = direct_relationships.direct_parent_id

    

)



select * from all_relationships
order by parent, distance
  );
[0m17:18:49.246967 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.247126 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.247246 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.247358 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.247468 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.247581 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.247759 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.247909 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.248056 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.248177 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.248724 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: ROLLBACK
[0m17:18:49.248889 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.249012 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:49.249125 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:49.249250 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.250602 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m17:18:49.250731 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166: Close
[0m17:18:49.251680 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m17:18:49.251794 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.251925 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */
alter table "dbt_course"."bookings_dbt"."int_model_test_summary__dbt_tmp" rename to "int_model_test_summary"
[0m17:18:49.252066 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */
alter table "dbt_course"."bookings_dbt"."int_all_dag_relationships__dbt_tmp" rename to "int_all_dag_relationships"
[0m17:18:49.252282 [info ] [Thread-1 (]: 76 of 111 PASS is_empty_fct_undocumented_source_tables_ ........................ [[32mPASS[0m in 0.03s]
[0m17:18:49.252407 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.252638 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166
[0m17:18:49.252758 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.252971 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.253172 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.253356 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.253494 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.254386 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m17:18:49.254556 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_test_directories: COMMIT
[0m17:18:49.255332 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m17:18:49.255450 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'int_all_dag_relationships'
);
      
[0m17:18:49.255560 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m17:18:49.255666 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'int_model_test_summary'
);
      
[0m17:18:49.255824 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_test_directories: COMMIT
[0m17:18:49.256274 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:49.256446 [debug] [Thread-3 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:49.257013 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.257159 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:49.257607 [info ] [Thread-3 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.257806 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.258899 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_test_directories__dbt_backup"
[0m17:18:49.259054 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.259204 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.259427 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_directories"
[0m17:18:49.259560 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.259689 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.259825 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_test_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_directories"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_test_directories__dbt_backup" cascade
[0m17:18:49.259945 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.260072 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.260209 [info ] [Thread-3 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.260455 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:49.260312 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.260593 [info ] [Thread-3 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.261096 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_test_directories: Close
[0m17:18:49.261220 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.261353 [info ] [Thread-3 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.261494 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.261731 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117566f30>]}
[0m17:18:49.261860 [info ] [Thread-3 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.262000 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.262303 [info ] [Thread-4 (]: 73 of 111 OK created sql view model bookings_dbt.fct_test_directories .......... [[32mCREATE VIEW[0m in 0.05s]
[0m17:18:49.262476 [info ] [Thread-3 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.262631 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.264830 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_test_directories
[0m17:18:49.265839 [info ] [Thread-3 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.267123 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.268428 [info ] [Thread-3 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.269569 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.270146 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m17:18:49.270625 [info ] [Thread-3 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.271900 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.272955 [info ] [Thread-1 (]: 77 of 111 START test is_empty_fct_test_directories_ ............................ [RUN]
[0m17:18:49.273820 [info ] [Thread-3 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.274209 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.275991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_undocumented_source_tables_.1c89ecc166, now test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433)
[0m17:18:49.276329 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.276664 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m17:18:49.276490 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.276819 [info ] [Thread-3 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.278354 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m17:18:49.278512 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.278645 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.278899 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.279395 [info ] [Thread-3 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.279647 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.280363 [info ] [Thread-3 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.280851 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.281014 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m17:18:49.281146 [info ] [Thread-3 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.281277 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.282387 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m17:18:49.282542 [info ] [Thread-3 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.282720 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.282919 [info ] [Thread-3 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.283082 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.283222 [info ] [Thread-3 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.283379 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m17:18:49.283504 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.283627 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.283754 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: BEGIN
[0m17:18:49.283873 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.283996 [info ] [Thread-3 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.284112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.284224 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.284369 [info ] [Thread-3 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.284570 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.284703 [info ] [Thread-3 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.284840 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.284971 [info ] [Thread-3 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.285096 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.285223 [info ] [Thread-3 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.285323 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.285454 [info ] [Thread-3 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.285608 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.285798 [info ] [Thread-3 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.285929 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.286059 [info ] [Thread-3 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.286237 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.286426 [info ] [Thread-3 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.286607 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_all_dag_relationships: COMMIT
[0m17:18:49.286761 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_model_test_summary: COMMIT
[0m17:18:49.286902 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m17:18:49.287068 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m17:18:49.287222 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_all_dag_relationships: COMMIT
[0m17:18:49.287352 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_model_test_summary: COMMIT
[0m17:18:49.290547 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m17:18:49.291400 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."int_model_test_summary__dbt_backup"
[0m17:18:49.291528 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m17:18:49.291749 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.int_model_test_summary"
[0m17:18:49.292708 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."int_all_dag_relationships__dbt_backup"
[0m17:18:49.292853 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_model_test_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_model_test_summary"} */
drop view if exists "dbt_course"."bookings_dbt"."int_model_test_summary__dbt_backup" cascade
[0m17:18:49.293051 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.int_all_dag_relationships"
[0m17:18:49.293195 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_all_dag_relationships: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.int_all_dag_relationships"} */
drop view if exists "dbt_course"."bookings_dbt"."int_all_dag_relationships__dbt_backup" cascade
[0m17:18:49.293322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:18:49.293445 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:49.293558 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"
[0m17:18:49.293673 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:49.294222 [debug] [Thread-3 (]: On model.dbt_project_evaluator.int_model_test_summary: Close
[0m17:18:49.294342 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_test_directories"


      
    ) dbt_internal_test
[0m17:18:49.294815 [debug] [Thread-2 (]: On model.dbt_project_evaluator.int_all_dag_relationships: Close
[0m17:18:49.295045 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fb93d0>]}
[0m17:18:49.295207 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117743470>]}
[0m17:18:49.295467 [info ] [Thread-3 (]: 75 of 111 OK created sql view model bookings_dbt.int_model_test_summary ........ [[32mCREATE VIEW[0m in 0.08s]
[0m17:18:49.295820 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.int_model_test_summary
[0m17:18:49.295628 [info ] [Thread-2 (]: 74 of 111 OK created sql view model bookings_dbt.int_all_dag_relationships ..... [[32mCREATE VIEW[0m in 0.08s]
[0m17:18:49.296120 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.int_all_dag_relationships
[0m17:18:49.296374 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_test_coverage
[0m17:18:49.296526 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m17:18:49.296889 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m17:18:49.296766 [info ] [Thread-3 (]: 79 of 111 START sql view model bookings_dbt.fct_test_coverage .................. [RUN]
[0m17:18:49.297067 [info ] [Thread-4 (]: 78 of 111 START sql view model bookings_dbt.fct_missing_primary_key_tests ...... [RUN]
[0m17:18:49.297235 [info ] [Thread-2 (]: 80 of 111 START sql view model bookings_dbt.fct_chained_views_dependencies ..... [RUN]
[0m17:18:49.297390 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_model_test_summary, now model.dbt_project_evaluator.fct_test_coverage)
[0m17:18:49.297521 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_test_directories, now model.dbt_project_evaluator.fct_missing_primary_key_tests)
[0m17:18:49.297654 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.int_all_dag_relationships, now model.dbt_project_evaluator.fct_chained_views_dependencies)
[0m17:18:49.297814 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_test_coverage
[0m17:18:49.297953 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m17:18:49.298067 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m17:18:49.300540 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_test_coverage"
[0m17:18:49.300682 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m17:18:49.302153 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m17:18:49.303693 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m17:18:49.304286 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: ROLLBACK
[0m17:18:49.304686 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_test_coverage
[0m17:18:49.306464 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_test_coverage"
[0m17:18:49.306600 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m17:18:49.306718 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433: Close
[0m17:18:49.306831 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m17:18:49.308095 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m17:18:49.308311 [warn ] [Thread-1 (]: 77 of 111 WARN 1 is_empty_fct_test_directories_ ................................ [[33mWARN 1[0m in 0.03s]
[0m17:18:49.309682 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m17:18:49.309836 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m17:18:49.310059 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433
[0m17:18:49.310230 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_test_coverage: BEGIN
[0m17:18:49.310370 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_direct_join_to_source
[0m17:18:49.310532 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m17:18:49.310662 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.310790 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m17:18:49.310956 [info ] [Thread-1 (]: 81 of 111 START sql table model bookings_dbt.fct_direct_join_to_source ......... [RUN]
[0m17:18:49.311092 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: BEGIN
[0m17:18:49.311251 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: BEGIN
[0m17:18:49.311376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_test_directories_.1c1db93433, now model.dbt_project_evaluator.fct_direct_join_to_source)
[0m17:18:49.311492 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.311602 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.311717 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_direct_join_to_source
[0m17:18:49.313073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m17:18:49.313317 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_direct_join_to_source
[0m17:18:49.316897 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m17:18:49.317159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m17:18:49.317264 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: BEGIN
[0m17:18:49.317361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.322707 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.322883 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m17:18:49.323007 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m17:18:49.323141 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m17:18:49.323285 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m17:18:49.323443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:18:49.323575 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m17:18:49.323721 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */

  create view "dbt_course"."bookings_dbt"."fct_chained_views_dependencies__dbt_tmp"
    
    
  as (
    with all_relationships as (
    select  
        *
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where distance <> 0
    and not parent_is_excluded
    and not child_is_excluded
),

final as (
    select
        parent,
        child, -- the model with potentially long run time / compilation time, improve performance by breaking the upstream chain of views
        distance,
        path
    from all_relationships
    where is_dependent_on_chain_of_views
    and child_resource_type = 'model'
    and distance > 5
)

select * from final



    

    
    

    

    



order by distance desc
  );
[0m17:18:49.323909 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */

  create view "dbt_course"."bookings_dbt"."fct_test_coverage__dbt_tmp"
    
    
  as (
    with

test_counts as (
    select * from "dbt_course"."bookings_dbt"."int_model_test_summary"
    where resource_type = 'model'
),

conversion as (
    select
        resource_name,
        cast(case when number_of_tests_on_model > 0 then 1 else 0 end as boolean) as is_tested_model,
        
            case when model_type = 'base' then 1.0 else NULL end as is_base_model,
            case when number_of_tests_on_model > 0 and model_type = 'base' then 1.0 else 0 end as is_tested_base_model,
        
            case when model_type = 'staging' then 1.0 else NULL end as is_staging_model,
            case when number_of_tests_on_model > 0 and model_type = 'staging' then 1.0 else 0 end as is_tested_staging_model,
        
            case when model_type = 'intermediate' then 1.0 else NULL end as is_intermediate_model,
            case when number_of_tests_on_model > 0 and model_type = 'intermediate' then 1.0 else 0 end as is_tested_intermediate_model,
        
            case when model_type = 'marts' then 1.0 else NULL end as is_marts_model,
            case when number_of_tests_on_model > 0 and model_type = 'marts' then 1.0 else 0 end as is_tested_marts_model,
        
            case when model_type = 'other' then 1.0 else NULL end as is_other_model,
            case when number_of_tests_on_model > 0 and model_type = 'other' then 1.0 else 0 end as is_tested_other_model
        

    from test_counts
),

final as (
    select
        now() as measured_at,
        cast(count(*) as integer) as total_models,
        cast(sum(number_of_tests_on_model) as integer) as total_tests,
        sum(cast(is_tested_model as integer)) as tested_models,
        round(sum(cast(is_tested_model as integer)) * 100.0 / count(*), 2) as test_coverage_pct,
        
            round(
                
    ( sum(is_tested_base_model) * 100.0 ) / nullif( ( count(is_base_model) ), 0)

            , 2) as base_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_staging_model) * 100.0 ) / nullif( ( count(is_staging_model) ), 0)

            , 2) as staging_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_intermediate_model) * 100.0 ) / nullif( ( count(is_intermediate_model) ), 0)

            , 2) as intermediate_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_marts_model) * 100.0 ) / nullif( ( count(is_marts_model) ), 0)

            , 2) as marts_test_coverage_pct,
        
            round(
                
    ( sum(is_tested_other_model) * 100.0 ) / nullif( ( count(is_other_model) ), 0)

            , 2) as other_test_coverage_pct,
        
        round(sum(number_of_tests_on_model) * 1.0000 / count(*), 4) as test_to_model_ratio

    from test_counts
    left join conversion
    on test_counts.resource_name = conversion.resource_name
)

select * from final
  );
[0m17:18:49.324076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m17:18:49.324203 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */

  create view "dbt_course"."bookings_dbt"."fct_missing_primary_key_tests__dbt_tmp"
    
    
  as (
    with

tests as (
    select * from "dbt_course"."bookings_dbt"."int_model_test_summary"
    where resource_type in
    (
        'model'
        
    )
),

final as (

    select
        resource_name,
        resource_type,
        model_type,
        is_primary_key_tested,
        number_of_tests_on_model,
        number_of_constraints_on_model
    from tests
    where not(is_primary_key_tested)

)

select * from final



    

    
    

    

    


  );
[0m17:18:49.324388 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_direct_join_to_source__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model has a reference to both a model and a source

with direct_model_relationships as (
    select  
        *
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where child_resource_type = 'model'
    and distance = 1
    and not parent_is_excluded
    and not child_is_excluded
),

model_and_source_joined as (
    select
        child,
        case 
            when (
                sum(case when parent_resource_type = 'model' then 1 else 0 end) > 0 
                and sum(case when parent_resource_type = 'source' then 1 else 0 end) > 0
            ) 
            then true
            else false 
        end as keep_row 
    from direct_model_relationships
    group by 1
),

final as (
    select 
        direct_model_relationships.parent,
        direct_model_relationships.parent_resource_type,
        direct_model_relationships.child,
        direct_model_relationships.child_resource_type,
        direct_model_relationships.distance
    from direct_model_relationships
    inner join model_and_source_joined
        on direct_model_relationships.child = model_and_source_joined.child
    where model_and_source_joined.keep_row
    order by direct_model_relationships.child
)

select * from final



    

    
    

    

    


  );
  
[0m17:18:49.325753 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m17:18:49.325875 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:49.326910 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m17:18:49.327040 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.002 seconds
[0m17:18:49.328232 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m17:18:49.328346 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m17:18:49.328469 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */
alter table "dbt_course"."bookings_dbt"."fct_missing_primary_key_tests__dbt_tmp" rename to "fct_missing_primary_key_tests"
[0m17:18:49.329740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m17:18:49.329893 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */
alter table "dbt_course"."bookings_dbt"."fct_chained_views_dependencies__dbt_tmp" rename to "fct_chained_views_dependencies"
[0m17:18:49.330906 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m17:18:49.331056 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */
alter table "dbt_course"."bookings_dbt"."fct_direct_join_to_source" rename to "fct_direct_join_to_source__dbt_backup"
[0m17:18:49.331206 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */
alter table "dbt_course"."bookings_dbt"."fct_test_coverage__dbt_tmp" rename to "fct_test_coverage"
[0m17:18:49.332467 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.332586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.332696 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:18:49.333535 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m17:18:49.333645 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:18:49.334555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m17:18:49.335296 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m17:18:49.335413 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_missing_primary_key_tests'
);
      
[0m17:18:49.336087 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m17:18:49.336196 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */
alter table "dbt_course"."bookings_dbt"."fct_direct_join_to_source__dbt_tmp" rename to "fct_direct_join_to_source"
[0m17:18:49.336325 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_chained_views_dependencies'
);
      
[0m17:18:49.336476 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_test_coverage'
);
      
[0m17:18:49.339492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:18:49.339662 [debug] [Thread-3 (]: SQL status: INSERT 0 1 in 0.003 seconds
[0m17:18:49.340335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m17:18:49.340445 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.004 seconds
[0m17:18:49.340557 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.004 seconds
[0m17:18:49.341003 [info ] [Thread-3 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.341161 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_direct_join_to_source'
);
      
[0m17:18:49.341659 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.342125 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.342280 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.342440 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.342592 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.342724 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.342854 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.342977 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.343102 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.343453 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:49.343571 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.343700 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.343838 [info ] [Thread-3 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.344320 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.344465 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.344601 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.344733 [info ] [Thread-3 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.344871 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.345001 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.345141 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.345278 [info ] [Thread-3 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.345407 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.345544 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.345669 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.345868 [info ] [Thread-3 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.346009 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.346127 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.346245 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.346362 [info ] [Thread-3 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.346500 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.346684 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.346940 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.347087 [info ] [Thread-3 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.347228 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.347348 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.347457 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.347608 [info ] [Thread-3 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.347770 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.347898 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.348025 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.348148 [info ] [Thread-3 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.348274 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.348399 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.348522 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.348642 [info ] [Thread-3 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.348770 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.348898 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.349024 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.349150 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.349271 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.349392 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.349513 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.349633 [info ] [Thread-3 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.349755 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.349873 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.349994 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.350115 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.350234 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.350356 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.350479 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.350602 [info ] [Thread-3 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.350773 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.350929 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.351088 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.351211 [info ] [Thread-3 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.351338 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.351459 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.351590 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.351727 [info ] [Thread-3 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.351846 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.351967 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.352086 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.352230 [info ] [Thread-3 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.352348 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.352470 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.352591 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.352705 [info ] [Thread-3 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.352833 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.352955 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.353114 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.353305 [info ] [Thread-3 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.353474 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.353608 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.353747 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.353879 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.354022 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.354179 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.354317 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.354454 [info ] [Thread-3 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.354582 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.354704 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.354827 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.354977 [info ] [Thread-3 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.355105 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.355249 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.355390 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.355521 [info ] [Thread-3 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.355649 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.355813 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.355933 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.356077 [info ] [Thread-3 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.356227 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.356354 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.356472 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.356587 [info ] [Thread-3 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.356730 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.356860 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.356987 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.357114 [info ] [Thread-3 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.357235 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.357355 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.357474 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.357596 [info ] [Thread-3 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.357722 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.357848 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.357961 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.358073 [info ] [Thread-3 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.358196 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.358323 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.358456 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.358623 [info ] [Thread-3 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.358752 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.358911 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.359066 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.359234 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_test_coverage: COMMIT
[0m17:18:49.359342 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.359495 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: COMMIT
[0m17:18:49.359624 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: COMMIT
[0m17:18:49.359737 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m17:18:49.359841 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.359974 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m17:18:49.360082 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m17:18:49.360193 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_test_coverage: COMMIT
[0m17:18:49.360293 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.360419 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: COMMIT
[0m17:18:49.360514 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: COMMIT
[0m17:18:49.360687 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.361030 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: COMMIT
[0m17:18:49.361147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m17:18:49.361236 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: COMMIT
[0m17:18:49.363948 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m17:18:49.364812 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_test_coverage__dbt_backup"
[0m17:18:49.364933 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:18:49.365115 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_test_coverage"
[0m17:18:49.365218 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m17:18:49.366098 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_direct_join_to_source__dbt_backup"
[0m17:18:49.366207 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m17:18:49.366312 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_test_coverage: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_test_coverage"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_test_coverage__dbt_backup" cascade
[0m17:18:49.366938 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_missing_primary_key_tests__dbt_backup"
[0m17:18:49.367102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_direct_join_to_source"
[0m17:18:49.367729 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_chained_views_dependencies__dbt_backup"
[0m17:18:49.368045 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_missing_primary_key_tests"
[0m17:18:49.368161 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_direct_join_to_source"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_direct_join_to_source__dbt_backup" cascade
[0m17:18:49.368320 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_chained_views_dependencies"
[0m17:18:49.368437 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:18:49.368542 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_missing_primary_key_tests"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_missing_primary_key_tests__dbt_backup" cascade
[0m17:18:49.368663 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_chained_views_dependencies"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_chained_views_dependencies__dbt_backup" cascade
[0m17:18:49.369137 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_test_coverage: Close
[0m17:18:49.369373 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fd6690>]}
[0m17:18:49.369584 [info ] [Thread-3 (]: 79 of 111 OK created sql view model bookings_dbt.fct_test_coverage ............. [[32mCREATE VIEW[0m in 0.07s]
[0m17:18:49.369729 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:18:49.369905 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_test_coverage
[0m17:18:49.370009 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:18:49.370513 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_missing_primary_key_tests: Close
[0m17:18:49.370726 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:18:49.370877 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m17:18:49.371418 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_chained_views_dependencies: Close
[0m17:18:49.371737 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117df9b50>]}
[0m17:18:49.372242 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_direct_join_to_source: Close
[0m17:18:49.372418 [info ] [Thread-3 (]: 82 of 111 START sql view model bookings_dbt.fct_exposure_parents_materializations  [RUN]
[0m17:18:49.372614 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1175c18b0>]}
[0m17:18:49.372816 [info ] [Thread-4 (]: 78 of 111 OK created sql view model bookings_dbt.fct_missing_primary_key_tests . [[32mCREATE VIEW[0m in 0.07s]
[0m17:18:49.372985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c5010>]}
[0m17:18:49.373101 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_test_coverage, now model.dbt_project_evaluator.fct_exposure_parents_materializations)
[0m17:18:49.373267 [info ] [Thread-2 (]: 80 of 111 OK created sql view model bookings_dbt.fct_chained_views_dependencies  [[32mCREATE VIEW[0m in 0.07s]
[0m17:18:49.373445 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_missing_primary_key_tests
[0m17:18:49.373608 [info ] [Thread-1 (]: 81 of 111 OK created sql table model bookings_dbt.fct_direct_join_to_source .... [[32mSELECT 0[0m in 0.06s]
[0m17:18:49.373739 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m17:18:49.373883 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_chained_views_dependencies
[0m17:18:49.373999 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m17:18:49.374137 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_direct_join_to_source
[0m17:18:49.375478 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m17:18:49.375640 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m17:18:49.375861 [info ] [Thread-4 (]: 83 of 111 START sql view model bookings_dbt.fct_exposures_dependent_on_private_models  [RUN]
[0m17:18:49.376020 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_model_directories
[0m17:18:49.376263 [info ] [Thread-2 (]: 84 of 111 START sql table model bookings_dbt.fct_marts_or_intermediate_dependent_on_source  [RUN]
[0m17:18:49.376445 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_missing_primary_key_tests, now model.dbt_project_evaluator.fct_exposures_dependent_on_private_models)
[0m17:18:49.376625 [info ] [Thread-1 (]: 85 of 111 START sql view model bookings_dbt.fct_model_directories .............. [RUN]
[0m17:18:49.376796 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_chained_views_dependencies, now model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source)
[0m17:18:49.376927 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m17:18:49.377045 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m17:18:49.377165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_direct_join_to_source, now model.dbt_project_evaluator.fct_model_directories)
[0m17:18:49.377276 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m17:18:49.378331 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m17:18:49.380088 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m17:18:49.380215 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_model_directories
[0m17:18:49.381379 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m17:18:49.383545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_directories"
[0m17:18:49.383843 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m17:18:49.384012 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m17:18:49.384162 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: BEGIN
[0m17:18:49.385573 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m17:18:49.385704 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_model_directories
[0m17:18:49.385841 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m17:18:49.385968 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.387541 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_model_directories"
[0m17:18:49.389024 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m17:18:49.389284 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m17:18:49.389533 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: BEGIN
[0m17:18:49.389700 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.389845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m17:18:49.390046 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m17:18:49.390177 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_model_directories: BEGIN
[0m17:18:49.390320 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: BEGIN
[0m17:18:49.390450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.390583 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.399779 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m17:18:49.399957 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m17:18:49.400088 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m17:18:49.400209 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m17:18:49.400342 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */

  create view "dbt_course"."bookings_dbt"."fct_exposures_dependent_on_private_models__dbt_tmp"
    
    
  as (
    with 

direct_exposure_relationships as (
    select * from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where 
        distance = 1
        and child_resource_type = 'exposure'
        and not (
                parent_resource_type = 'model'
                and parent_is_public
            )
        and not parent_is_excluded
),

final as (

    select 
        child as exposure_name,
        parent as parent_resource_name,
        parent_access,
        parent_resource_type

    from direct_exposure_relationships

)

select * from final



    

    
    

    

    


  );
[0m17:18:49.400493 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */

  create view "dbt_course"."bookings_dbt"."fct_exposure_parents_materializations__dbt_tmp"
    
    
  as (
    with 

direct_exposure_relationships as (
    select * from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where 
        distance = 1
        and child_resource_type = 'exposure'
        and ((
                parent_resource_type = 'model'
                and parent_materialized in ('view', 'ephemeral')
            )
            or (
                parent_resource_type = 'source'
            )
        )
        -- no test on child_is_excluded because exposures are never excluded
        and not parent_is_excluded
),

final as (

    select 
        parent_resource_type,
        parent as parent_resource_name,
        child as exposure_name,
        parent_materialized as parent_model_materialization

    from direct_exposure_relationships

)

select * from final



    

    
    

    

    


  );
[0m17:18:49.401672 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.401836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:49.401973 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m17:18:49.402115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m17:18:49.402271 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_marts_or_intermediate_dependent_on_source__dbt_tmp"
  
  
    as
  
  (
    -- cases where a marts/intermediate model directly references a raw source
with direct_relationships as (
    select  
        *
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where distance = 1
    and not parent_is_excluded
    and not child_is_excluded
),
final as (
    select
        parent,
        parent_resource_type,
        child,
        child_model_type
    from direct_relationships
    where parent_resource_type = 'source'
    and child_model_type in ('marts', 'intermediate')
)
select * from final



    

    
    

    

    


  );
  
[0m17:18:49.402430 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:49.402564 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:49.402733 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */

  create view "dbt_course"."bookings_dbt"."fct_model_directories__dbt_tmp"
    
    
  as (
    -- This model finds all cases where a model is NOT in the appropriate subdirectory:
    -- For staging models: The files should be in nested in the staging folder in a subfolder that matches their source parent's name.
    -- For non-staging models: The files should be nested closest to their appropriate folder.  

 
with all_graph_resources as (
    select * from "dbt_course"."bookings_dbt"."int_all_graph_resources"
    where not is_excluded
),

folders as (
    select * from "dbt_course"."bookings_dbt"."stg_naming_convention_folders"
), 

all_dag_relationships as (
    select * from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where not child_is_excluded
),

staging_models as (
    select  
        child,
        child_resource_type,
        child_model_type,
        child_file_path,
        child_directory_path,
        child_file_name,
        parent_source_name
    from all_dag_relationships
    where parent_resource_type = 'source'
    and child_resource_type = 'model'
    and child_model_type = 'staging'
),

-- find all staging models that are NOT in their source parent's subdirectory
inappropriate_subdirectories_staging as (
    select distinct -- must do distinct to avoid duplicates when staging model has multiple paths to a given source
        child as resource_name,
        child_resource_type as resource_type,
        child_model_type as model_type,
        child_file_path as current_file_path,
        'models/' || 'staging' || '/' || parent_source_name || '/' || child_file_name as change_file_path_to
    from staging_models
    where child_directory_path not like '%' || parent_source_name || '%'
),

-- find all non-staging models that are NOT nested closest to their appropriate folder
innappropriate_subdirectories_non_staging_models as (
    select 
        all_graph_resources.resource_name,
        all_graph_resources.resource_type,
        all_graph_resources.model_type,
        all_graph_resources.file_path as current_file_path,
        'models' || '/.../' || folders.folder_name_value || '/.../' || all_graph_resources.file_name as change_file_path_to
    from all_graph_resources
    left join folders 
        on folders.model_type = all_graph_resources.model_type 
    -- either appropriate folder_name is not in the current_directory_path or a inappropriate folder name is closer to the file_name
    where all_graph_resources.model_type <> all_graph_resources.model_type_folder 
),

unioned as (
    select * from inappropriate_subdirectories_staging
    union all
    select * from innappropriate_subdirectories_non_staging_models
)

select * from unioned



    

    
    

    

    


  );
[0m17:18:49.403994 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m17:18:49.405030 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m17:18:49.405209 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */
alter table "dbt_course"."bookings_dbt"."fct_exposure_parents_materializations__dbt_tmp" rename to "fct_exposure_parents_materializations"
[0m17:18:49.405367 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */
alter table "dbt_course"."bookings_dbt"."fct_exposures_dependent_on_private_models__dbt_tmp" rename to "fct_exposures_dependent_on_private_models"
[0m17:18:49.405897 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.003 seconds
[0m17:18:49.406028 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.407377 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m17:18:49.407497 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:18:49.407602 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:18:49.408481 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m17:18:49.408624 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */
alter table "dbt_course"."bookings_dbt"."fct_marts_or_intermediate_dependent_on_source" rename to "fct_marts_or_intermediate_dependent_on_source__dbt_backup"
[0m17:18:49.409313 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m17:18:49.410287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m17:18:49.410404 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_exposures_dependent_on_private_models'
);
      
[0m17:18:49.410564 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_exposure_parents_materializations'
);
      
[0m17:18:49.410712 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */
alter table "dbt_course"."bookings_dbt"."fct_model_directories__dbt_tmp" rename to "fct_model_directories"
[0m17:18:49.410912 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.411938 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m17:18:49.412068 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */
alter table "dbt_course"."bookings_dbt"."fct_marts_or_intermediate_dependent_on_source__dbt_tmp" rename to "fct_marts_or_intermediate_dependent_on_source"
[0m17:18:49.412199 [debug] [Thread-3 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:49.412347 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:49.413030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:18:49.412912 [info ] [Thread-3 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.413191 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.413661 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.414376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m17:18:49.414510 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.415125 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m17:18:49.415257 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.415394 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_model_directories'
);
      
[0m17:18:49.415508 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.415641 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_marts_or_intermediate_dependent_on_source'
);
      
[0m17:18:49.415752 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.415910 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.416072 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.416218 [info ] [Thread-3 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.416357 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:49.416479 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:49.416582 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.416711 [info ] [Thread-3 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.417148 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.417566 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.417695 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.417877 [info ] [Thread-3 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.418056 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.418224 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.418385 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.418523 [info ] [Thread-3 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.418696 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.418837 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.418977 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.419133 [info ] [Thread-3 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.419278 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.419416 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.419540 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.419674 [info ] [Thread-3 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.419836 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.419988 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.420149 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.420275 [info ] [Thread-3 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.420400 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.420525 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.420639 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.420774 [info ] [Thread-3 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.420907 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.421038 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.421162 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.421284 [info ] [Thread-3 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.421404 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.421524 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.421651 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.421778 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.421904 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.422029 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.422152 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.422279 [info ] [Thread-3 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.422407 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.422530 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.422646 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.422808 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.422974 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.423099 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.423234 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.423381 [info ] [Thread-3 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.423502 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.423625 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.423751 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.423864 [info ] [Thread-3 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.423974 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.424124 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.424277 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.424411 [info ] [Thread-3 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.424535 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.424658 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.424778 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.424894 [info ] [Thread-3 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.425013 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.425133 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.425249 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.425361 [info ] [Thread-3 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.425482 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.425599 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.425737 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.425863 [info ] [Thread-3 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.425982 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.426108 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.426239 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.426373 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.426495 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.426616 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.426736 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.426855 [info ] [Thread-3 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.426970 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.427093 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.427216 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.427356 [info ] [Thread-3 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.427489 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.427614 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.427799 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.427936 [info ] [Thread-3 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.428072 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.428205 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.428318 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.428437 [info ] [Thread-3 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.428551 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.428694 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.428835 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.428960 [info ] [Thread-3 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.429075 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.429228 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.429365 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.429496 [info ] [Thread-3 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.429635 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.429786 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.429931 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.430057 [info ] [Thread-3 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.430179 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.430302 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.430421 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.430548 [info ] [Thread-3 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.430665 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.430859 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.431007 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.431196 [info ] [Thread-3 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.431334 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.431461 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.431627 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.431810 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: COMMIT
[0m17:18:49.431920 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.432046 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.432202 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: COMMIT
[0m17:18:49.432317 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m17:18:49.432419 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.432545 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.432675 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m17:18:49.432835 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: COMMIT
[0m17:18:49.432947 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.433065 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.433208 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: COMMIT
[0m17:18:49.433365 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.433503 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.433697 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.433866 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.434032 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_model_directories: COMMIT
[0m17:18:49.434303 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: COMMIT
[0m17:18:49.434413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m17:18:49.434531 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:49.434643 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m17:18:49.434739 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_model_directories: COMMIT
[0m17:18:49.437741 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_exposure_parents_materializations__dbt_backup"
[0m17:18:49.437914 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: COMMIT
[0m17:18:49.438033 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m17:18:49.438266 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposure_parents_materializations"
[0m17:18:49.438994 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_exposures_dependent_on_private_models__dbt_backup"
[0m17:18:49.439166 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposure_parents_materializations"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_exposure_parents_materializations__dbt_backup" cascade
[0m17:18:49.439366 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"
[0m17:18:49.439514 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_exposures_dependent_on_private_models"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_exposures_dependent_on_private_models__dbt_backup" cascade
[0m17:18:49.439684 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:49.440498 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_model_directories__dbt_backup"
[0m17:18:49.440613 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:18:49.440777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_directories"
[0m17:18:49.440878 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:18:49.440988 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m17:18:49.441443 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_exposure_parents_materializations: Close
[0m17:18:49.441552 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_model_directories: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_directories"} */
drop view if exists "dbt_course"."bookings_dbt"."fct_model_directories__dbt_backup" cascade
[0m17:18:49.441908 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_exposures_dependent_on_private_models: Close
[0m17:18:49.442569 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_marts_or_intermediate_dependent_on_source__dbt_backup"
[0m17:18:49.442785 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117bfac90>]}
[0m17:18:49.442982 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"
[0m17:18:49.443124 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117eee990>]}
[0m17:18:49.443348 [info ] [Thread-3 (]: 82 of 111 OK created sql view model bookings_dbt.fct_exposure_parents_materializations  [[32mCREATE VIEW[0m in 0.07s]
[0m17:18:49.443497 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:18:49.443608 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_marts_or_intermediate_dependent_on_source__dbt_backup" cascade
[0m17:18:49.443802 [info ] [Thread-4 (]: 83 of 111 OK created sql view model bookings_dbt.fct_exposures_dependent_on_private_models  [[32mCREATE VIEW[0m in 0.07s]
[0m17:18:49.443988 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_exposure_parents_materializations
[0m17:18:49.444410 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_model_directories: Close
[0m17:18:49.444592 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_exposures_dependent_on_private_models
[0m17:18:49.444714 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_model_fanout
[0m17:18:49.444924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fa8e30>]}
[0m17:18:49.445054 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m17:18:49.445194 [info ] [Thread-3 (]: 86 of 111 START sql table model bookings_dbt.fct_model_fanout .................. [RUN]
[0m17:18:49.445458 [info ] [Thread-1 (]: 85 of 111 OK created sql view model bookings_dbt.fct_model_directories ......... [[32mCREATE VIEW[0m in 0.07s]
[0m17:18:49.445621 [info ] [Thread-4 (]: 87 of 111 START sql table model bookings_dbt.fct_multiple_sources_joined ....... [RUN]
[0m17:18:49.445768 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_exposure_parents_materializations, now model.dbt_project_evaluator.fct_model_fanout)
[0m17:18:49.445955 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_model_directories
[0m17:18:49.446078 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_exposures_dependent_on_private_models, now model.dbt_project_evaluator.fct_multiple_sources_joined)
[0m17:18:49.446238 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_model_fanout
[0m17:18:49.446367 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m17:18:49.446467 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m17:18:49.448380 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_model_fanout"
[0m17:18:49.448524 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:18:49.448682 [info ] [Thread-1 (]: 88 of 111 START sql table model bookings_dbt.fct_rejoining_of_upstream_concepts  [RUN]
[0m17:18:49.450078 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m17:18:49.450571 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source: Close
[0m17:18:49.450721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_directories, now model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts)
[0m17:18:49.450956 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m17:18:49.451108 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1175c0470>]}
[0m17:18:49.451214 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_model_fanout
[0m17:18:49.452197 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m17:18:49.452387 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m17:18:49.453997 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_model_fanout"
[0m17:18:49.454166 [info ] [Thread-2 (]: 84 of 111 OK created sql table model bookings_dbt.fct_marts_or_intermediate_dependent_on_source  [[32mSELECT 0[0m in 0.07s]
[0m17:18:49.455785 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m17:18:49.456064 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source
[0m17:18:49.456201 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m17:18:49.456390 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_root_models
[0m17:18:49.457661 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m17:18:49.457829 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m17:18:49.458233 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m17:18:49.458052 [info ] [Thread-2 (]: 89 of 111 START sql table model bookings_dbt.fct_root_models ................... [RUN]
[0m17:18:49.458397 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: BEGIN
[0m17:18:49.458520 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: BEGIN
[0m17:18:49.458667 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_marts_or_intermediate_dependent_on_source, now model.dbt_project_evaluator.fct_root_models)
[0m17:18:49.458792 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.458925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m17:18:49.459033 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.459144 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_root_models
[0m17:18:49.459307 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: BEGIN
[0m17:18:49.460801 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_root_models"
[0m17:18:49.460931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.461161 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_root_models
[0m17:18:49.462644 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_root_models"
[0m17:18:49.462947 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m17:18:49.463062 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_root_models: BEGIN
[0m17:18:49.463149 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.469108 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m17:18:49.469241 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m17:18:49.469354 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_multiple_sources_joined__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model references more than one source
with direct_source_relationships as (
    select distinct
        child,
        parent
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'source'
    and not parent_is_excluded
    and not child_is_excluded
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by 1, 2
),

multiple_sources_joined as (
    select
        child,
        
    string_agg(
        parent,
        ', '
        
        ) as source_parents
    from direct_source_relationships
    group by 1
    having count(*) > 1
)

select * from multiple_sources_joined



    

    
    

    

    


  );
  
[0m17:18:49.471208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:18:49.471400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m17:18:49.471562 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_rejoining_of_upstream_concepts__dbt_tmp"
  
  
    as
  
  (
    with all_relationships as (
    select  
        *
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where parent_resource_type not in ('exposure', 'metric')
    and child_resource_type not in ('exposure', 'metric')
    and not parent_is_excluded
    and not child_is_excluded
),

-- all parent/child relationships where the parent is BOTH the direct parent of the child and the second level parent of the child 
rejoined as (
    select
        parent,
        child
    from all_relationships
    group by 1, 2
    having (sum(case when distance = 1 then 1 else 0 end) >= 1 
        and sum(case when distance = 2 then 1 else 0 end) >= 1)
),

-- resources with only one direct child
single_use_resources as (
    select
        parent
    from all_relationships
    where distance = 1
    group by 1
    having count(*) = 1
),

-- all cases where one of the parent's direct children (child) is ALSO the direct child of ANOTHER one of the parent's direct childen (parent_and_child)
triad_relationships as (
    select 
        rejoined.parent,
        rejoined.child,
        direct_child.parent as parent_and_child
    from rejoined
    left join all_relationships as direct_child
        on rejoined.child = direct_child.child
        and direct_child.distance = 1
    left join all_relationships as direct_parent
        on rejoined.parent = direct_parent.parent
        and direct_parent.distance = 1
    where direct_child.parent = direct_parent.child
),

-- additionally, only includes cases where the model "in between" the parent and parent_and_child has NO other downstream dependencies
-- Note: when the "in between" model DOES have downstream dependencies, it's possible this DAG choice has been made to avoid duplicated code and as such is OKAY
final as (
    select
        triad_relationships.*,
        case 
            when single_use_resources.parent is not null then true 
            else false
        end as is_loop_independent
    from triad_relationships
    left join single_use_resources 
        on triad_relationships.parent_and_child = single_use_resources.parent
),

final_filtered as (
    select * from final
    where is_loop_independent
)

select * from final_filtered



    

    
    

    

    


  );
  
[0m17:18:49.471769 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m17:18:49.471954 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m17:18:49.472110 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m17:18:49.472237 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m17:18:49.472361 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.003 seconds
[0m17:18:49.472487 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_root_models__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a model has 0 direct parents, likely due to a lack of source or ref function

with model_relationships as (
    select  
        *
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where child_resource_type = 'model'
    -- only filter out excluded children nodes
        -- filtering parents could result in incorrectly flagging nodes that depend on excluded nodes
    and not child_is_excluded
    -- exclude required time spine
    and child != 'metricflow_time_spine'
),

final as (
    select
        child
    from model_relationships
    group by 1
    having max(distance) = 0
)

select * from final



    

    
    

    

    


  );
  
[0m17:18:49.472649 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_model_fanout__dbt_tmp"
  
  
    as
  
  (
    with all_dag_relationships as (
    select  
        *
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where not parent_is_excluded
    and not child_is_excluded
),

-- find all models without children
models_without_children as (
    select
        parent
    from all_dag_relationships
    where parent_resource_type = 'model'
    group by 1
    having max(distance) = 0
),

-- all parents with more direct children than the threshold for fanout (determined by variable models_fanout_threshold, default 3)
    -- Note: only counts "leaf children" - direct chilren that are models AND are child-less (are at the right-most-point in the DAG)
model_fanout as (
    select 
        all_dag_relationships.parent,
        all_dag_relationships.parent_model_type,
        all_dag_relationships.child
    from all_dag_relationships
    inner join models_without_children
        on all_dag_relationships.child = models_without_children.parent
    where all_dag_relationships.distance = 1 and all_dag_relationships.child_resource_type = 'model'
    group by 1, 2, 3
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by 1, 2, 3
),

model_fanout_agg as (
    select
        parent,
        parent_model_type,
        
    string_agg(
        child,
        ', '
        
        ) as leaf_children
    from model_fanout
    group by 1, 2
    having count(*) >= 3
)

select * from model_fanout_agg



    

    
    

    

    


  );
  
[0m17:18:49.474279 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m17:18:49.474457 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */
alter table "dbt_course"."bookings_dbt"."fct_multiple_sources_joined" rename to "fct_multiple_sources_joined__dbt_backup"
[0m17:18:49.474844 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.474983 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m17:18:49.476022 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m17:18:49.477287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m17:18:49.477428 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.003 seconds
[0m17:18:49.477559 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.003 seconds
[0m17:18:49.477702 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */
alter table "dbt_course"."bookings_dbt"."fct_multiple_sources_joined__dbt_tmp" rename to "fct_multiple_sources_joined"
[0m17:18:49.477843 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */
alter table "dbt_course"."bookings_dbt"."fct_rejoining_of_upstream_concepts" rename to "fct_rejoining_of_upstream_concepts__dbt_backup"
[0m17:18:49.478958 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m17:18:49.480162 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m17:18:49.480337 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */
alter table "dbt_course"."bookings_dbt"."fct_model_fanout" rename to "fct_model_fanout__dbt_backup"
[0m17:18:49.480467 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */
alter table "dbt_course"."bookings_dbt"."fct_root_models" rename to "fct_root_models__dbt_backup"
[0m17:18:49.480672 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.480795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.481544 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m17:18:49.481655 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.481760 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.482668 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m17:18:49.482790 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_multiple_sources_joined'
);
      
[0m17:18:49.483674 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m17:18:49.484596 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m17:18:49.484704 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */
alter table "dbt_course"."bookings_dbt"."fct_rejoining_of_upstream_concepts__dbt_tmp" rename to "fct_rejoining_of_upstream_concepts"
[0m17:18:49.484839 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */
alter table "dbt_course"."bookings_dbt"."fct_root_models__dbt_tmp" rename to "fct_root_models"
[0m17:18:49.484979 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */
alter table "dbt_course"."bookings_dbt"."fct_model_fanout__dbt_tmp" rename to "fct_model_fanout"
[0m17:18:49.485207 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:49.485858 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.485747 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.486023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.486661 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m17:18:49.486769 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:18:49.486903 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.487705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m17:18:49.487840 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_root_models'
);
      
[0m17:18:49.488429 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m17:18:49.488546 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.488670 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_rejoining_of_upstream_concepts'
);
      
[0m17:18:49.488829 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_model_fanout'
);
      
[0m17:18:49.488984 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.489149 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:49.489322 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.489487 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:49.489627 [debug] [Thread-3 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:18:49.490132 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.490281 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.490778 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.491370 [info ] [Thread-3 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.491536 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.491653 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.491815 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.491942 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.492052 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.492216 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.492390 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.492527 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.492654 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.492786 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.492913 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.493037 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.493161 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.493282 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.493404 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.493523 [info ] [Thread-3 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.493644 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.493758 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.493879 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.494007 [info ] [Thread-3 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.494150 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.494293 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.494424 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.494547 [info ] [Thread-3 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.494662 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.494782 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.494905 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.495022 [info ] [Thread-3 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.495146 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.495281 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.495413 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.495602 [info ] [Thread-3 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.495788 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.495926 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.496061 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.496179 [info ] [Thread-3 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.496305 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.496427 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.496544 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.496675 [info ] [Thread-3 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.496786 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.496907 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.497025 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.497149 [info ] [Thread-3 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.497283 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.497404 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.497524 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.497638 [info ] [Thread-3 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.497756 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.497868 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.497981 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.498098 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.498220 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.498333 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.498447 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.498579 [info ] [Thread-3 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.498705 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.498829 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.498955 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.499098 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.499233 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.499360 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.499487 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.499612 [info ] [Thread-3 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.499732 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.499854 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.499983 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.500099 [info ] [Thread-3 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.500221 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.500343 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.500471 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.500593 [info ] [Thread-3 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.500768 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.500904 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.501037 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.501161 [info ] [Thread-3 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.501279 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.501403 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.501523 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.501637 [info ] [Thread-3 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.501765 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.501893 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.502026 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.502149 [info ] [Thread-3 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.502270 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.502409 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.502532 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.502656 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.502786 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.502919 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.503035 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.503146 [info ] [Thread-3 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.503267 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.503421 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.503591 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.503750 [info ] [Thread-3 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.503881 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.504019 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.504142 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.504258 [info ] [Thread-3 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.504378 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.504542 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.504664 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.504784 [info ] [Thread-3 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.504907 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.505194 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: COMMIT
[0m17:18:49.505305 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.505429 [info ] [Thread-3 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.505548 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.505703 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m17:18:49.505812 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.505931 [info ] [Thread-3 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.506060 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.506183 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: COMMIT
[0m17:18:49.506297 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.506416 [info ] [Thread-3 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.506535 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.506677 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.506806 [info ] [Thread-3 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.506966 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.507174 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.507364 [info ] [Thread-3 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.507497 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:49.507730 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_root_models: COMMIT
[0m17:18:49.507946 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: COMMIT
[0m17:18:49.508165 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: COMMIT
[0m17:18:49.509159 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_multiple_sources_joined__dbt_backup"
[0m17:18:49.509281 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m17:18:49.509399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m17:18:49.509513 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m17:18:49.509694 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_multiple_sources_joined"
[0m17:18:49.509807 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_root_models: COMMIT
[0m17:18:49.509916 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: COMMIT
[0m17:18:49.510022 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: COMMIT
[0m17:18:49.510132 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_multiple_sources_joined"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_multiple_sources_joined__dbt_backup" cascade
[0m17:18:49.510657 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m17:18:49.511402 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_root_models__dbt_backup"
[0m17:18:49.511539 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m17:18:49.511708 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_root_models"
[0m17:18:49.511823 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:49.511939 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:18:49.512956 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_model_fanout__dbt_backup"
[0m17:18:49.513116 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_root_models: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_root_models"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_root_models__dbt_backup" cascade
[0m17:18:49.513957 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_rejoining_of_upstream_concepts__dbt_backup"
[0m17:18:49.514474 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_multiple_sources_joined: Close
[0m17:18:49.514672 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_model_fanout"
[0m17:18:49.514880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"
[0m17:18:49.515021 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_model_fanout"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_model_fanout__dbt_backup" cascade
[0m17:18:49.515227 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117df85f0>]}
[0m17:18:49.515345 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_rejoining_of_upstream_concepts__dbt_backup" cascade
[0m17:18:49.515600 [info ] [Thread-4 (]: 87 of 111 OK created sql table model bookings_dbt.fct_multiple_sources_joined .. [[32mSELECT 0[0m in 0.07s]
[0m17:18:49.515791 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_multiple_sources_joined
[0m17:18:49.515920 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_source_fanout
[0m17:18:49.516092 [info ] [Thread-4 (]: 90 of 111 START sql table model bookings_dbt.fct_source_fanout ................. [RUN]
[0m17:18:49.516273 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_multiple_sources_joined, now model.dbt_project_evaluator.fct_source_fanout)
[0m17:18:49.516393 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_source_fanout
[0m17:18:49.520738 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_source_fanout"
[0m17:18:49.520921 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:18:49.521091 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:18:49.521256 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:18:49.521844 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_root_models: Close
[0m17:18:49.522268 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts: Close
[0m17:18:49.522765 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_model_fanout: Close
[0m17:18:49.522891 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_source_fanout
[0m17:18:49.523200 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1175c3a10>]}
[0m17:18:49.523338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1175c3b90>]}
[0m17:18:49.523518 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1175c39b0>]}
[0m17:18:49.524975 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_source_fanout"
[0m17:18:49.525189 [info ] [Thread-2 (]: 89 of 111 OK created sql table model bookings_dbt.fct_root_models .............. [[32mSELECT 0[0m in 0.06s]
[0m17:18:49.525408 [info ] [Thread-1 (]: 88 of 111 OK created sql table model bookings_dbt.fct_rejoining_of_upstream_concepts  [[32mSELECT 0[0m in 0.07s]
[0m17:18:49.525607 [info ] [Thread-3 (]: 86 of 111 OK created sql table model bookings_dbt.fct_model_fanout ............. [[32mSELECT 2[0m in 0.08s]
[0m17:18:49.525818 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_root_models
[0m17:18:49.525986 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts
[0m17:18:49.526141 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_model_fanout
[0m17:18:49.526284 [debug] [Thread-2 (]: Began running node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m17:18:49.526406 [debug] [Thread-1 (]: Began running node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m17:18:49.526584 [debug] [Thread-3 (]: Began running node model.dbt_project_evaluator.fct_too_many_joins
[0m17:18:49.526750 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m17:18:49.526920 [info ] [Thread-2 (]: 91 of 111 START sql table model bookings_dbt.fct_staging_dependent_on_marts_or_intermediate  [RUN]
[0m17:18:49.527101 [info ] [Thread-1 (]: 92 of 111 START sql table model bookings_dbt.fct_staging_dependent_on_staging .. [RUN]
[0m17:18:49.527409 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_fanout: BEGIN
[0m17:18:49.527281 [info ] [Thread-3 (]: 93 of 111 START sql table model bookings_dbt.fct_too_many_joins ................ [RUN]
[0m17:18:49.527578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_root_models, now model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate)
[0m17:18:49.527701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_rejoining_of_upstream_concepts, now model.dbt_project_evaluator.fct_staging_dependent_on_staging)
[0m17:18:49.527815 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.527931 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_model_fanout, now model.dbt_project_evaluator.fct_too_many_joins)
[0m17:18:49.528054 [debug] [Thread-2 (]: Began compiling node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m17:18:49.528163 [debug] [Thread-1 (]: Began compiling node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m17:18:49.528346 [debug] [Thread-3 (]: Began compiling node model.dbt_project_evaluator.fct_too_many_joins
[0m17:18:49.567249 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m17:18:49.568321 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m17:18:49.568473 [debug] [Thread-4 (]: SQL status: BEGIN in 0.041 seconds
[0m17:18:49.569764 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_too_many_joins"
[0m17:18:49.569987 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m17:18:49.570204 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_source_fanout__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a source is used in multiple direct downstream models
with direct_source_relationships as (
    select  
        *
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'source'
    and child_resource_type = 'model'
    and not parent_is_excluded
    and not child_is_excluded
    -- we order the CTE so that listagg returns values correctly sorted for some warehouses
    order by child
),

source_fanout as (
    select
        parent,
        
    string_agg(
        child,
        ', '
        
        ) as model_children
    from direct_source_relationships
    group by 1
    having count(*) > 1
)

select * from source_fanout



    

    
    

    

    


  );
  
[0m17:18:49.570374 [debug] [Thread-2 (]: Began executing node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m17:18:49.570520 [debug] [Thread-3 (]: Began executing node model.dbt_project_evaluator.fct_too_many_joins
[0m17:18:49.571796 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m17:18:49.573177 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_too_many_joins"
[0m17:18:49.573285 [debug] [Thread-1 (]: Began executing node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m17:18:49.574623 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m17:18:49.574824 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m17:18:49.574942 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: BEGIN
[0m17:18:49.575054 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.575177 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m17:18:49.575339 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: BEGIN
[0m17:18:49.575462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m17:18:49.575571 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.575682 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: BEGIN
[0m17:18:49.575833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.579999 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.009 seconds
[0m17:18:49.581356 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m17:18:49.581477 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */
alter table "dbt_course"."bookings_dbt"."fct_source_fanout" rename to "fct_source_fanout__dbt_backup"
[0m17:18:49.581917 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.582941 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m17:18:49.583077 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */
alter table "dbt_course"."bookings_dbt"."fct_source_fanout__dbt_tmp" rename to "fct_source_fanout"
[0m17:18:49.583445 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.584230 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m17:18:49.584359 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m17:18:49.584480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:18:49.584602 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_source_fanout'
);
      
[0m17:18:49.584727 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m17:18:49.584841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m17:18:49.584992 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_too_many_joins__dbt_tmp"
  
  
    as
  
  (
    with all_dag_relationships as (
    select
        *
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where not child_is_excluded
    and child_resource_type = 'model'
),

final as (
    select
        child as resource_name,
        child_file_path as file_path,
        cast(count(distinct parent) as integer) as join_count
    from all_dag_relationships
    where distance = 1
    group by 1, 2
    having count(distinct parent) >= 7
)

select * from final



    

    
    

    

    


  );
  
[0m17:18:49.585215 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_staging_dependent_on_staging__dbt_tmp"
  
  
    as
  
  (
    -- check for cases where models in the staging layer are dependent on each other
with direct_model_relationships as (
    select  
        *
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where parent_resource_type in ('model', 'snapshot')
    and child_resource_type in ('model', 'snapshot')
    and not parent_is_excluded
    and not child_is_excluded
    and distance = 1
),

bending_connections as (
    select
        parent,
        parent_model_type,
        child,
        child_model_type
    from direct_model_relationships
    where parent_model_type = 'staging'
    and child_model_type = 'staging'
)

select * from bending_connections



    

    
    

    

    


  );
  
[0m17:18:49.585386 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m17:18:49.585510 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:49.585645 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m17:18:49.586193 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.586363 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_staging_dependent_on_marts_or_intermediate__dbt_tmp"
  
  
    as
  
  (
    -- cases where a staging model depends on a marts/intermediate model
-- data should flow from raw -> staging -> intermediate -> marts
with direct_model_relationships as (
    select  
        *
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where distance = 1
    and parent_resource_type = 'model'
    and child_resource_type = 'model'
    and not parent_is_excluded
    and not child_is_excluded
),
final as (
    select
        parent,
        parent_model_type,
        child,
        child_model_type
    from direct_model_relationships
    where child_model_type = 'staging'
    and parent_model_type in ('marts', 'intermediate')
)
select * from final



    

    
    

    

    


  );
  
[0m17:18:49.586549 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.586729 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.586854 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.586967 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.587083 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.587193 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.587305 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.587417 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.587513 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.587620 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.587731 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.587840 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.587954 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.588053 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.588172 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.588281 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.588410 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.003 seconds
[0m17:18:49.588835 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.003 seconds
[0m17:18:49.588974 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.589144 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.002 seconds
[0m17:18:49.590285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m17:18:49.591263 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m17:18:49.591488 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.592819 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m17:18:49.592936 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */
alter table "dbt_course"."bookings_dbt"."fct_staging_dependent_on_staging" rename to "fct_staging_dependent_on_staging__dbt_backup"
[0m17:18:49.593045 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */
alter table "dbt_course"."bookings_dbt"."fct_too_many_joins" rename to "fct_too_many_joins__dbt_backup"
[0m17:18:49.593151 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.593265 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */
alter table "dbt_course"."bookings_dbt"."fct_staging_dependent_on_marts_or_intermediate" rename to "fct_staging_dependent_on_marts_or_intermediate__dbt_backup"
[0m17:18:49.593472 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.593705 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.593857 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.594016 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.594167 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.594270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.595222 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m17:18:49.595355 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.596564 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m17:18:49.597449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m17:18:49.597566 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */
alter table "dbt_course"."bookings_dbt"."fct_too_many_joins__dbt_tmp" rename to "fct_too_many_joins"
[0m17:18:49.597685 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.597813 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */
alter table "dbt_course"."bookings_dbt"."fct_staging_dependent_on_marts_or_intermediate__dbt_tmp" rename to "fct_staging_dependent_on_marts_or_intermediate"
[0m17:18:49.598059 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */
alter table "dbt_course"."bookings_dbt"."fct_staging_dependent_on_staging__dbt_tmp" rename to "fct_staging_dependent_on_staging"
[0m17:18:49.598212 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.598402 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.598528 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.598668 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.598774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:49.598871 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.598972 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.599745 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m17:18:49.600338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m17:18:49.600895 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m17:18:49.601017 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.601159 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_staging_dependent_on_marts_or_intermediate'
);
      
[0m17:18:49.601278 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_staging_dependent_on_staging'
);
      
[0m17:18:49.601401 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_too_many_joins'
);
      
[0m17:18:49.601509 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.601740 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.602043 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_fanout: COMMIT
[0m17:18:49.602190 [debug] [Thread-3 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:49.602293 [debug] [Thread-2 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:49.602390 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m17:18:49.602484 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:18:49.602955 [info ] [Thread-3 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.603632 [info ] [Thread-2 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.603792 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_fanout: COMMIT
[0m17:18:49.604238 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.604437 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.604593 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.604782 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.604938 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.605106 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.605245 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.605672 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.605804 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.605932 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.606060 [info ] [Thread-3 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.606186 [info ] [Thread-2 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.606307 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.606445 [info ] [Thread-3 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.606586 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:49.606694 [info ] [Thread-2 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.606813 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.606942 [info ] [Thread-3 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.607709 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_source_fanout__dbt_backup"
[0m17:18:49.607820 [info ] [Thread-2 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.607960 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.608095 [info ] [Thread-3 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.608287 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_source_fanout"
[0m17:18:49.608397 [info ] [Thread-2 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.608522 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.608646 [info ] [Thread-3 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.608874 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_fanout: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_source_fanout"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_source_fanout__dbt_backup" cascade
[0m17:18:49.608992 [info ] [Thread-2 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.609109 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.609244 [info ] [Thread-3 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.609410 [info ] [Thread-2 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.609551 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.609687 [info ] [Thread-3 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.609834 [info ] [Thread-2 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.609966 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.610100 [info ] [Thread-3 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.610228 [info ] [Thread-2 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.610343 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.610465 [info ] [Thread-3 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.610590 [info ] [Thread-2 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.610719 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.610850 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.610983 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.611120 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.611248 [info ] [Thread-3 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.611375 [info ] [Thread-2 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.611510 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.611659 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:18:49.611770 [info ] [Thread-3 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.611928 [info ] [Thread-2 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.612594 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_source_fanout: Close
[0m17:18:49.612099 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.612736 [info ] [Thread-3 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.612871 [info ] [Thread-2 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.613020 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.613245 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fd6c30>]}
[0m17:18:49.613370 [info ] [Thread-3 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.613495 [info ] [Thread-2 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.613614 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.613879 [info ] [Thread-3 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.614051 [info ] [Thread-2 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.614183 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.614365 [info ] [Thread-4 (]: 90 of 111 OK created sql table model bookings_dbt.fct_source_fanout ............ [[32mSELECT 4[0m in 0.10s]
[0m17:18:49.614504 [info ] [Thread-3 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.614681 [info ] [Thread-2 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.614810 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.614991 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_source_fanout
[0m17:18:49.615103 [info ] [Thread-3 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.615233 [info ] [Thread-2 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.615367 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.615510 [debug] [Thread-4 (]: Began running node model.dbt_project_evaluator.fct_unused_sources
[0m17:18:49.615661 [info ] [Thread-3 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.615799 [info ] [Thread-2 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.615921 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.616104 [info ] [Thread-4 (]: 94 of 111 START sql table model bookings_dbt.fct_unused_sources ................ [RUN]
[0m17:18:49.616214 [info ] [Thread-3 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.616372 [info ] [Thread-2 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.616497 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.616641 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_source_fanout, now model.dbt_project_evaluator.fct_unused_sources)
[0m17:18:49.616759 [info ] [Thread-3 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.616881 [info ] [Thread-2 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.617007 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.617131 [debug] [Thread-4 (]: Began compiling node model.dbt_project_evaluator.fct_unused_sources
[0m17:18:49.617243 [info ] [Thread-3 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.617368 [info ] [Thread-2 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.617493 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.618667 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project_evaluator.fct_unused_sources"
[0m17:18:49.618789 [info ] [Thread-3 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.618968 [info ] [Thread-2 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.619162 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.619342 [info ] [Thread-3 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.619488 [info ] [Thread-2 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.619639 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.619790 [info ] [Thread-3 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.619920 [debug] [Thread-4 (]: Began executing node model.dbt_project_evaluator.fct_unused_sources
[0m17:18:49.620048 [info ] [Thread-2 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.620165 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.620281 [info ] [Thread-3 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.622056 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project_evaluator.fct_unused_sources"
[0m17:18:49.622203 [info ] [Thread-2 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.622363 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.622512 [info ] [Thread-3 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.622688 [info ] [Thread-2 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.622830 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.622981 [info ] [Thread-3 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.623112 [info ] [Thread-2 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.623256 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m17:18:49.623378 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.623561 [info ] [Thread-3 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.623931 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: BEGIN
[0m17:18:49.623795 [info ] [Thread-2 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.624130 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.624435 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: COMMIT
[0m17:18:49.624565 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.624817 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: COMMIT
[0m17:18:49.625073 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: COMMIT
[0m17:18:49.625191 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m17:18:49.625359 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m17:18:49.625476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m17:18:49.625591 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: COMMIT
[0m17:18:49.625710 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: COMMIT
[0m17:18:49.625820 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: COMMIT
[0m17:18:49.627551 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:49.628527 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_staging_dependent_on_staging__dbt_backup"
[0m17:18:49.628642 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m17:18:49.628834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_staging"
[0m17:18:49.628957 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m17:18:49.629817 [debug] [Thread-3 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_too_many_joins__dbt_backup"
[0m17:18:49.629970 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_staging"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_staging_dependent_on_staging__dbt_backup" cascade
[0m17:18:49.630782 [debug] [Thread-2 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_staging_dependent_on_marts_or_intermediate__dbt_backup"
[0m17:18:49.631103 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project_evaluator.fct_too_many_joins"
[0m17:18:49.631305 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"
[0m17:18:49.631423 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_too_many_joins"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_too_many_joins__dbt_backup" cascade
[0m17:18:49.631544 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_staging_dependent_on_marts_or_intermediate__dbt_backup" cascade
[0m17:18:49.633467 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:18:49.633994 [debug] [Thread-1 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_staging: Close
[0m17:18:49.634116 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:18:49.634227 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m17:18:49.634338 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:18:49.634808 [debug] [Thread-2 (]: On model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate: Close
[0m17:18:49.635009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e137d0>]}
[0m17:18:49.635123 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m17:18:49.635589 [debug] [Thread-3 (]: On model.dbt_project_evaluator.fct_too_many_joins: Close
[0m17:18:49.635850 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f70bf0>]}
[0m17:18:49.636187 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */

  
    

  create  table "dbt_course"."bookings_dbt"."fct_unused_sources__dbt_tmp"
  
  
    as
  
  (
    -- this model finds cases where a source has no children

with source_relationships as (
    select  
        *
    from "dbt_course"."bookings_dbt"."int_all_dag_relationships"
    where parent_resource_type = 'source'
    and not parent_is_excluded
    and not child_is_excluded
),

final as (
    select
        parent
    from source_relationships
    group by 1
    having max(distance) = 0
)

select * from final



    

    
    

    

    


  );
  
[0m17:18:49.636063 [info ] [Thread-1 (]: 92 of 111 OK created sql table model bookings_dbt.fct_staging_dependent_on_staging  [[32mSELECT 0[0m in 0.11s]
[0m17:18:49.636462 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116e137d0>]}
[0m17:18:49.636641 [info ] [Thread-2 (]: 91 of 111 OK created sql table model bookings_dbt.fct_staging_dependent_on_marts_or_intermediate  [[32mSELECT 0[0m in 0.11s]
[0m17:18:49.636882 [debug] [Thread-1 (]: Finished running node model.dbt_project_evaluator.fct_staging_dependent_on_staging
[0m17:18:49.637277 [debug] [Thread-2 (]: Finished running node model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate
[0m17:18:49.637075 [info ] [Thread-3 (]: 93 of 111 OK created sql table model bookings_dbt.fct_too_many_joins ........... [[32mSELECT 0[0m in 0.11s]
[0m17:18:49.637483 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m17:18:49.637661 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m17:18:49.637888 [debug] [Thread-3 (]: Finished running node model.dbt_project_evaluator.fct_too_many_joins
[0m17:18:49.638041 [info ] [Thread-1 (]: 95 of 111 START test valid_test_coverage ....................................... [RUN]
[0m17:18:49.638152 [info ] [Thread-2 (]: 96 of 111 START test is_empty_fct_missing_primary_key_tests_ ................... [RUN]
[0m17:18:49.638327 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m17:18:49.638487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_staging_dependent_on_staging, now test.dbt_project_evaluator.valid_test_coverage.df03f31e09)
[0m17:18:49.638632 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_staging_dependent_on_marts_or_intermediate, now test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0)
[0m17:18:49.638757 [info ] [Thread-3 (]: 97 of 111 START test is_empty_fct_chained_views_dependencies_ .................. [RUN]
[0m17:18:49.638876 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m17:18:49.638986 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m17:18:49.639105 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_too_many_joins, now test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33)
[0m17:18:49.640961 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m17:18:49.642261 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m17:18:49.642370 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.006 seconds
[0m17:18:49.642487 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m17:18:49.643976 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m17:18:49.645266 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m17:18:49.645416 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */
alter table "dbt_course"."bookings_dbt"."fct_unused_sources" rename to "fct_unused_sources__dbt_backup"
[0m17:18:49.645617 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m17:18:49.645732 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m17:18:49.648413 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m17:18:49.648654 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:18:49.649401 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m17:18:49.649565 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m17:18:49.650612 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m17:18:49.651343 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m17:18:49.651472 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */
alter table "dbt_course"."bookings_dbt"."fct_unused_sources__dbt_tmp" rename to "fct_unused_sources"
[0m17:18:49.651669 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m17:18:49.651786 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: BEGIN
[0m17:18:49.651907 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m17:18:49.652036 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.652149 [debug] [Thread-1 (]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: BEGIN
[0m17:18:49.652328 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m17:18:49.652444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.652552 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:49.652667 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: BEGIN
[0m17:18:49.653477 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m17:18:49.653594 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.653735 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'fct_unused_sources'
);
      
[0m17:18:49.656428 [debug] [Thread-4 (]: SQL status: INSERT 0 1 in 0.003 seconds
[0m17:18:49.657048 [info ] [Thread-4 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:18:49.657226 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:18:49.657342 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:18:49.657457 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:18:49.657569 [info ] [Thread-4 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:18:49.657683 [info ] [Thread-4 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:18:49.657788 [info ] [Thread-4 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:18:49.657888 [info ] [Thread-4 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:18:49.657984 [info ] [Thread-4 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:18:49.658084 [info ] [Thread-4 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:18:49.658184 [info ] [Thread-4 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:18:49.658279 [info ] [Thread-4 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:18:49.658424 [info ] [Thread-4 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:18:49.658649 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:18:49.658828 [info ] [Thread-4 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:18:49.658986 [info ] [Thread-4 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:18:49.659162 [info ] [Thread-4 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:18:49.659322 [info ] [Thread-4 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:18:49.659486 [info ] [Thread-4 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:18:49.659652 [info ] [Thread-4 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:18:49.659778 [info ] [Thread-4 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:18:49.659892 [info ] [Thread-4 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:18:49.660000 [info ] [Thread-4 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:18:49.660110 [info ] [Thread-4 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:18:49.660223 [info ] [Thread-4 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:18:49.660396 [info ] [Thread-4 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:18:49.660555 [info ] [Thread-4 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:18:49.660788 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m17:18:49.660686 [info ] [Thread-4 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:18:49.661123 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"
[0m17:18:49.661468 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m17:18:49.661312 [info ] [Thread-4 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:18:49.661650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:18:49.661811 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_missing_primary_key_tests"


      
    ) dbt_internal_test
[0m17:18:49.661949 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"
[0m17:18:49.662187 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"
[0m17:18:49.662078 [info ] [Thread-4 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:18:49.662356 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_chained_views_dependencies"


      
    ) dbt_internal_test
[0m17:18:49.662522 [debug] [Thread-1 (]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.valid_test_coverage.df03f31e09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "dbt_course"."bookings_dbt"."fct_test_coverage"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not test_coverage_pct >= 100
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m17:18:49.662713 [info ] [Thread-4 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:18:49.662995 [info ] [Thread-4 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:18:49.663310 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: COMMIT
[0m17:18:49.663430 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m17:18:49.663531 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: COMMIT
[0m17:18:49.664092 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m17:18:49.665208 [debug] [Thread-4 (]: Applying DROP to: "dbt_course"."bookings_dbt"."fct_unused_sources__dbt_backup"
[0m17:18:49.665338 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:18:49.665538 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project_evaluator.fct_unused_sources"
[0m17:18:49.665654 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:18:49.666236 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: ROLLBACK
[0m17:18:49.666394 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:18:49.666528 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_project_evaluator.fct_unused_sources"} */
drop table if exists "dbt_course"."bookings_dbt"."fct_unused_sources__dbt_backup" cascade
[0m17:18:49.667018 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: ROLLBACK
[0m17:18:49.667658 [debug] [Thread-1 (]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: ROLLBACK
[0m17:18:49.667813 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0: Close
[0m17:18:49.668193 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33: Close
[0m17:18:49.668317 [debug] [Thread-1 (]: On test.dbt_project_evaluator.valid_test_coverage.df03f31e09: Close
[0m17:18:49.668091 [warn ] [Thread-2 (]: 96 of 111 WARN 23 is_empty_fct_missing_primary_key_tests_ ...................... [[33mWARN 23[0m in 0.03s]
[0m17:18:49.668542 [info ] [Thread-3 (]: 97 of 111 PASS is_empty_fct_chained_views_dependencies_ ........................ [[32mPASS[0m in 0.03s]
[0m17:18:49.668706 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:18:49.669051 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0
[0m17:18:49.668877 [warn ] [Thread-1 (]: 95 of 111 WARN 1 valid_test_coverage ........................................... [[33mWARN 1[0m in 0.03s]
[0m17:18:49.669265 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33
[0m17:18:49.669836 [debug] [Thread-4 (]: On model.dbt_project_evaluator.fct_unused_sources: Close
[0m17:18:49.670003 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m17:18:49.670207 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.valid_test_coverage.df03f31e09
[0m17:18:49.670403 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m17:18:49.670719 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e149f3fc-2090-4ea3-a2cb-af8291c405f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fa7170>]}
[0m17:18:49.670996 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m17:18:49.670862 [info ] [Thread-2 (]: 98 of 111 START test is_empty_fct_direct_join_to_source_ ....................... [RUN]
[0m17:18:49.671162 [info ] [Thread-3 (]: 99 of 111 START test is_empty_fct_exposure_parents_materializations_ ........... [RUN]
[0m17:18:49.671401 [info ] [Thread-4 (]: 94 of 111 OK created sql table model bookings_dbt.fct_unused_sources ........... [[32mSELECT 0[0m in 0.05s]
[0m17:18:49.671540 [info ] [Thread-1 (]: 100 of 111 START test is_empty_fct_exposures_dependent_on_private_models_ ...... [RUN]
[0m17:18:49.671699 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_missing_primary_key_tests_.4d10d48da0, now test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028)
[0m17:18:49.671829 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_chained_views_dependencies_.d5cb95fb33, now test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422)
[0m17:18:49.672004 [debug] [Thread-4 (]: Finished running node model.dbt_project_evaluator.fct_unused_sources
[0m17:18:49.672138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.valid_test_coverage.df03f31e09, now test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e)
[0m17:18:49.672269 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m17:18:49.672381 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m17:18:49.672505 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m17:18:49.672637 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m17:18:49.674243 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m17:18:49.675909 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m17:18:49.677273 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m17:18:49.676053 [info ] [Thread-4 (]: 101 of 111 START test is_empty_fct_model_directories_ .......................... [RUN]
[0m17:18:49.677537 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project_evaluator.fct_unused_sources, now test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db)
[0m17:18:49.677665 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m17:18:49.678833 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m17:18:49.679082 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m17:18:49.679206 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m17:18:49.679318 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m17:18:49.680442 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m17:18:49.680577 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m17:18:49.681212 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m17:18:49.681928 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m17:18:49.682820 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m17:18:49.683109 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m17:18:49.683255 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m17:18:49.683383 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: BEGIN
[0m17:18:49.683526 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: BEGIN
[0m17:18:49.683672 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m17:18:49.683803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.683925 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m17:18:49.684042 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.684157 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: BEGIN
[0m17:18:49.684330 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: BEGIN
[0m17:18:49.684478 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.684585 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.699038 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m17:18:49.699227 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m17:18:49.699338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m17:18:49.699436 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m17:18:49.699536 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"
[0m17:18:49.699640 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"
[0m17:18:49.699738 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"
[0m17:18:49.699835 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"
[0m17:18:49.699937 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_direct_join_to_source"


      
    ) dbt_internal_test
[0m17:18:49.700054 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_exposure_parents_materializations"


      
    ) dbt_internal_test
[0m17:18:49.700174 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_exposures_dependent_on_private_models"


      
    ) dbt_internal_test
[0m17:18:49.700283 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_model_directories"


      
    ) dbt_internal_test
[0m17:18:49.700887 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m17:18:49.701459 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: ROLLBACK
[0m17:18:49.702268 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028: Close
[0m17:18:49.702471 [info ] [Thread-2 (]: 98 of 111 PASS is_empty_fct_direct_join_to_source_ ............................. [[32mPASS[0m in 0.03s]
[0m17:18:49.702664 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028
[0m17:18:49.702784 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m17:18:49.702888 [info ] [Thread-2 (]: 102 of 111 START test is_empty_fct_marts_or_intermediate_dependent_on_source_ .. [RUN]
[0m17:18:49.703055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_direct_join_to_source_.2ec67ec028, now test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f)
[0m17:18:49.703191 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:18:49.703307 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m17:18:49.703406 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m17:18:49.703904 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: ROLLBACK
[0m17:18:49.704025 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:18:49.705668 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m17:18:49.706093 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: ROLLBACK
[0m17:18:49.706609 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: ROLLBACK
[0m17:18:49.706724 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422: Close
[0m17:18:49.707136 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e: Close
[0m17:18:49.707285 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db: Close
[0m17:18:49.707003 [info ] [Thread-3 (]: 99 of 111 PASS is_empty_fct_exposure_parents_materializations_ ................. [[32mPASS[0m in 0.04s]
[0m17:18:49.707550 [warn ] [Thread-4 (]: 101 of 111 WARN 21 is_empty_fct_model_directories_ ............................. [[33mWARN 21[0m in 0.03s]
[0m17:18:49.707729 [info ] [Thread-1 (]: 100 of 111 PASS is_empty_fct_exposures_dependent_on_private_models_ ............ [[32mPASS[0m in 0.04s]
[0m17:18:49.707985 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422
[0m17:18:49.708119 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m17:18:49.708298 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db
[0m17:18:49.708465 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e
[0m17:18:49.708607 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m17:18:49.709391 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m17:18:49.709582 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m17:18:49.709753 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m17:18:49.709907 [info ] [Thread-3 (]: 103 of 111 START test is_empty_fct_multiple_sources_joined_ .................... [RUN]
[0m17:18:49.710084 [info ] [Thread-4 (]: 104 of 111 START test is_empty_fct_rejoining_of_upstream_concepts_ ............. [RUN]
[0m17:18:49.710229 [info ] [Thread-1 (]: 105 of 111 START test is_empty_fct_root_models_ ................................ [RUN]
[0m17:18:49.710397 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_exposure_parents_materializations_.5a21592422, now test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817)
[0m17:18:49.710547 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_directories_.50098500db, now test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d)
[0m17:18:49.710710 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m17:18:49.710825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_exposures_dependent_on_private_models_.f12ef3521e, now test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1)
[0m17:18:49.710957 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m17:18:49.711078 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m17:18:49.711205 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: BEGIN
[0m17:18:49.711315 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m17:18:49.712954 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m17:18:49.714180 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m17:18:49.714334 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.715899 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m17:18:49.716241 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m17:18:49.716359 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m17:18:49.716478 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m17:18:49.717190 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m17:18:49.717928 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m17:18:49.718756 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m17:18:49.719064 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m17:18:49.719201 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m17:18:49.719318 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: BEGIN
[0m17:18:49.719435 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: BEGIN
[0m17:18:49.719565 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m17:18:49.719678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.719782 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.719890 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: BEGIN
[0m17:18:49.720072 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.721969 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m17:18:49.722170 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"
[0m17:18:49.722309 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_marts_or_intermediate_dependent_on_source"


      
    ) dbt_internal_test
[0m17:18:49.722893 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m17:18:49.723500 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: ROLLBACK
[0m17:18:49.723815 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f: Close
[0m17:18:49.724083 [info ] [Thread-2 (]: 102 of 111 PASS is_empty_fct_marts_or_intermediate_dependent_on_source_ ........ [[32mPASS[0m in 0.02s]
[0m17:18:49.724278 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f
[0m17:18:49.724409 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m17:18:49.724525 [info ] [Thread-2 (]: 106 of 111 START test is_empty_fct_model_fanout_ ............................... [RUN]
[0m17:18:49.724711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_marts_or_intermediate_dependent_on_source_.c0abd5f00f, now test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95)
[0m17:18:49.724837 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m17:18:49.726371 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m17:18:49.726768 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m17:18:49.727774 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m17:18:49.727916 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m17:18:49.728066 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m17:18:49.728194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:18:49.728319 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"
[0m17:18:49.728452 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"
[0m17:18:49.728584 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"
[0m17:18:49.728740 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m17:18:49.728865 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_rejoining_of_upstream_concepts"


      
    ) dbt_internal_test
[0m17:18:49.728995 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_multiple_sources_joined"


      
    ) dbt_internal_test
[0m17:18:49.729119 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_root_models"


      
    ) dbt_internal_test
[0m17:18:49.729241 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: BEGIN
[0m17:18:49.729393 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.729877 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m17:18:49.730030 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.730609 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: ROLLBACK
[0m17:18:49.730749 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.731264 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: ROLLBACK
[0m17:18:49.731742 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: ROLLBACK
[0m17:18:49.731864 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817: Close
[0m17:18:49.732249 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1: Close
[0m17:18:49.732375 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d: Close
[0m17:18:49.732131 [info ] [Thread-3 (]: 103 of 111 PASS is_empty_fct_multiple_sources_joined_ .......................... [[32mPASS[0m in 0.02s]
[0m17:18:49.732991 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817
[0m17:18:49.732628 [info ] [Thread-1 (]: 105 of 111 PASS is_empty_fct_root_models_ ...................................... [[32mPASS[0m in 0.02s]
[0m17:18:49.733160 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m17:18:49.732826 [info ] [Thread-4 (]: 104 of 111 PASS is_empty_fct_rejoining_of_upstream_concepts_ ................... [[32mPASS[0m in 0.02s]
[0m17:18:49.733379 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1
[0m17:18:49.733503 [info ] [Thread-3 (]: 107 of 111 START test is_empty_fct_source_fanout_ .............................. [RUN]
[0m17:18:49.733700 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d
[0m17:18:49.733832 [debug] [Thread-1 (]: Began running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m17:18:49.733977 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_multiple_sources_joined_.494f431817, now test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722)
[0m17:18:49.734123 [debug] [Thread-4 (]: Began running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m17:18:49.734257 [info ] [Thread-1 (]: 108 of 111 START test is_empty_fct_staging_dependent_on_staging_ ............... [RUN]
[0m17:18:49.734389 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m17:18:49.734512 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m17:18:49.734635 [info ] [Thread-4 (]: 109 of 111 START test is_empty_fct_staging_dependent_on_marts_or_intermediate_ . [RUN]
[0m17:18:49.734777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_root_models_.ccb5a490f1, now test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca)
[0m17:18:49.736269 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m17:18:49.736399 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"
[0m17:18:49.736527 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_rejoining_of_upstream_concepts_.c6b3625c7d, now test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f)
[0m17:18:49.736655 [debug] [Thread-1 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m17:18:49.736807 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_model_fanout"


      
    ) dbt_internal_test
[0m17:18:49.736937 [debug] [Thread-4 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m17:18:49.738565 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m17:18:49.739997 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m17:18:49.740141 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m17:18:49.740295 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:18:49.743326 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m17:18:49.743846 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: ROLLBACK
[0m17:18:49.744038 [debug] [Thread-4 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m17:18:49.744158 [debug] [Thread-1 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m17:18:49.744893 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m17:18:49.745751 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m17:18:49.745862 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95: Close
[0m17:18:49.746004 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m17:18:49.746238 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: BEGIN
[0m17:18:49.746439 [warn ] [Thread-2 (]: 106 of 111 WARN 2 is_empty_fct_model_fanout_ ................................... [[33mWARN 2[0m in 0.02s]
[0m17:18:49.746594 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.746802 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95
[0m17:18:49.746947 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m17:18:49.747129 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m17:18:49.747266 [debug] [Thread-2 (]: Began running node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m17:18:49.747406 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: BEGIN
[0m17:18:49.747524 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: BEGIN
[0m17:18:49.747642 [info ] [Thread-2 (]: 110 of 111 START test is_empty_fct_too_many_joins_ ............................. [RUN]
[0m17:18:49.747768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:49.747880 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:18:49.748010 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_model_fanout_.a3ef403a95, now test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535)
[0m17:18:49.748206 [debug] [Thread-2 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m17:18:49.749719 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m17:18:49.749977 [debug] [Thread-2 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m17:18:49.750879 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m17:18:49.751096 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m17:18:49.751207 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: BEGIN
[0m17:18:49.751309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:18:49.754063 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m17:18:49.754215 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"
[0m17:18:49.754368 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_source_fanout"


      
    ) dbt_internal_test
[0m17:18:49.754680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:18:49.754801 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m17:18:49.754932 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"
[0m17:18:49.755057 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.755176 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"
[0m17:18:49.755323 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_staging_dependent_on_staging"


      
    ) dbt_internal_test
[0m17:18:49.755940 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: ROLLBACK
[0m17:18:49.756074 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m17:18:49.756203 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_staging_dependent_on_marts_or_intermediate"


      
    ) dbt_internal_test
[0m17:18:49.756377 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"
[0m17:18:49.756555 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_too_many_joins"


      
    ) dbt_internal_test
[0m17:18:49.756711 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722: Close
[0m17:18:49.756849 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.756967 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m17:18:49.757708 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: ROLLBACK
[0m17:18:49.757826 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:18:49.757209 [warn ] [Thread-3 (]: 107 of 111 WARN 4 is_empty_fct_source_fanout_ .................................. [[33mWARN 4[0m in 0.02s]
[0m17:18:49.758330 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: ROLLBACK
[0m17:18:49.758796 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: ROLLBACK
[0m17:18:49.758924 [debug] [Thread-1 (]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca: Close
[0m17:18:49.759113 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722
[0m17:18:49.759305 [debug] [Thread-3 (]: Began running node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m17:18:49.759711 [debug] [Thread-2 (]: On test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535: Close
[0m17:18:49.759826 [debug] [Thread-4 (]: On test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f: Close
[0m17:18:49.759429 [info ] [Thread-3 (]: 111 of 111 START test is_empty_fct_unused_sources_ ............................. [RUN]
[0m17:18:49.759590 [info ] [Thread-1 (]: 108 of 111 PASS is_empty_fct_staging_dependent_on_staging_ ..................... [[32mPASS[0m in 0.02s]
[0m17:18:49.760369 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project_evaluator.is_empty_fct_source_fanout_.45762bb722, now test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8)
[0m17:18:49.760052 [info ] [Thread-2 (]: 110 of 111 PASS is_empty_fct_too_many_joins_ ................................... [[32mPASS[0m in 0.01s]
[0m17:18:49.760595 [debug] [Thread-1 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca
[0m17:18:49.760254 [info ] [Thread-4 (]: 109 of 111 PASS is_empty_fct_staging_dependent_on_marts_or_intermediate_ ....... [[32mPASS[0m in 0.02s]
[0m17:18:49.760742 [debug] [Thread-3 (]: Began compiling node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m17:18:49.760910 [debug] [Thread-2 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535
[0m17:18:49.761107 [debug] [Thread-4 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f
[0m17:18:49.762627 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m17:18:49.763020 [debug] [Thread-3 (]: Began executing node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m17:18:49.763771 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m17:18:49.763995 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m17:18:49.764095 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: BEGIN
[0m17:18:49.764188 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:18:49.768499 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m17:18:49.768649 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"
[0m17:18:49.768769 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8"} */
select
      n_records as failures,
      n_records != 0 as should_warn,
      n_records != 0 as should_error
    from (
      

    

    select count(*) as n_records
    from "dbt_course"."bookings_dbt"."fct_unused_sources"


      
    ) dbt_internal_test
[0m17:18:49.769334 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m17:18:49.769883 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: ROLLBACK
[0m17:18:49.770170 [debug] [Thread-3 (]: On test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8: Close
[0m17:18:49.770382 [info ] [Thread-3 (]: 111 of 111 PASS is_empty_fct_unused_sources_ ................................... [[32mPASS[0m in 0.01s]
[0m17:18:49.770608 [debug] [Thread-3 (]: Finished running node test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8
[0m17:18:49.771265 [info ] [MainThread]: 
[0m17:18:49.771418 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.771508 [debug] [MainThread]: On master: BEGIN
[0m17:18:49.771594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:49.775566 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m17:18:49.775677 [debug] [MainThread]: On master: COMMIT
[0m17:18:49.775767 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.775850 [debug] [MainThread]: On master: COMMIT
[0m17:18:49.776150 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:18:49.780738 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m17:18:49.780959 [info ] [MainThread]: 
-- dbt_project_evaluator.marts.documentation.valid_documentation_coverage --
[0m17:18:49.781123 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.781225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */

    
        select * from "dbt_course"."bookings_dbt"."fct_documentation_coverage"
        
  
[0m17:18:49.785622 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m17:18:49.789545 [info ] [MainThread]: 
[0m17:18:49.789727 [info ] [MainThread]: 
-- dbt_project_evaluator.marts.structure.is_empty_fct_model_naming_conventions_ --
[0m17:18:49.789929 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.790045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */

    
        select * from "dbt_course"."bookings_dbt"."fct_model_naming_conventions"
        
  
[0m17:18:49.791235 [debug] [MainThread]: SQL status: SELECT 9 in 0.001 seconds
[0m17:18:49.791668 [info ] [MainThread]: 
[0m17:18:49.791791 [info ] [MainThread]: 
-- dbt_project_evaluator.marts.structure.is_empty_fct_source_directories_ --
[0m17:18:49.791947 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.792058 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */

    
        select * from "dbt_course"."bookings_dbt"."fct_source_directories"
        
  
[0m17:18:49.792572 [debug] [MainThread]: SQL status: SELECT 8 in 0.000 seconds
[0m17:18:49.792964 [info ] [MainThread]: 
[0m17:18:49.793081 [info ] [MainThread]: 
-- dbt_project_evaluator.marts.tests.is_empty_fct_sources_without_freshness_ --
[0m17:18:49.793231 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.793340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */

    
        select * from "dbt_course"."bookings_dbt"."fct_sources_without_freshness"
        
  
[0m17:18:49.793784 [debug] [MainThread]: SQL status: SELECT 5 in 0.000 seconds
[0m17:18:49.794139 [info ] [MainThread]: 
[0m17:18:49.794256 [info ] [MainThread]: 
-- dbt_project_evaluator.marts.documentation.is_empty_fct_undocumented_models_ --
[0m17:18:49.794410 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.794525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */

    
        select * from "dbt_course"."bookings_dbt"."fct_undocumented_models"
        
  
[0m17:18:49.796308 [debug] [MainThread]: SQL status: SELECT 22 in 0.002 seconds
[0m17:18:49.796794 [info ] [MainThread]: 
[0m17:18:49.796932 [info ] [MainThread]: 
-- dbt_project_evaluator.marts.structure.is_empty_fct_test_directories_ --
[0m17:18:49.797106 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.797219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */

    
        select * from "dbt_course"."bookings_dbt"."fct_test_directories"
        
  
[0m17:18:49.801442 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m17:18:49.801778 [info ] [MainThread]: 
[0m17:18:49.801977 [info ] [MainThread]: 
-- dbt_project_evaluator.marts.tests.is_empty_fct_missing_primary_key_tests_ --
[0m17:18:49.802156 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.802255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */

    
        select * from "dbt_course"."bookings_dbt"."fct_missing_primary_key_tests"
        
  
[0m17:18:49.804539 [debug] [MainThread]: SQL status: SELECT 23 in 0.002 seconds
[0m17:18:49.805173 [info ] [MainThread]: 
[0m17:18:49.805337 [info ] [MainThread]: 
-- dbt_project_evaluator.marts.tests.valid_test_coverage --
[0m17:18:49.805519 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.805619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */

    
        select * from "dbt_course"."bookings_dbt"."fct_test_coverage"
        
  
[0m17:18:49.807482 [debug] [MainThread]: SQL status: SELECT 1 in 0.002 seconds
[0m17:18:49.807930 [info ] [MainThread]: 
[0m17:18:49.808103 [info ] [MainThread]: 
-- dbt_project_evaluator.marts.structure.is_empty_fct_model_directories_ --
[0m17:18:49.808274 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.808373 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */

    
        select * from "dbt_course"."bookings_dbt"."fct_model_directories"
        
  
[0m17:18:49.810313 [debug] [MainThread]: SQL status: SELECT 21 in 0.002 seconds
[0m17:18:49.810845 [info ] [MainThread]: 
[0m17:18:49.811010 [info ] [MainThread]: 
-- dbt_project_evaluator.marts.dag.is_empty_fct_model_fanout_ --
[0m17:18:49.811208 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.811310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */

    
        select * from "dbt_course"."bookings_dbt"."fct_model_fanout"
        
  
[0m17:18:49.811670 [debug] [MainThread]: SQL status: SELECT 2 in 0.000 seconds
[0m17:18:49.812045 [info ] [MainThread]: 
[0m17:18:49.812175 [info ] [MainThread]: 
-- dbt_project_evaluator.marts.dag.is_empty_fct_source_fanout_ --
[0m17:18:49.812378 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:49.812545 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */

    
        select * from "dbt_course"."bookings_dbt"."fct_source_fanout"
        
  
[0m17:18:49.812945 [debug] [MainThread]: SQL status: SELECT 4 in 0.000 seconds
[0m17:18:49.813275 [info ] [MainThread]: 
[0m17:18:49.813376 [info ] [MainThread]: 

[0m17:18:49.813543 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m17:18:49.814878 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m17:18:49.815027 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.04s]
[0m17:18:49.815127 [debug] [MainThread]: On master: Close
[0m17:18:49.815258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:49.815334 [debug] [MainThread]: Connection 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_staging_.bea47be3ca' was properly closed.
[0m17:18:49.815415 [debug] [MainThread]: Connection 'test.dbt_project_evaluator.is_empty_fct_too_many_joins_.0cb37fa535' was properly closed.
[0m17:18:49.815479 [debug] [MainThread]: Connection 'test.dbt_project_evaluator.is_empty_fct_unused_sources_.41456b9da8' was properly closed.
[0m17:18:49.815543 [debug] [MainThread]: Connection 'test.dbt_project_evaluator.is_empty_fct_staging_dependent_on_marts_or_intermediate_.3aa45af51f' was properly closed.
[0m17:18:49.815728 [info ] [MainThread]: 
[0m17:18:49.815820 [info ] [MainThread]: Finished running 5 incremental models, 1 project hook, 3 seeds, 4 snapshots, 40 table models, 33 data tests, 26 view models in 0 hours 0 minutes and 5.85 seconds (5.85s).
[0m17:18:49.819959 [debug] [MainThread]: Command end result
[0m17:18:49.842299 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m17:18:49.843176 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m17:18:49.847114 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m17:18:49.847236 [info ] [MainThread]: 
[0m17:18:49.847369 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 11 warnings:[0m
[0m17:18:49.847467 [info ] [MainThread]: 
[0m17:18:49.847590 [error] [MainThread]:   Database Error in snapshot dim_fligths__airports (snapshots/flights/dim_flights__airports.sql)
  relation "bookings_dbt.src_flights__airports" does not exist
  LINE 28:     "dbt_course"."bookings_dbt"."src_flights__airports"
               ^
[0m17:18:49.847686 [info ] [MainThread]: 
[0m17:18:49.847795 [warn ] [MainThread]: [33mWarning in test valid_documentation_coverage (models/marts/documentation/documentation.yml)[0m
[0m17:18:49.847901 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m17:18:49.847985 [info ] [MainThread]: 
[0m17:18:49.848088 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/documentation/documentation.yml/valid_documentation_coverage.sql
[0m17:18:49.848179 [info ] [MainThread]: 
[0m17:18:49.848283 [warn ] [MainThread]: [33mWarning in test is_empty_fct_model_naming_conventions_ (models/marts/structure/structure.yml)[0m
[0m17:18:49.848386 [warn ] [MainThread]: Got 9 results, configured to warn if != 0
[0m17:18:49.848463 [info ] [MainThread]: 
[0m17:18:49.848563 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/structure/structure.yml/is_empty_fct_model_naming_conventions_.sql
[0m17:18:49.848646 [info ] [MainThread]: 
[0m17:18:49.848748 [warn ] [MainThread]: [33mWarning in test is_empty_fct_source_directories_ (models/marts/structure/structure.yml)[0m
[0m17:18:49.848845 [warn ] [MainThread]: Got 8 results, configured to warn if != 0
[0m17:18:49.848920 [info ] [MainThread]: 
[0m17:18:49.849015 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/structure/structure.yml/is_empty_fct_source_directories_.sql
[0m17:18:49.849096 [info ] [MainThread]: 
[0m17:18:49.849194 [warn ] [MainThread]: [33mWarning in test is_empty_fct_sources_without_freshness_ (models/marts/tests/testing.yml)[0m
[0m17:18:49.849292 [warn ] [MainThread]: Got 5 results, configured to warn if != 0
[0m17:18:49.849365 [info ] [MainThread]: 
[0m17:18:49.849459 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/tests/testing.yml/is_empty_fct_sources_without_freshness_.sql
[0m17:18:49.849541 [info ] [MainThread]: 
[0m17:18:49.849640 [warn ] [MainThread]: [33mWarning in test is_empty_fct_undocumented_models_ (models/marts/documentation/documentation.yml)[0m
[0m17:18:49.849737 [warn ] [MainThread]: Got 22 results, configured to warn if != 0
[0m17:18:49.849813 [info ] [MainThread]: 
[0m17:18:49.849906 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/documentation/documentation.yml/is_empty_fct_undocumented_models_.sql
[0m17:18:49.849983 [info ] [MainThread]: 
[0m17:18:49.850083 [warn ] [MainThread]: [33mWarning in test is_empty_fct_test_directories_ (models/marts/structure/structure.yml)[0m
[0m17:18:49.850179 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m17:18:49.850254 [info ] [MainThread]: 
[0m17:18:49.850351 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/structure/structure.yml/is_empty_fct_test_directories_.sql
[0m17:18:49.850431 [info ] [MainThread]: 
[0m17:18:49.850527 [warn ] [MainThread]: [33mWarning in test is_empty_fct_missing_primary_key_tests_ (models/marts/tests/testing.yml)[0m
[0m17:18:49.850627 [warn ] [MainThread]: Got 23 results, configured to warn if != 0
[0m17:18:49.850707 [info ] [MainThread]: 
[0m17:18:49.850803 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/tests/testing.yml/is_empty_fct_missing_primary_key_tests_.sql
[0m17:18:49.850882 [info ] [MainThread]: 
[0m17:18:49.850980 [warn ] [MainThread]: [33mWarning in test valid_test_coverage (models/marts/tests/testing.yml)[0m
[0m17:18:49.851075 [warn ] [MainThread]: Got 1 result, configured to warn if != 0
[0m17:18:49.851149 [info ] [MainThread]: 
[0m17:18:49.851244 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/tests/testing.yml/valid_test_coverage.sql
[0m17:18:49.851324 [info ] [MainThread]: 
[0m17:18:49.851420 [warn ] [MainThread]: [33mWarning in test is_empty_fct_model_directories_ (models/marts/structure/structure.yml)[0m
[0m17:18:49.851515 [warn ] [MainThread]: Got 21 results, configured to warn if != 0
[0m17:18:49.851591 [info ] [MainThread]: 
[0m17:18:49.851706 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/structure/structure.yml/is_empty_fct_model_directories_.sql
[0m17:18:49.851848 [info ] [MainThread]: 
[0m17:18:49.852011 [warn ] [MainThread]: [33mWarning in test is_empty_fct_model_fanout_ (models/marts/dag/dag.yml)[0m
[0m17:18:49.852138 [warn ] [MainThread]: Got 2 results, configured to warn if != 0
[0m17:18:49.852231 [info ] [MainThread]: 
[0m17:18:49.852336 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/dag/dag.yml/is_empty_fct_model_fanout_.sql
[0m17:18:49.852426 [info ] [MainThread]: 
[0m17:18:49.852548 [warn ] [MainThread]: [33mWarning in test is_empty_fct_source_fanout_ (models/marts/dag/dag.yml)[0m
[0m17:18:49.852718 [warn ] [MainThread]: Got 4 results, configured to warn if != 0
[0m17:18:49.852794 [info ] [MainThread]: 
[0m17:18:49.852887 [info ] [MainThread]:   compiled code at target/compiled/dbt_project_evaluator/models/marts/dag/dag.yml/is_empty_fct_source_fanout_.sql
[0m17:18:49.853006 [info ] [MainThread]: 
[0m17:18:49.853110 [info ] [MainThread]: Done. PASS=100 WARN=11 ERROR=1 SKIP=0 TOTAL=112
[0m17:18:49.854668 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 6.605089, "process_in_blocks": "0", "process_kernel_time": 0.363086, "process_mem_max_rss": "158351360", "process_out_blocks": "0", "process_user_time": 3.602681}
[0m17:18:49.854847 [debug] [MainThread]: Command `dbt build` failed at 17:18:49.854815 after 6.61 seconds
[0m17:18:49.854992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110609a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117cf9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117cf8bf0>]}
[0m17:18:49.855113 [debug] [MainThread]: Flushing usage events
[0m17:18:50.700437 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:57.817471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb7ed0>]}


============================== 17:29:57.819834 | 209a1ce6-dbfc-4ffa-b608-9e044c9e090a ==============================
[0m17:29:57.819834 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:29:57.820086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m17:29:57.862342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '209a1ce6-dbfc-4ffa-b608-9e044c9e090a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f92060>]}
[0m17:29:57.871743 [debug] [MainThread]: Set downloads directory='/var/folders/yp/69w4223n7pq42wk85kckfcrh0000gn/T/dbt-downloads-p8hpwtkv'
[0m17:29:57.871959 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:29:58.595639 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:29:58.597739 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:29:58.920256 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:29:58.928714 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m17:29:59.242302 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m17:29:59.245772 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json
[0m17:29:59.727707 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json 200
[0m17:29:59.732053 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m17:30:00.324703 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m17:30:00.339255 [info ] [MainThread]: Updating lock file in file path: /Users/maksbolomoznov/dbt_prod/package-lock.yml
[0m17:30:00.385811 [debug] [MainThread]: Set downloads directory='/var/folders/yp/69w4223n7pq42wk85kckfcrh0000gn/T/dbt-downloads-etfxt636'
[0m17:30:00.388900 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:30:01.014507 [info ] [MainThread]: Installed from version 1.3.0
[0m17:30:01.014756 [info ] [MainThread]: Up to date!
[0m17:30:01.014935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '209a1ce6-dbfc-4ffa-b608-9e044c9e090a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cea470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cea030>]}
[0m17:30:01.015120 [info ] [MainThread]: Installing dbt-labs/codegen
[0m17:30:01.438421 [info ] [MainThread]: Installed from version 0.13.1
[0m17:30:01.438723 [info ] [MainThread]: Up to date!
[0m17:30:01.438939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '209a1ce6-dbfc-4ffa-b608-9e044c9e090a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110906b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110925f40>]}
[0m17:30:01.439173 [info ] [MainThread]: Installing dbt-labs/dbt_project_evaluator
[0m17:30:02.040983 [info ] [MainThread]: Installed from version 1.0.1
[0m17:30:02.041228 [info ] [MainThread]: Up to date!
[0m17:30:02.041394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '209a1ce6-dbfc-4ffa-b608-9e044c9e090a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108e82f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ebe70>]}
[0m17:30:02.041574 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m17:30:02.587630 [info ] [MainThread]: Installed from version 0.11.2
[0m17:30:02.587882 [info ] [MainThread]: Up to date!
[0m17:30:02.588065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '209a1ce6-dbfc-4ffa-b608-9e044c9e090a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdeb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdf050>]}
[0m17:30:02.596859 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.8056245, "process_in_blocks": "0", "process_kernel_time": 0.24817, "process_mem_max_rss": "109101056", "process_out_blocks": "0", "process_user_time": 0.652185}
[0m17:30:02.597180 [debug] [MainThread]: Command `dbt deps` succeeded at 17:30:02.597122 after 4.81 seconds
[0m17:30:02.597367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109854f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110985590>]}
[0m17:30:02.597542 [debug] [MainThread]: Flushing usage events
[0m17:30:03.381780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:15.169414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102b7ed0>]}


============================== 17:38:15.171860 | 4b593d53-ec3b-49dd-83fc-79aaa98bad62 ==============================
[0m17:38:15.171860 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:38:15.172123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'debug': 'False', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:15.407768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b593d53-ec3b-49dd-83fc-79aaa98bad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074955b0>]}
[0m17:38:15.429494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b593d53-ec3b-49dd-83fc-79aaa98bad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101daf10>]}
[0m17:38:15.430256 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:38:15.479554 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:38:15.539535 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:38:15.539754 [debug] [MainThread]: previous checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m17:38:15.539861 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m17:38:15.540000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b593d53-ec3b-49dd-83fc-79aaa98bad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111295650>]}
[0m17:38:16.221306 [warn ] [MainThread]: Invalid `scale`. Got: -2
[0m17:38:16.385596 [info ] [MainThread]: 17:38:16 + МОЕ сообщение 
[0m17:38:16.489154 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m17:38:16.489394 [info ] [MainThread]: 

[0m17:38:16.935215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b593d53-ec3b-49dd-83fc-79aaa98bad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111879d60>]}
[0m17:38:16.995245 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m17:38:16.996974 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m17:38:17.015900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b593d53-ec3b-49dd-83fc-79aaa98bad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c2e0b0>]}
[0m17:38:17.016110 [info ] [MainThread]: Found 72 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m17:38:17.017584 [info ] [MainThread]: 
[0m17:38:17.017706 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:38:17.017930 [info ] [MainThread]: 
[0m17:38:17.018163 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:38:17.018594 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m17:38:17.037678 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m17:38:17.037857 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:38:17.037950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:17.060891 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.023 seconds
[0m17:38:17.061624 [debug] [ThreadPool]: On list_dbt_course: Close
[0m17:38:17.064727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_bookings_dbt)
[0m17:38:17.067102 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m17:38:17.067293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_snapshot'
[0m17:38:17.067399 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m17:38:17.067582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m17:38:17.068206 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m17:38:17.068321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:17.069050 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m17:38:17.069163 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m17:38:17.069339 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m17:38:17.069443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:17.069536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:17.077339 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:38:17.077499 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m17:38:17.077631 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m17:38:17.077796 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m17:38:17.077916 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m17:38:17.078036 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m17:38:17.078143 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m17:38:17.078237 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m17:38:17.078374 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m17:38:17.080613 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m17:38:17.080743 [debug] [ThreadPool]: SQL status: SELECT 80 in 0.002 seconds
[0m17:38:17.080906 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m17:38:17.081453 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m17:38:17.082224 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m17:38:17.082604 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m17:38:17.082932 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m17:38:17.083029 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m17:38:17.083132 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m17:38:17.089910 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:17.090039 [debug] [MainThread]: On master: BEGIN
[0m17:38:17.090118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:17.096719 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:38:17.096876 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:17.096991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:38:17.100978 [debug] [MainThread]: SQL status: SELECT 34 in 0.004 seconds
[0m17:38:17.103328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b593d53-ec3b-49dd-83fc-79aaa98bad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120f8ae0>]}
[0m17:38:17.103509 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:17.103811 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:17.103897 [debug] [MainThread]: On master: BEGIN
[0m17:38:17.104240 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:38:17.104345 [debug] [MainThread]: On master: COMMIT
[0m17:38:17.104433 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:17.104515 [debug] [MainThread]: On master: COMMIT
[0m17:38:17.104759 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:38:17.104862 [debug] [MainThread]: On master: Close
[0m17:38:17.106054 [debug] [Thread-1 (]: Began running node model.dbt_prod.raw_airports
[0m17:38:17.106221 [info ] [Thread-1 (]: 1 of 1 START sql table model bookings_dbt.raw_airports ......................... [RUN]
[0m17:38:17.106369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_bookings_dbt, now model.dbt_prod.raw_airports)
[0m17:38:17.106481 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.raw_airports
[0m17:38:17.109518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.raw_airports"
[0m17:38:17.110097 [debug] [Thread-1 (]: Began executing node model.dbt_prod.raw_airports
[0m17:38:17.124073 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.raw_airports"
[0m17:38:17.124475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:38:17.124580 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: BEGIN
[0m17:38:17.124673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:17.132181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:38:17.132353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:38:17.132466 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_airports"} */

  
    

  create  table "dbt_course"."bookings_dbt"."raw_airports__dbt_tmp"
  
  
    as
  
  (
    

 select 
  airport_code,
  airport_name, 
  city, 
  coordinates, 
  timezone
  from "dbt_course"."demo_src"."airports"
  );
  
[0m17:38:17.139573 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.007 seconds
[0m17:38:17.143049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:38:17.143163 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_airports"} */
alter table "dbt_course"."bookings_dbt"."raw_airports__dbt_tmp" rename to "raw_airports"
[0m17:38:17.143682 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:38:17.144412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:38:17.144527 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_airports"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'raw_airports'
);
      
[0m17:38:17.145122 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:38:17.145780 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:38:17.145946 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:38:17.146085 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:38:17.146304 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:38:17.146435 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:38:17.146553 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:38:17.146673 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:38:17.146777 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:38:17.146876 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:38:17.147217 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:38:17.147320 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:38:17.147422 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:38:17.147520 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:38:17.147621 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:38:17.147718 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:38:17.147813 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:38:17.147906 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:38:17.148000 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:38:17.148094 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:38:17.148184 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:38:17.148276 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:38:17.148369 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:38:17.148462 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:38:17.148560 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:38:17.148655 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:38:17.148750 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:38:17.148852 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:38:17.148950 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:38:17.149058 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:38:17.149148 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:38:17.149242 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:38:17.149344 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:38:17.153788 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: COMMIT
[0m17:38:17.153898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:38:17.153988 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: COMMIT
[0m17:38:17.155002 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:38:17.157017 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."raw_airports__dbt_backup"
[0m17:38:17.158995 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:38:17.159100 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_airports"} */
drop table if exists "dbt_course"."bookings_dbt"."raw_airports__dbt_backup" cascade
[0m17:38:17.159654 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m17:38:17.160678 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: Close
[0m17:38:17.161750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b593d53-ec3b-49dd-83fc-79aaa98bad62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111020dd0>]}
[0m17:38:17.162066 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bookings_dbt.raw_airports .................... [[32mSELECT 104[0m in 0.05s]
[0m17:38:17.162275 [debug] [Thread-1 (]: Finished running node model.dbt_prod.raw_airports
[0m17:38:17.162882 [info ] [MainThread]: 
[0m17:38:17.163029 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:17.163124 [debug] [MainThread]: On master: BEGIN
[0m17:38:17.163210 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:17.167752 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:38:17.167912 [debug] [MainThread]: On master: COMMIT
[0m17:38:17.167999 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:17.168076 [debug] [MainThread]: On master: COMMIT
[0m17:38:17.168457 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:38:17.169739 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m17:38:17.169872 [info ] [MainThread]: 

[0m17:38:17.169992 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m17:38:17.171669 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m17:38:17.171852 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.00s]
[0m17:38:17.171957 [debug] [MainThread]: On master: Close
[0m17:38:17.172100 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:17.172186 [debug] [MainThread]: Connection 'model.dbt_prod.raw_airports' was properly closed.
[0m17:38:17.172253 [debug] [MainThread]: Connection 'list_dbt_course_snapshot' was properly closed.
[0m17:38:17.172315 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m17:38:17.172404 [info ] [MainThread]: 
[0m17:38:17.172495 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m17:38:17.172737 [debug] [MainThread]: Command end result
[0m17:38:17.199123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m17:38:17.200009 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m17:38:17.202138 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m17:38:17.202246 [info ] [MainThread]: 
[0m17:38:17.202402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:17.202540 [info ] [MainThread]: 
[0m17:38:17.202755 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:38:17.204241 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.0569336, "process_in_blocks": "0", "process_kernel_time": 0.16439, "process_mem_max_rss": "150421504", "process_out_blocks": "0", "process_user_time": 2.168588}
[0m17:38:17.204408 [debug] [MainThread]: Command `cli build` succeeded at 17:38:17.204377 after 2.06 seconds
[0m17:38:17.204534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e30310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111afd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111afce10>]}
[0m17:38:17.204650 [debug] [MainThread]: Flushing usage events
[0m17:38:17.993154 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:41:37.309650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db7ed0>]}


============================== 17:41:37.312145 | 8c402097-a536-4d11-a27a-7a215571675c ==============================
[0m17:41:37.312145 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:41:37.312421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:41:37.370036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c402097-a536-4d11-a27a-7a215571675c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e955b0>]}
[0m17:41:37.390223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c402097-a536-4d11-a27a-7a215571675c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdef10>]}
[0m17:41:37.391444 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:41:37.434763 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:41:37.531745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:41:37.532165 [debug] [MainThread]: Partial parsing: updated file: dbt_prod://models/raw_stage/raw_airports.sql
[0m17:41:37.669973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c402097-a536-4d11-a27a-7a215571675c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c52150>]}
[0m17:41:37.732041 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m17:41:37.733641 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m17:41:37.753506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c402097-a536-4d11-a27a-7a215571675c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110346f30>]}
[0m17:41:37.753758 [info ] [MainThread]: Found 72 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m17:41:37.755299 [info ] [MainThread]: 
[0m17:41:37.755455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:41:37.755668 [info ] [MainThread]: 
[0m17:41:37.755879 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:41:37.756258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m17:41:37.775797 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m17:41:37.775983 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:41:37.776093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:37.797442 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.021 seconds
[0m17:41:37.798188 [debug] [ThreadPool]: On list_dbt_course: Close
[0m17:41:37.801217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_bookings_dbt)
[0m17:41:37.801424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_snapshot'
[0m17:41:37.803821 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m17:41:37.804012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m17:41:37.804787 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m17:41:37.804938 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m17:41:37.805658 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m17:41:37.805763 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m17:41:37.805851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:37.805930 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m17:41:37.806003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:37.806170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:37.817962 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:41:37.818150 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:41:37.818267 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m17:41:37.818368 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m17:41:37.818489 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m17:41:37.818615 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m17:41:37.818803 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m17:41:37.818990 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m17:41:37.819179 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m17:41:37.823255 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m17:41:37.823398 [debug] [ThreadPool]: SQL status: SELECT 81 in 0.004 seconds
[0m17:41:37.823496 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m17:41:37.823985 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m17:41:37.824710 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m17:41:37.825059 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m17:41:37.825543 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m17:41:37.825711 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m17:41:37.825844 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m17:41:37.832605 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:37.832741 [debug] [MainThread]: On master: BEGIN
[0m17:41:37.832819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:37.838502 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:41:37.838683 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:37.838806 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:41:37.842872 [debug] [MainThread]: SQL status: SELECT 34 in 0.004 seconds
[0m17:41:37.845161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c402097-a536-4d11-a27a-7a215571675c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11026c750>]}
[0m17:41:37.845347 [debug] [MainThread]: On master: ROLLBACK
[0m17:41:37.845790 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:37.845912 [debug] [MainThread]: On master: BEGIN
[0m17:41:37.846501 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:41:37.846622 [debug] [MainThread]: On master: COMMIT
[0m17:41:37.846712 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:37.846788 [debug] [MainThread]: On master: COMMIT
[0m17:41:37.847045 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:41:37.847150 [debug] [MainThread]: On master: Close
[0m17:41:37.849173 [debug] [Thread-1 (]: Began running node model.dbt_prod.raw_airports
[0m17:41:37.849396 [info ] [Thread-1 (]: 1 of 1 START sql table model bookings_dbt.raw_airports ......................... [RUN]
[0m17:41:37.849574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_bookings_dbt, now model.dbt_prod.raw_airports)
[0m17:41:37.849715 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.raw_airports
[0m17:41:37.852694 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.raw_airports"
[0m17:41:37.852991 [debug] [Thread-1 (]: Began executing node model.dbt_prod.raw_airports
[0m17:41:37.868022 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.raw_airports"
[0m17:41:37.868436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:41:37.868543 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: BEGIN
[0m17:41:37.868642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:37.878872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:41:37.879047 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:41:37.879169 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_airports"} */

  
    

  create  table "dbt_course"."bookings_dbt"."raw_airports__dbt_tmp"
  
  
    as
  
  (
    

 select 
  airport_code,
  airport_name, 
  city, 
  coordinates, 
  timezone,
  'bookings' as RECORD_SOURCE,
  now() as LOAD_DATE
  
  from "dbt_course"."demo_src"."airports"
  );
  
[0m17:41:37.885937 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.007 seconds
[0m17:41:37.889424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:41:37.889554 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_airports"} */
alter table "dbt_course"."bookings_dbt"."raw_airports" rename to "raw_airports__dbt_backup"
[0m17:41:37.890445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:41:37.891875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:41:37.891999 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_airports"} */
alter table "dbt_course"."bookings_dbt"."raw_airports__dbt_tmp" rename to "raw_airports"
[0m17:41:37.892404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:41:37.893276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:41:37.893388 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_airports"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'raw_airports'
);
      
[0m17:41:37.893888 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.000 seconds
[0m17:41:37.894550 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:41:37.894709 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:41:37.894857 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:41:37.894972 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:41:37.895080 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:41:37.895191 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:41:37.895288 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:41:37.895383 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:41:37.895485 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:41:37.895589 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:41:37.895695 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:41:37.895807 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:41:37.895902 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:41:37.896014 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:41:37.896118 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:41:37.896213 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:41:37.896305 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:41:37.896401 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:41:37.896502 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:41:37.896598 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:41:37.896697 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:41:37.896786 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:41:37.896883 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:41:37.896983 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:41:37.897078 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:41:37.897173 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:41:37.897271 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:41:37.897368 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:41:37.897475 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:41:37.897565 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:41:37.897658 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:41:37.897757 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:41:37.902904 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: COMMIT
[0m17:41:37.903032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:41:37.903128 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: COMMIT
[0m17:41:37.904295 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:41:37.906678 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."raw_airports__dbt_backup"
[0m17:41:37.908176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_airports"
[0m17:41:37.908292 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_airports"} */
drop table if exists "dbt_course"."bookings_dbt"."raw_airports__dbt_backup" cascade
[0m17:41:37.910431 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:41:37.911522 [debug] [Thread-1 (]: On model.dbt_prod.raw_airports: Close
[0m17:41:37.912409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c402097-a536-4d11-a27a-7a215571675c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11136ab60>]}
[0m17:41:37.912708 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bookings_dbt.raw_airports .................... [[32mSELECT 104[0m in 0.06s]
[0m17:41:37.912911 [debug] [Thread-1 (]: Finished running node model.dbt_prod.raw_airports
[0m17:41:37.913564 [info ] [MainThread]: 
[0m17:41:37.913700 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:37.913786 [debug] [MainThread]: On master: BEGIN
[0m17:41:37.913888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:37.918939 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:41:37.919053 [debug] [MainThread]: On master: COMMIT
[0m17:41:37.919142 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:37.919225 [debug] [MainThread]: On master: COMMIT
[0m17:41:37.919526 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:41:37.924041 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m17:41:37.924202 [info ] [MainThread]: 

[0m17:41:37.924333 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m17:41:37.925670 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m17:41:37.925815 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.01s]
[0m17:41:37.925915 [debug] [MainThread]: On master: Close
[0m17:41:37.926062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:37.926144 [debug] [MainThread]: Connection 'model.dbt_prod.raw_airports' was properly closed.
[0m17:41:37.926216 [debug] [MainThread]: Connection 'list_dbt_course_snapshot' was properly closed.
[0m17:41:37.926279 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m17:41:37.926359 [info ] [MainThread]: 
[0m17:41:37.926449 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m17:41:37.926689 [debug] [MainThread]: Command end result
[0m17:41:37.951631 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m17:41:37.952590 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m17:41:37.954671 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m17:41:37.954782 [info ] [MainThread]: 
[0m17:41:37.954894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:37.954972 [info ] [MainThread]: 
[0m17:41:37.955068 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:41:37.956596 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.6690949, "process_in_blocks": "0", "process_kernel_time": 0.150845, "process_mem_max_rss": "140230656", "process_out_blocks": "0", "process_user_time": 0.977536}
[0m17:41:37.956793 [debug] [MainThread]: Command `cli build` succeeded at 17:41:37.956755 after 0.67 seconds
[0m17:41:37.956923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a1650>]}
[0m17:41:37.957041 [debug] [MainThread]: Flushing usage events
[0m17:41:38.760085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:56:35.879252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b86d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9b7ed0>]}


============================== 17:56:35.882056 | 88cc0fe0-0182-403c-98e7-2f856858f989 ==============================
[0m17:56:35.882056 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:56:35.882351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:56:35.949729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88cc0fe0-0182-403c-98e7-2f856858f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba955b0>]}
[0m17:56:35.975355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88cc0fe0-0182-403c-98e7-2f856858f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8daf10>]}
[0m17:56:35.976719 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:56:36.028505 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m17:56:36.137795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:56:36.138281 [debug] [MainThread]: Partial parsing: added file: dbt_prod://models/stage/v_stg_flights__airports.sql
[0m17:56:36.347447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88cc0fe0-0182-403c-98e7-2f856858f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc71e50>]}
[0m17:56:36.418405 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m17:56:36.420133 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m17:56:36.441243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88cc0fe0-0182-403c-98e7-2f856858f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d69ef30>]}
[0m17:56:36.441467 [info ] [MainThread]: Found 73 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m17:56:36.443004 [info ] [MainThread]: 
[0m17:56:36.443151 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:56:36.443237 [info ] [MainThread]: 
[0m17:56:36.443426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:56:36.443879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m17:56:36.464737 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m17:56:36.464946 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m17:56:36.465063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:36.483124 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.018 seconds
[0m17:56:36.484170 [debug] [ThreadPool]: On list_dbt_course: Close
[0m17:56:36.488097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_bookings_dbt)
[0m17:56:36.488404 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_snapshot'
[0m17:56:36.491223 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m17:56:36.491440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m17:56:36.492379 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m17:56:36.492563 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m17:56:36.494615 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m17:56:36.494758 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m17:56:36.494848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:56:36.494927 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m17:56:36.495000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:36.495174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:56:36.503756 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:56:36.503981 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:56:36.504110 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:56:36.504221 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m17:56:36.504334 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m17:56:36.504462 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m17:56:36.504595 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m17:56:36.504764 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m17:56:36.504914 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m17:56:36.507975 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m17:56:36.508105 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m17:56:36.508222 [debug] [ThreadPool]: SQL status: SELECT 81 in 0.003 seconds
[0m17:56:36.508938 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m17:56:36.509430 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m17:56:36.510513 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m17:56:36.511208 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m17:56:36.511330 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m17:56:36.511444 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m17:56:36.519193 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:36.519364 [debug] [MainThread]: On master: BEGIN
[0m17:56:36.519450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:56:36.525633 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:56:36.525735 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:36.525916 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:56:36.529961 [debug] [MainThread]: SQL status: SELECT 34 in 0.004 seconds
[0m17:56:36.532687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88cc0fe0-0182-403c-98e7-2f856858f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c65f0>]}
[0m17:56:36.532926 [debug] [MainThread]: On master: ROLLBACK
[0m17:56:36.533514 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:36.533705 [debug] [MainThread]: On master: BEGIN
[0m17:56:36.534488 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:56:36.534611 [debug] [MainThread]: On master: COMMIT
[0m17:56:36.534698 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:36.534770 [debug] [MainThread]: On master: COMMIT
[0m17:56:36.535153 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:56:36.535353 [debug] [MainThread]: On master: Close
[0m17:56:36.537502 [debug] [Thread-1 (]: Began running node model.dbt_prod.v_stg_flights__airports
[0m17:56:36.537736 [info ] [Thread-1 (]: 1 of 1 START sql view model bookings_dbt.v_stg_flights__airports ............... [RUN]
[0m17:56:36.537902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_bookings_dbt, now model.dbt_prod.v_stg_flights__airports)
[0m17:56:36.538019 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.v_stg_flights__airports
[0m17:56:36.545744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__airports"
[0m17:56:36.545924 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__airports: BEGIN
[0m17:56:36.546026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:56:36.552466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:56:36.552720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__airports"
[0m17:56:36.552868 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m17:56:36.558919 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.006 seconds
[0m17:56:36.562002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__airports"
[0m17:56:36.562198 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m17:56:36.565132 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m17:56:36.567884 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.v_stg_flights__airports"
[0m17:56:36.568277 [debug] [Thread-1 (]: Began executing node model.dbt_prod.v_stg_flights__airports
[0m17:56:36.580336 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.v_stg_flights__airports"
[0m17:56:36.580742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__airports"
[0m17:56:36.580876 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__airports"} */

  create view "dbt_course"."bookings_dbt"."v_stg_flights__airports__dbt_tmp"
    
    
  as (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates,
    timezone,
    record_source,
    load_date

    FROM "dbt_course"."bookings_dbt"."raw_airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates,
    timezone,
    record_source,
    load_date,
    '1' AS SOURCE,
    LOAD_DATE AS LOAD_DATETIME,
    LOAD_DATE::date AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates,
    timezone,
    record_source,
    load_date,
    SOURCE,
    LOAD_DATETIME,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS AIRPORT_HK,

    DECODE(MD5(CONCAT_WS('||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'),
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'),
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates AS VARCHAR))), ''), '^^'),
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRPORT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates,
    timezone,
    record_source,
    load_date,
    SOURCE,
    LOAD_DATETIME,
    EFFECTIVE_FROM,
    AIRPORT_HK,
    AIRPORT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
[0m17:56:36.583751 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:56:36.586561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__airports"
[0m17:56:36.586701 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__airports"} */
alter table "dbt_course"."bookings_dbt"."v_stg_flights__airports__dbt_tmp" rename to "v_stg_flights__airports"
[0m17:56:36.587720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:56:36.594072 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__airports"
[0m17:56:36.594244 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__airports"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'v_stg_flights__airports'
);
      
[0m17:56:36.595315 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m17:56:36.596099 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m17:56:36.596299 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m17:56:36.596457 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m17:56:36.596574 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m17:56:36.596683 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m17:56:36.596792 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m17:56:36.596903 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m17:56:36.597008 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m17:56:36.597110 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m17:56:36.597216 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m17:56:36.597327 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m17:56:36.597443 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m17:56:36.597548 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m17:56:36.597651 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m17:56:36.597753 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m17:56:36.597867 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m17:56:36.597978 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m17:56:36.598082 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m17:56:36.598185 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m17:56:36.598287 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m17:56:36.598392 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m17:56:36.598494 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m17:56:36.598596 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m17:56:36.598697 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m17:56:36.598801 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m17:56:36.598904 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m17:56:36.599005 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m17:56:36.599110 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m17:56:36.599210 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m17:56:36.599311 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m17:56:36.599417 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m17:56:36.599519 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m17:56:36.599733 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__airports: COMMIT
[0m17:56:36.600009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__airports"
[0m17:56:36.600308 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__airports: COMMIT
[0m17:56:36.601725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:56:36.604581 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."v_stg_flights__airports__dbt_backup"
[0m17:56:36.606124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__airports"
[0m17:56:36.606243 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__airports"} */
drop view if exists "dbt_course"."bookings_dbt"."v_stg_flights__airports__dbt_backup" cascade
[0m17:56:36.607058 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:56:36.608330 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__airports: Close
[0m17:56:36.609471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88cc0fe0-0182-403c-98e7-2f856858f989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecdcef0>]}
[0m17:56:36.609771 [info ] [Thread-1 (]: 1 of 1 OK created sql view model bookings_dbt.v_stg_flights__airports .......... [[32mCREATE VIEW[0m in 0.07s]
[0m17:56:36.610033 [debug] [Thread-1 (]: Finished running node model.dbt_prod.v_stg_flights__airports
[0m17:56:36.610875 [info ] [MainThread]: 
[0m17:56:36.611112 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:36.611346 [debug] [MainThread]: On master: BEGIN
[0m17:56:36.611441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:56:36.617500 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:56:36.617607 [debug] [MainThread]: On master: COMMIT
[0m17:56:36.617694 [debug] [MainThread]: Using postgres connection "master"
[0m17:56:36.617767 [debug] [MainThread]: On master: COMMIT
[0m17:56:36.618270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:56:36.622383 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m17:56:36.622524 [info ] [MainThread]: 

[0m17:56:36.622639 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m17:56:36.623941 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m17:56:36.624097 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.01s]
[0m17:56:36.624210 [debug] [MainThread]: On master: Close
[0m17:56:36.624370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:56:36.624448 [debug] [MainThread]: Connection 'model.dbt_prod.v_stg_flights__airports' was properly closed.
[0m17:56:36.624518 [debug] [MainThread]: Connection 'list_dbt_course_snapshot' was properly closed.
[0m17:56:36.624576 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m17:56:36.624655 [info ] [MainThread]: 
[0m17:56:36.624740 [info ] [MainThread]: Finished running 1 project hook, 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m17:56:36.624982 [debug] [MainThread]: Command end result
[0m17:56:36.652691 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m17:56:36.653541 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m17:56:36.655447 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m17:56:36.655539 [info ] [MainThread]: 
[0m17:56:36.655667 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:56:36.655745 [info ] [MainThread]: 
[0m17:56:36.655842 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:56:36.657540 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.8044057, "process_in_blocks": "0", "process_kernel_time": 0.17428, "process_mem_max_rss": "143884288", "process_out_blocks": "0", "process_user_time": 1.167459}
[0m17:56:36.657782 [debug] [MainThread]: Command `cli build` succeeded at 17:56:36.657740 after 0.80 seconds
[0m17:56:36.657935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dff5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dff66d0>]}
[0m17:56:36.658075 [debug] [MainThread]: Flushing usage events
[0m17:56:37.420032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:18.804525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eb5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139b7ed0>]}


============================== 18:08:18.807041 | 20b4dc8b-934f-490d-b219-45c5b6146367 ==============================
[0m18:08:18.807041 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:08:18.807280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:08:18.869282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20b4dc8b-934f-490d-b219-45c5b6146367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122955b0>]}
[0m18:08:18.890741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20b4dc8b-934f-490d-b219-45c5b6146367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138daf10>]}
[0m18:08:18.891917 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:08:18.937735 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:08:19.041263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:08:19.041697 [debug] [MainThread]: Partial parsing: added file: dbt_prod://models/raw_vault/hubs/hub_airports.sql
[0m18:08:19.212386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20b4dc8b-934f-490d-b219-45c5b6146367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114975e50>]}
[0m18:08:19.277881 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m18:08:19.279438 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m18:08:19.298725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20b4dc8b-934f-490d-b219-45c5b6146367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f16f30>]}
[0m18:08:19.298949 [info ] [MainThread]: Found 74 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m18:08:19.300360 [info ] [MainThread]: 
[0m18:08:19.300482 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:08:19.300566 [info ] [MainThread]: 
[0m18:08:19.300740 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:08:19.301143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m18:08:19.321044 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m18:08:19.321244 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:08:19.321356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:19.345397 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.024 seconds
[0m18:08:19.346111 [debug] [ThreadPool]: On list_dbt_course: Close
[0m18:08:19.349668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_bookings_dbt)
[0m18:08:19.352362 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m18:08:19.352631 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_snapshot'
[0m18:08:19.352781 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m18:08:19.352980 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m18:08:19.353699 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m18:08:19.353826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:19.354576 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m18:08:19.354678 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m18:08:19.354852 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m18:08:19.354982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:19.355082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:19.365787 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m18:08:19.365975 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m18:08:19.366144 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m18:08:19.366593 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m18:08:19.366722 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m18:08:19.366828 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m18:08:19.366986 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m18:08:19.367138 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m18:08:19.367253 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m18:08:19.367703 [debug] [ThreadPool]: SQL status: SELECT 82 in 0.001 seconds
[0m18:08:19.368707 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m18:08:19.369133 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m18:08:19.372112 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m18:08:19.372207 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m18:08:19.372673 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m18:08:19.373136 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m18:08:19.373566 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m18:08:19.373704 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m18:08:19.377654 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:19.377799 [debug] [MainThread]: On master: BEGIN
[0m18:08:19.377877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:19.383229 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:08:19.383425 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:19.383568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:08:19.385917 [debug] [MainThread]: SQL status: SELECT 35 in 0.002 seconds
[0m18:08:19.388069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20b4dc8b-934f-490d-b219-45c5b6146367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149af930>]}
[0m18:08:19.388244 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:19.388679 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:19.388765 [debug] [MainThread]: On master: BEGIN
[0m18:08:19.389315 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:08:19.389495 [debug] [MainThread]: On master: COMMIT
[0m18:08:19.389628 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:19.389715 [debug] [MainThread]: On master: COMMIT
[0m18:08:19.390140 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:08:19.390294 [debug] [MainThread]: On master: Close
[0m18:08:19.392253 [debug] [Thread-1 (]: Began running node model.dbt_prod.hub_airports
[0m18:08:19.392448 [info ] [Thread-1 (]: 1 of 1 START sql incremental model bookings_dbt.hub_airports ................... [RUN]
[0m18:08:19.392610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_bookings_dbt, now model.dbt_prod.hub_airports)
[0m18:08:19.392868 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.hub_airports
[0m18:08:19.401228 [info ] [Thread-1 (]: 18:08:19 + Loading dbt_course.bookings_dbt.hub_airports from 1 source(s)
[0m18:08:19.402765 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.hub_airports"
[0m18:08:19.403174 [debug] [Thread-1 (]: Began executing node model.dbt_prod.hub_airports
[0m18:08:19.423468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.hub_airports"
[0m18:08:19.423949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:19.424058 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: BEGIN
[0m18:08:19.424164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:19.434414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m18:08:19.434750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:19.434948 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_airports"} */

      
  
    

  create  table "dbt_course"."bookings_dbt"."hub_airports"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRPORT_HK) rr.AIRPORT_HK, rr.airport_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "dbt_course"."bookings_dbt"."v_stg_flights__airports" AS rr
    WHERE rr.AIRPORT_HK IS NOT NULL
    ORDER BY rr.AIRPORT_HK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRPORT_HK, a.airport_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:08:19.438413 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.003 seconds
[0m18:08:19.445042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:19.445214 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_airports"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'hub_airports'
);
      
[0m18:08:19.446185 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m18:08:19.446913 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m18:08:19.447093 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m18:08:19.447224 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m18:08:19.447328 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m18:08:19.447423 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m18:08:19.447519 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m18:08:19.447614 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m18:08:19.447706 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m18:08:19.447800 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m18:08:19.447889 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m18:08:19.447981 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m18:08:19.448071 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m18:08:19.448160 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m18:08:19.448251 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m18:08:19.448339 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m18:08:19.448434 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m18:08:19.448521 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m18:08:19.448613 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m18:08:19.448715 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m18:08:19.448828 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m18:08:19.448933 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m18:08:19.449025 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m18:08:19.449117 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m18:08:19.449210 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m18:08:19.449301 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m18:08:19.449395 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m18:08:19.449486 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m18:08:19.449576 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m18:08:19.449667 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m18:08:19.449756 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m18:08:19.449857 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m18:08:19.449959 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m18:08:19.450126 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: COMMIT
[0m18:08:19.450229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:19.450319 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: COMMIT
[0m18:08:19.451315 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:19.452203 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: Close
[0m18:08:19.453191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20b4dc8b-934f-490d-b219-45c5b6146367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116229cc0>]}
[0m18:08:19.453517 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model bookings_dbt.hub_airports .............. [[32mSELECT 104[0m in 0.06s]
[0m18:08:19.453704 [debug] [Thread-1 (]: Finished running node model.dbt_prod.hub_airports
[0m18:08:19.454257 [info ] [MainThread]: 
[0m18:08:19.454419 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:19.454513 [debug] [MainThread]: On master: BEGIN
[0m18:08:19.454595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:19.459451 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:08:19.459611 [debug] [MainThread]: On master: COMMIT
[0m18:08:19.459705 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:19.459784 [debug] [MainThread]: On master: COMMIT
[0m18:08:19.460157 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:08:19.464758 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m18:08:19.464927 [info ] [MainThread]: 

[0m18:08:19.465053 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m18:08:19.466370 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m18:08:19.466535 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.01s]
[0m18:08:19.466650 [debug] [MainThread]: On master: Close
[0m18:08:19.466793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:19.466863 [debug] [MainThread]: Connection 'model.dbt_prod.hub_airports' was properly closed.
[0m18:08:19.466935 [debug] [MainThread]: Connection 'list_dbt_course_snapshot' was properly closed.
[0m18:08:19.466996 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m18:08:19.467075 [info ] [MainThread]: 
[0m18:08:19.467158 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m18:08:19.467428 [debug] [MainThread]: Command end result
[0m18:08:19.493276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m18:08:19.494234 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m18:08:19.496219 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m18:08:19.496320 [info ] [MainThread]: 
[0m18:08:19.496442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:19.496521 [info ] [MainThread]: 
[0m18:08:19.496611 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:08:19.498281 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.7188819, "process_in_blocks": "0", "process_kernel_time": 0.150878, "process_mem_max_rss": "142966784", "process_out_blocks": "0", "process_user_time": 1.053395}
[0m18:08:19.498492 [debug] [MainThread]: Command `cli build` succeeded at 18:08:19.498456 after 0.72 seconds
[0m18:08:19.498627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138e0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fe1c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fe1b20>]}
[0m18:08:19.498750 [debug] [MainThread]: Flushing usage events
[0m18:08:20.290971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:34.414039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b7ed0>]}


============================== 18:08:34.416977 | 02ea43de-24a1-4d6b-be24-c68b7c2ff8bc ==============================
[0m18:08:34.416977 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:08:34.417356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:08:34.479534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02ea43de-24a1-4d6b-be24-c68b7c2ff8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051955b0>]}
[0m18:08:34.501560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02ea43de-24a1-4d6b-be24-c68b7c2ff8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105edef10>]}
[0m18:08:34.502852 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:08:34.550357 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m18:08:34.653677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:34.653884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:34.687487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02ea43de-24a1-4d6b-be24-c68b7c2ff8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5cd50>]}
[0m18:08:34.783753 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m18:08:34.785387 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m18:08:34.806606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02ea43de-24a1-4d6b-be24-c68b7c2ff8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106482f30>]}
[0m18:08:34.806831 [info ] [MainThread]: Found 74 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m18:08:34.808276 [info ] [MainThread]: 
[0m18:08:34.808391 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:08:34.808469 [info ] [MainThread]: 
[0m18:08:34.808702 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:08:34.809135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m18:08:34.830253 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m18:08:34.830449 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m18:08:34.830549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:34.856384 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.026 seconds
[0m18:08:34.857131 [debug] [ThreadPool]: On list_dbt_course: Close
[0m18:08:34.861141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_bookings_dbt)
[0m18:08:34.863955 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m18:08:34.864272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_snapshot'
[0m18:08:34.864384 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m18:08:34.864543 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m18:08:34.865334 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m18:08:34.865436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:34.866297 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m18:08:34.866458 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m18:08:34.866673 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m18:08:34.866805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:34.866970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:34.880461 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m18:08:34.880664 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m18:08:34.880789 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m18:08:34.880890 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m18:08:34.880983 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m18:08:34.881067 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m18:08:34.881160 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m18:08:34.881260 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m18:08:34.881358 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m18:08:34.883813 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m18:08:34.884099 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m18:08:34.884839 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m18:08:34.885004 [debug] [ThreadPool]: SQL status: SELECT 83 in 0.004 seconds
[0m18:08:34.885628 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m18:08:34.886536 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m18:08:34.886643 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m18:08:34.887106 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m18:08:34.887218 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m18:08:34.893946 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:34.894084 [debug] [MainThread]: On master: BEGIN
[0m18:08:34.894162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:34.899970 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:08:34.900195 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:34.900354 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:08:34.902817 [debug] [MainThread]: SQL status: SELECT 35 in 0.002 seconds
[0m18:08:34.905068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02ea43de-24a1-4d6b-be24-c68b7c2ff8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107163310>]}
[0m18:08:34.905298 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:34.906309 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:34.906448 [debug] [MainThread]: On master: BEGIN
[0m18:08:34.907724 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:08:34.907827 [debug] [MainThread]: On master: COMMIT
[0m18:08:34.907902 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:34.907974 [debug] [MainThread]: On master: COMMIT
[0m18:08:34.908537 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:08:34.908616 [debug] [MainThread]: On master: Close
[0m18:08:34.910246 [debug] [Thread-1 (]: Began running node model.dbt_prod.hub_airports
[0m18:08:34.910475 [info ] [Thread-1 (]: 1 of 1 START sql incremental model bookings_dbt.hub_airports ................... [RUN]
[0m18:08:34.910684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_bookings_dbt, now model.dbt_prod.hub_airports)
[0m18:08:34.910808 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.hub_airports
[0m18:08:34.924250 [info ] [Thread-1 (]: 18:08:34 + Loading dbt_course.bookings_dbt.hub_airports from 1 source(s)
[0m18:08:34.946929 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.hub_airports"
[0m18:08:34.947321 [debug] [Thread-1 (]: Began executing node model.dbt_prod.hub_airports
[0m18:08:34.967421 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:34.967649 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_airports"} */

    
  
    

  create temporary table "hub_airports__dbt_tmp180834958823"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRPORT_HK) rr.AIRPORT_HK, rr.airport_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "dbt_course"."bookings_dbt"."v_stg_flights__airports" AS rr
    WHERE rr.AIRPORT_HK IS NOT NULL
    ORDER BY rr.AIRPORT_HK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRPORT_HK, a.airport_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "dbt_course"."bookings_dbt"."hub_airports" AS d
    ON a.AIRPORT_HK = d.AIRPORT_HK
    WHERE d.AIRPORT_HK IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:08:34.967762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:34.985225 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.017 seconds
[0m18:08:34.990549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:34.990731 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: BEGIN
[0m18:08:34.992169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:08:34.992366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:34.992478 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports__dbt_tmp180834958823'
        
      order by ordinal_position

  
[0m18:08:35.001539 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.009 seconds
[0m18:08:35.003758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:35.003899 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m18:08:35.006484 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m18:08:35.009829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:35.009999 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m18:08:35.012505 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.002 seconds
[0m18:08:35.016893 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.hub_airports"
[0m18:08:35.017289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:35.017405 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_airports"} */

      insert into "dbt_course"."bookings_dbt"."hub_airports" ("airport_hk", "airport_code", "load_date", "record_source")
    (
        select "airport_hk", "airport_code", "load_date", "record_source"
        from "hub_airports__dbt_tmp180834958823"
    )


  
[0m18:08:35.018112 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m18:08:35.023963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:35.024210 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_airports"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'hub_airports'
);
      
[0m18:08:35.025002 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m18:08:35.027027 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m18:08:35.027203 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m18:08:35.027343 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m18:08:35.027455 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m18:08:35.027588 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m18:08:35.027701 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m18:08:35.027807 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m18:08:35.027910 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m18:08:35.028020 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m18:08:35.028124 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m18:08:35.028227 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m18:08:35.028329 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m18:08:35.028434 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m18:08:35.028541 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m18:08:35.028640 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m18:08:35.028748 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m18:08:35.028852 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m18:08:35.028955 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m18:08:35.029055 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m18:08:35.029152 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m18:08:35.029253 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m18:08:35.029353 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m18:08:35.029454 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m18:08:35.029561 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m18:08:35.029667 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m18:08:35.029770 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m18:08:35.029874 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m18:08:35.029974 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m18:08:35.030073 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m18:08:35.030176 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m18:08:35.030282 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m18:08:35.030392 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m18:08:35.030581 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: COMMIT
[0m18:08:35.030691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_airports"
[0m18:08:35.030791 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: COMMIT
[0m18:08:35.032113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:35.032970 [debug] [Thread-1 (]: On model.dbt_prod.hub_airports: Close
[0m18:08:35.034087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02ea43de-24a1-4d6b-be24-c68b7c2ff8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107678a10>]}
[0m18:08:35.034654 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model bookings_dbt.hub_airports .............. [[32mINSERT 0 0[0m in 0.12s]
[0m18:08:35.035081 [debug] [Thread-1 (]: Finished running node model.dbt_prod.hub_airports
[0m18:08:35.035774 [info ] [MainThread]: 
[0m18:08:35.035977 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:35.036083 [debug] [MainThread]: On master: BEGIN
[0m18:08:35.036257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:35.041198 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:08:35.041356 [debug] [MainThread]: On master: COMMIT
[0m18:08:35.041457 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:35.041546 [debug] [MainThread]: On master: COMMIT
[0m18:08:35.041850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:08:35.046333 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m18:08:35.046520 [info ] [MainThread]: 

[0m18:08:35.046652 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m18:08:35.048066 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m18:08:35.048222 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.01s]
[0m18:08:35.048338 [debug] [MainThread]: On master: Close
[0m18:08:35.048502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:35.048583 [debug] [MainThread]: Connection 'model.dbt_prod.hub_airports' was properly closed.
[0m18:08:35.048658 [debug] [MainThread]: Connection 'list_dbt_course_snapshot' was properly closed.
[0m18:08:35.048725 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m18:08:35.048812 [info ] [MainThread]: 
[0m18:08:35.048903 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m18:08:35.049162 [debug] [MainThread]: Command end result
[0m18:08:35.075021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m18:08:35.076044 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m18:08:35.078120 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m18:08:35.078222 [info ] [MainThread]: 
[0m18:08:35.078365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:35.078460 [info ] [MainThread]: 
[0m18:08:35.078588 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:08:35.080789 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.69053525, "process_in_blocks": "0", "process_kernel_time": 0.159933, "process_mem_max_rss": "138084352", "process_out_blocks": "0", "process_user_time": 0.992367}
[0m18:08:35.081001 [debug] [MainThread]: Command `cli build` succeeded at 18:08:35.080959 after 0.69 seconds
[0m18:08:35.081152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b9de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b9650>]}
[0m18:08:35.081292 [debug] [MainThread]: Flushing usage events
[0m18:08:35.748052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:07:04.111713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d65940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b7ed0>]}


============================== 13:07:04.113879 | 900ade69-53ce-44d4-957c-6e2b04814f99 ==============================
[0m13:07:04.113879 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:07:04.114210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:07:04.151886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '900ade69-53ce-44d4-957c-6e2b04814f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108895f30>]}
[0m13:07:04.195516 [debug] [MainThread]: Set downloads directory='/var/folders/yp/69w4223n7pq42wk85kckfcrh0000gn/T/dbt-downloads-7uzuv6qm'
[0m13:07:04.195744 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:07:04.489589 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:07:04.490249 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:07:04.644115 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:07:04.645572 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:07:04.840886 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:07:04.842203 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json
[0m13:07:05.026717 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json 200
[0m13:07:05.030402 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m13:07:05.280993 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m13:07:05.285961 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:07:05.846474 [info ] [MainThread]: Installed from version 1.3.0
[0m13:07:05.846727 [info ] [MainThread]: Up to date!
[0m13:07:05.847009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '900ade69-53ce-44d4-957c-6e2b04814f99', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ea580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996cc00>]}
[0m13:07:05.847346 [info ] [MainThread]: Installing dbt-labs/codegen
[0m13:07:06.267736 [info ] [MainThread]: Installed from version 0.13.1
[0m13:07:06.268068 [info ] [MainThread]: Up to date!
[0m13:07:06.268291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '900ade69-53ce-44d4-957c-6e2b04814f99', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10990ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d36b0>]}
[0m13:07:06.268519 [info ] [MainThread]: Installing dbt-labs/dbt_project_evaluator
[0m13:07:06.920247 [info ] [MainThread]: Installed from version 1.0.1
[0m13:07:06.920486 [info ] [MainThread]: Updated version available: 1.0.2
[0m13:07:06.920642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '900ade69-53ce-44d4-957c-6e2b04814f99', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ed550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109994910>]}
[0m13:07:06.920828 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m13:07:07.430940 [info ] [MainThread]: Installed from version 0.11.2
[0m13:07:07.431211 [info ] [MainThread]: Up to date!
[0m13:07:07.431400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '900ade69-53ce-44d4-957c-6e2b04814f99', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e3350>]}
[0m13:07:07.431652 [info ] [MainThread]: 
[0m13:07:07.431805 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_project_evaluator']                 
Update your versions in packages.yml, then run dbt deps
[0m13:07:07.445686 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.357235, "process_in_blocks": "0", "process_kernel_time": 0.218867, "process_mem_max_rss": "110346240", "process_out_blocks": "0", "process_user_time": 0.574092}
[0m13:07:07.446001 [debug] [MainThread]: Command `cli deps` succeeded at 13:07:07.445931 after 3.36 seconds
[0m13:07:07.446207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095cbb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109888ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997d130>]}
[0m13:07:07.446408 [debug] [MainThread]: Flushing usage events
[0m13:07:08.204416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:49.964398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce6d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e0b7ed0>]}


============================== 13:26:49.966694 | 78a985c3-ad02-483f-aae2-b6636837b857 ==============================
[0m13:26:49.966694 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:26:49.966948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:26:50.024136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78a985c3-ad02-483f-aae2-b6636837b857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1955b0>]}
[0m13:26:50.043884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78a985c3-ad02-483f-aae2-b6636837b857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dfdef10>]}
[0m13:26:50.045025 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:26:50.087608 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:26:50.145646 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:26:50.145869 [debug] [MainThread]: previous checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m13:26:50.146006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '78a985c3-ad02-483f-aae2-b6636837b857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f18de50>]}
[0m13:26:50.818327 [warn ] [MainThread]: Invalid `scale`. Got: -2
[0m13:26:51.025725 [info ] [MainThread]: 13:26:51 + МОЕ сообщение 
[0m13:26:51.128602 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:26:51.128831 [info ] [MainThread]: 

[0m13:26:51.515425 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_prod.v_stg_flights__aircrafts' (models/stage/v_stg_flights__aircrafts.sql) depends on a node named 'raw_aircrafts' which was not found
[0m13:26:51.518323 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.575888, "process_in_blocks": "0", "process_kernel_time": 0.147523, "process_mem_max_rss": "138493952", "process_out_blocks": "0", "process_user_time": 1.909636}
[0m13:26:51.518499 [debug] [MainThread]: Command `cli build` failed at 13:26:51.518457 after 1.58 seconds
[0m13:26:51.518636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e66a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ef77980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7f58d0>]}
[0m13:26:51.518764 [debug] [MainThread]: Flushing usage events
[0m13:26:52.242346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:24.258915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11536d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1165b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1165b7ed0>]}


============================== 13:27:24.261059 | 1fb4f651-8f59-4198-819a-1b0bd049b518 ==============================
[0m13:27:24.261059 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:27:24.261302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:27:24.318377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fb4f651-8f59-4198-819a-1b0bd049b518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156955b0>]}
[0m13:27:24.337950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fb4f651-8f59-4198-819a-1b0bd049b518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163e2f10>]}
[0m13:27:24.339150 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:27:24.382090 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:27:24.439524 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:27:24.439745 [debug] [MainThread]: previous checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m13:27:24.439877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1fb4f651-8f59-4198-819a-1b0bd049b518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11778de50>]}
[0m13:27:25.112587 [warn ] [MainThread]: Invalid `scale`. Got: -2
[0m13:27:25.316463 [info ] [MainThread]: 13:27:25 + МОЕ сообщение 
[0m13:27:25.418220 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:27:25.418453 [info ] [MainThread]: 

[0m13:27:25.790751 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_prod.v_stg_flights__aircrafts' (models/stage/v_stg_flights__aircrafts.sql) depends on a node named 'raw_aircrafts' which was not found
[0m13:27:25.793372 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5563504, "process_in_blocks": "0", "process_kernel_time": 0.136434, "process_mem_max_rss": "136118272", "process_out_blocks": "0", "process_user_time": 1.887581}
[0m13:27:25.793544 [debug] [MainThread]: Command `cli build` failed at 13:27:25.793507 after 1.56 seconds
[0m13:27:25.793675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c4ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117cbc5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f25fd0>]}
[0m13:27:25.793801 [debug] [MainThread]: Flushing usage events
[0m13:27:26.462919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:26.713867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105941940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668bed0>]}


============================== 13:31:26.716239 | 01e8d015-9663-4544-85f6-b779d91bc484 ==============================
[0m13:31:26.716239 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:31:26.716480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:31:26.772591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01e8d015-9663-4544-85f6-b779d91bc484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b695b0>]}
[0m13:31:26.792474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01e8d015-9663-4544-85f6-b779d91bc484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065becf0>]}
[0m13:31:26.793681 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:31:26.837937 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:31:26.896255 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:31:26.896497 [debug] [MainThread]: previous checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m13:31:26.896646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01e8d015-9663-4544-85f6-b779d91bc484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b9e50>]}
[0m13:31:27.567000 [warn ] [MainThread]: Invalid `scale`. Got: -2
[0m13:31:27.773659 [info ] [MainThread]: 13:31:27 + МОЕ сообщение 
[0m13:31:27.874037 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:31:27.874275 [info ] [MainThread]: 

[0m13:31:28.246272 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_prod.v_stg_flights__aircrafts' (models/stage/v_stg_flights__aircrafts.sql) depends on a node named 'raw_aircrafts' which was not found
[0m13:31:28.249084 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5570458, "process_in_blocks": "0", "process_kernel_time": 0.141339, "process_mem_max_rss": "134381568", "process_out_blocks": "0", "process_user_time": 1.900255}
[0m13:31:28.249249 [debug] [MainThread]: Command `cli build` failed at 13:31:28.249214 after 1.56 seconds
[0m13:31:28.249379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c926c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b217f0>]}
[0m13:31:28.249500 [debug] [MainThread]: Flushing usage events
[0m13:31:28.946144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:36.176548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10680d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b7ed0>]}


============================== 13:32:36.178705 | b5b2ef85-df58-4954-9df0-629462fb3bf8 ==============================
[0m13:32:36.178705 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:32:36.178949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'version_check': 'True', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:36.237096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5b2ef85-df58-4954-9df0-629462fb3bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b955b0>]}
[0m13:32:36.257001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5b2ef85-df58-4954-9df0-629462fb3bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104def10>]}
[0m13:32:36.258312 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:36.298999 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:32:36.355480 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:32:36.355725 [debug] [MainThread]: previous checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m13:32:36.355867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5b2ef85-df58-4954-9df0-629462fb3bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11187de50>]}
[0m13:32:37.025874 [warn ] [MainThread]: Invalid `scale`. Got: -2
[0m13:32:37.232812 [info ] [MainThread]: 13:32:37 + МОЕ сообщение 
[0m13:32:37.334173 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:32:37.334402 [info ] [MainThread]: 

[0m13:32:37.746775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5b2ef85-df58-4954-9df0-629462fb3bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111f26c0>]}
[0m13:32:37.804369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:32:37.806854 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:32:37.824845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5b2ef85-df58-4954-9df0-629462fb3bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116dd0f0>]}
[0m13:32:37.825041 [info ] [MainThread]: Found 77 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m13:32:37.826587 [info ] [MainThread]: 
[0m13:32:37.826733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:37.826873 [info ] [MainThread]: 
[0m13:32:37.827104 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:37.827452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m13:32:37.846182 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m13:32:37.846356 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m13:32:37.846450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:37.865905 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.019 seconds
[0m13:32:37.866548 [debug] [ThreadPool]: On list_dbt_course: Close
[0m13:32:37.869576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_bookings_dbt)
[0m13:32:37.869766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m13:32:37.872139 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:32:37.872334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_snapshot'
[0m13:32:37.873070 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:32:37.873204 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m13:32:37.873915 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:32:37.874009 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m13:32:37.874090 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:37.874167 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m13:32:37.874239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:37.874383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:37.884614 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:32:37.884727 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:32:37.884828 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:32:37.884910 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:32:37.884997 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:32:37.885077 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:32:37.885167 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m13:32:37.885269 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m13:32:37.885369 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m13:32:37.892549 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m13:32:37.892672 [debug] [ThreadPool]: SQL status: SELECT 83 in 0.007 seconds
[0m13:32:37.893189 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m13:32:37.893287 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m13:32:37.894245 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m13:32:37.894825 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m13:32:37.894939 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m13:32:37.895422 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m13:32:37.895557 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m13:32:37.902363 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.902471 [debug] [MainThread]: On master: BEGIN
[0m13:32:37.902545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:37.907172 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:32:37.907294 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.907406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:37.911113 [debug] [MainThread]: SQL status: SELECT 35 in 0.004 seconds
[0m13:32:37.913278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5b2ef85-df58-4954-9df0-629462fb3bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146e1bf0>]}
[0m13:32:37.913448 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:37.913772 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.913898 [debug] [MainThread]: On master: BEGIN
[0m13:32:37.914264 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:32:37.914369 [debug] [MainThread]: On master: COMMIT
[0m13:32:37.914464 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.914548 [debug] [MainThread]: On master: COMMIT
[0m13:32:37.914771 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:37.914876 [debug] [MainThread]: On master: Close
[0m13:32:37.916288 [debug] [Thread-1 (]: Began running node model.dbt_prod.raw_aircrafts
[0m13:32:37.916464 [info ] [Thread-1 (]: 1 of 1 START sql table model bookings_dbt.raw_aircrafts ........................ [RUN]
[0m13:32:37.916613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_bookings_dbt, now model.dbt_prod.raw_aircrafts)
[0m13:32:37.916725 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.raw_aircrafts
[0m13:32:37.919669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.raw_aircrafts"
[0m13:32:37.919954 [debug] [Thread-1 (]: Began executing node model.dbt_prod.raw_aircrafts
[0m13:32:37.933197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.raw_aircrafts"
[0m13:32:37.933538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_aircrafts"
[0m13:32:37.933646 [debug] [Thread-1 (]: On model.dbt_prod.raw_aircrafts: BEGIN
[0m13:32:37.933733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:37.941738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:32:37.941865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_aircrafts"
[0m13:32:37.941968 [debug] [Thread-1 (]: On model.dbt_prod.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_aircrafts"} */

  
    

  create  table "dbt_course"."bookings_dbt"."raw_aircrafts__dbt_tmp"
  
  
    as
  
  (
    


SELECT
   aircraft_code,
    model,
    "range", 
   'bookings' as RECORD_SOURCE,
    now() as LOAD_DATE
FROM "dbt_course"."demo_src"."aircrafts"
  );
  
[0m13:32:37.955398 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.013 seconds
[0m13:32:37.959033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_aircrafts"
[0m13:32:37.959163 [debug] [Thread-1 (]: On model.dbt_prod.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_aircrafts"} */
alter table "dbt_course"."bookings_dbt"."raw_aircrafts__dbt_tmp" rename to "raw_aircrafts"
[0m13:32:37.959849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:32:37.960495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_aircrafts"
[0m13:32:37.960606 [debug] [Thread-1 (]: On model.dbt_prod.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_aircrafts"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'raw_aircrafts'
);
      
[0m13:32:37.962108 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m13:32:37.962763 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m13:32:37.962938 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m13:32:37.963081 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m13:32:37.963394 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m13:32:37.963572 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m13:32:37.963706 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m13:32:37.963822 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m13:32:37.963943 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m13:32:37.964052 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m13:32:37.964411 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m13:32:37.964540 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m13:32:37.964661 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m13:32:37.964767 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m13:32:37.964875 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m13:32:37.964979 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m13:32:37.965084 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m13:32:37.965187 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m13:32:37.965291 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m13:32:37.965394 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m13:32:37.965496 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m13:32:37.965602 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m13:32:37.965702 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m13:32:37.965807 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m13:32:37.965913 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m13:32:37.966016 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m13:32:37.966125 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m13:32:37.966229 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m13:32:37.966337 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m13:32:37.966445 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m13:32:37.966553 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m13:32:37.966652 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m13:32:37.966753 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m13:32:37.972264 [debug] [Thread-1 (]: On model.dbt_prod.raw_aircrafts: COMMIT
[0m13:32:37.972485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_aircrafts"
[0m13:32:37.972598 [debug] [Thread-1 (]: On model.dbt_prod.raw_aircrafts: COMMIT
[0m13:32:37.973835 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:32:37.976729 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."raw_aircrafts__dbt_backup"
[0m13:32:37.979040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.raw_aircrafts"
[0m13:32:37.979250 [debug] [Thread-1 (]: On model.dbt_prod.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.raw_aircrafts"} */
drop table if exists "dbt_course"."bookings_dbt"."raw_aircrafts__dbt_backup" cascade
[0m13:32:37.980080 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:32:37.981075 [debug] [Thread-1 (]: On model.dbt_prod.raw_aircrafts: Close
[0m13:32:37.982104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b2ef85-df58-4954-9df0-629462fb3bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115e16d0>]}
[0m13:32:37.982449 [info ] [Thread-1 (]: 1 of 1 OK created sql table model bookings_dbt.raw_aircrafts ................... [[32mSELECT 9[0m in 0.06s]
[0m13:32:37.982674 [debug] [Thread-1 (]: Finished running node model.dbt_prod.raw_aircrafts
[0m13:32:37.983272 [info ] [MainThread]: 
[0m13:32:37.983404 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.983495 [debug] [MainThread]: On master: BEGIN
[0m13:32:37.983577 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:37.988428 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:32:37.988586 [debug] [MainThread]: On master: COMMIT
[0m13:32:37.988671 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:37.988755 [debug] [MainThread]: On master: COMMIT
[0m13:32:37.989111 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:37.990492 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:32:37.990642 [info ] [MainThread]: 

[0m13:32:37.990828 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m13:32:37.992546 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m13:32:37.992750 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.00s]
[0m13:32:37.992877 [debug] [MainThread]: On master: Close
[0m13:32:37.993034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:37.993121 [debug] [MainThread]: Connection 'model.dbt_prod.raw_aircrafts' was properly closed.
[0m13:32:37.993196 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m13:32:37.993268 [debug] [MainThread]: Connection 'list_dbt_course_snapshot' was properly closed.
[0m13:32:37.993361 [info ] [MainThread]: 
[0m13:32:37.993455 [info ] [MainThread]: Finished running 1 project hook, 1 table model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m13:32:37.993896 [debug] [MainThread]: Command end result
[0m13:32:38.019304 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:32:38.020173 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:32:38.022144 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m13:32:38.022261 [info ] [MainThread]: 
[0m13:32:38.022413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:38.022508 [info ] [MainThread]: 
[0m13:32:38.022730 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:32:38.024572 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.8704094, "process_in_blocks": "0", "process_kernel_time": 0.161307, "process_mem_max_rss": "151781376", "process_out_blocks": "0", "process_user_time": 2.145074}
[0m13:32:38.024737 [debug] [MainThread]: Command `cli build` succeeded at 13:32:38.024704 after 1.87 seconds
[0m13:32:38.024863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115e4680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114917070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114917f70>]}
[0m13:32:38.024977 [debug] [MainThread]: Flushing usage events
[0m13:32:38.796574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:42.825456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb7ed0>]}


============================== 13:32:42.827182 | 56090320-984c-4b76-9b3e-42f596ce0e01 ==============================
[0m13:32:42.827182 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:32:42.827446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:42.882447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56090320-984c-4b76-9b3e-42f596ce0e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086955b0>]}
[0m13:32:42.903233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56090320-984c-4b76-9b3e-42f596ce0e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cdef10>]}
[0m13:32:42.903654 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:42.941727 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:32:43.017933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:43.018122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:43.049298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56090320-984c-4b76-9b3e-42f596ce0e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcb0e50>]}
[0m13:32:43.134739 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:32:43.135876 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:32:43.149964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56090320-984c-4b76-9b3e-42f596ce0e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5eef30>]}
[0m13:32:43.150176 [info ] [MainThread]: Found 77 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m13:32:43.151653 [info ] [MainThread]: 
[0m13:32:43.151806 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:43.152085 [info ] [MainThread]: 
[0m13:32:43.152326 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:43.152717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m13:32:43.167236 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m13:32:43.167412 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m13:32:43.167502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:43.186085 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.019 seconds
[0m13:32:43.186806 [debug] [ThreadPool]: On list_dbt_course: Close
[0m13:32:43.190144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_snapshot)
[0m13:32:43.190420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt'
[0m13:32:43.192660 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:32:43.192837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m13:32:43.193527 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:32:43.193634 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m13:32:43.194342 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:32:43.194438 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m13:32:43.194521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:43.194600 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m13:32:43.194672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:43.194822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:43.205628 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:32:43.205761 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:32:43.205873 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:32:43.205976 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:32:43.206071 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:32:43.206160 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:32:43.206259 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m13:32:43.206366 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m13:32:43.206470 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m13:32:43.209899 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m13:32:43.210415 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m13:32:43.210532 [debug] [ThreadPool]: SQL status: SELECT 84 in 0.004 seconds
[0m13:32:43.210626 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m13:32:43.211415 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m13:32:43.211517 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m13:32:43.211926 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m13:32:43.212573 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m13:32:43.212695 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m13:32:43.219857 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:43.220008 [debug] [MainThread]: On master: BEGIN
[0m13:32:43.220101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:43.225819 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:32:43.226126 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:43.226267 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:43.230814 [debug] [MainThread]: SQL status: SELECT 35 in 0.004 seconds
[0m13:32:43.233008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56090320-984c-4b76-9b3e-42f596ce0e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a514750>]}
[0m13:32:43.233194 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:43.233575 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:43.233661 [debug] [MainThread]: On master: BEGIN
[0m13:32:43.234154 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:32:43.234282 [debug] [MainThread]: On master: COMMIT
[0m13:32:43.234374 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:43.234450 [debug] [MainThread]: On master: COMMIT
[0m13:32:43.234718 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:43.234815 [debug] [MainThread]: On master: Close
[0m13:32:43.235736 [debug] [Thread-1 (]: Began running node model.dbt_prod.v_stg_flights__aircrafts
[0m13:32:43.235912 [info ] [Thread-1 (]: 1 of 1 START sql view model bookings_dbt.v_stg_flights__aircrafts .............. [RUN]
[0m13:32:43.236075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_snapshot, now model.dbt_prod.v_stg_flights__aircrafts)
[0m13:32:43.236232 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.v_stg_flights__aircrafts
[0m13:32:43.253560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:32:43.253748 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: BEGIN
[0m13:32:43.253849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:43.262366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:32:43.262506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:32:43.262609 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m13:32:43.276369 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.014 seconds
[0m13:32:43.296344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:32:43.296575 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m13:32:43.298419 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m13:32:43.319577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:32:43.320004 [debug] [Thread-1 (]: Began executing node model.dbt_prod.v_stg_flights__aircrafts
[0m13:32:43.331271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:32:43.331605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:32:43.331734 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */

  create view "dbt_course"."bookings_dbt"."v_stg_flights__aircrafts__dbt_tmp"
    
    
  as (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date

    FROM "dbt_course"."bookings_dbt"."raw_aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date,
    '1' AS SOURCE,
    LOAD_DATE AS LOAD_DATETIME,
    LOAD_DATE::date AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date,
    SOURCE,
    LOAD_DATETIME,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS AIRPORT_HK,

    DECODE(MD5(CONCAT_WS('||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'),
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRPORT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date,
    SOURCE,
    LOAD_DATETIME,
    EFFECTIVE_FROM,
    AIRPORT_HK,
    AIRPORT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
[0m13:32:43.334831 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "airport_code" does not exist
LINE 55:     DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHA...
                                               ^

[0m13:32:43.334933 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: ROLLBACK
[0m13:32:43.335752 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: Close
[0m13:32:43.339525 [debug] [Thread-1 (]: Database Error in model v_stg_flights__aircrafts (models/stage/v_stg_flights__aircrafts.sql)
  column "airport_code" does not exist
  LINE 55:     DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHA...
                                                 ^
  compiled code at target/run/dbt_prod/models/stage/v_stg_flights__aircrafts.sql
[0m13:32:43.340168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56090320-984c-4b76-9b3e-42f596ce0e01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c53fee0>]}
[0m13:32:43.340384 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bookings_dbt.v_stg_flights__aircrafts ..... [[31mERROR[0m in 0.10s]
[0m13:32:43.340585 [debug] [Thread-1 (]: Finished running node model.dbt_prod.v_stg_flights__aircrafts
[0m13:32:43.340815 [debug] [Thread-7 (]: Marking all children of 'model.dbt_prod.v_stg_flights__aircrafts' to be skipped because of status 'error'.  Reason: Database Error in model v_stg_flights__aircrafts (models/stage/v_stg_flights__aircrafts.sql)
  column "airport_code" does not exist
  LINE 55:     DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHA...
                                                 ^
  compiled code at target/run/dbt_prod/models/stage/v_stg_flights__aircrafts.sql.
[0m13:32:43.341510 [info ] [MainThread]: 
[0m13:32:43.341669 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:43.341816 [debug] [MainThread]: On master: BEGIN
[0m13:32:43.341909 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:43.348269 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:32:43.348413 [debug] [MainThread]: On master: COMMIT
[0m13:32:43.348512 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:43.348596 [debug] [MainThread]: On master: COMMIT
[0m13:32:43.349016 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:43.353209 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:32:43.353380 [info ] [MainThread]: 

[0m13:32:43.353562 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m13:32:43.354929 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m13:32:43.355098 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.01s]
[0m13:32:43.355252 [debug] [MainThread]: On master: Close
[0m13:32:43.355545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:43.355644 [debug] [MainThread]: Connection 'model.dbt_prod.v_stg_flights__aircrafts' was properly closed.
[0m13:32:43.355719 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt' was properly closed.
[0m13:32:43.355784 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m13:32:43.355870 [info ] [MainThread]: 
[0m13:32:43.356062 [info ] [MainThread]: Finished running 1 project hook, 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m13:32:43.356391 [debug] [MainThread]: Command end result
[0m13:32:43.381429 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:32:43.382286 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:32:43.384251 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m13:32:43.384349 [info ] [MainThread]: 
[0m13:32:43.384478 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:32:43.384574 [info ] [MainThread]: 
[0m13:32:43.384837 [error] [MainThread]:   Database Error in model v_stg_flights__aircrafts (models/stage/v_stg_flights__aircrafts.sql)
  column "airport_code" does not exist
  LINE 55:     DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHA...
                                                 ^
  compiled code at target/run/dbt_prod/models/stage/v_stg_flights__aircrafts.sql
[0m13:32:43.384936 [info ] [MainThread]: 
[0m13:32:43.385083 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:32:43.386639 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.58246905, "process_in_blocks": "0", "process_kernel_time": 0.12865, "process_mem_max_rss": "136249344", "process_out_blocks": "0", "process_user_time": 0.895088}
[0m13:32:43.386784 [debug] [MainThread]: Command `cli build` failed at 13:32:43.386752 after 0.58 seconds
[0m13:32:43.386908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4d6200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4d5ff0>]}
[0m13:32:43.387023 [debug] [MainThread]: Flushing usage events
[0m13:32:44.041781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:57.562394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104271940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbbed0>]}


============================== 13:32:57.565135 | 90f861f3-14cc-49df-976c-f06f69ba74d5 ==============================
[0m13:32:57.565135 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:32:57.565376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:57.622101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90f861f3-14cc-49df-976c-f06f69ba74d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044995b0>]}
[0m13:32:57.642951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90f861f3-14cc-49df-976c-f06f69ba74d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee6f10>]}
[0m13:32:57.643396 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:32:57.681962 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:32:57.756003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:57.756193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:57.786887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90f861f3-14cc-49df-976c-f06f69ba74d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed8e50>]}
[0m13:32:57.872468 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:32:57.873648 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:32:57.888096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90f861f3-14cc-49df-976c-f06f69ba74d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c2f30>]}
[0m13:32:57.888317 [info ] [MainThread]: Found 77 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m13:32:57.889821 [info ] [MainThread]: 
[0m13:32:57.889974 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:57.890125 [info ] [MainThread]: 
[0m13:32:57.890371 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:57.890726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m13:32:57.904913 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m13:32:57.905081 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m13:32:57.905175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:57.922808 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.018 seconds
[0m13:32:57.923478 [debug] [ThreadPool]: On list_dbt_course: Close
[0m13:32:57.926756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_snapshot)
[0m13:32:57.926967 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt'
[0m13:32:57.929109 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:32:57.929292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m13:32:57.929973 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:32:57.930101 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m13:32:57.930811 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:32:57.930907 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m13:32:57.930998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:57.931077 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m13:32:57.931150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:57.931292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:57.940885 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:32:57.941024 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:32:57.941134 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:32:57.941218 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:32:57.941306 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:32:57.941386 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:32:57.941474 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m13:32:57.941572 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m13:32:57.941669 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m13:32:57.944814 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m13:32:57.944911 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m13:32:57.945005 [debug] [ThreadPool]: SQL status: SELECT 84 in 0.003 seconds
[0m13:32:57.945471 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m13:32:57.945835 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m13:32:57.946539 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m13:32:57.947081 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m13:32:57.947184 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m13:32:57.947305 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m13:32:57.954978 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:57.955114 [debug] [MainThread]: On master: BEGIN
[0m13:32:57.955191 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:57.961085 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:32:57.961227 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:57.961349 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:57.964387 [debug] [MainThread]: SQL status: SELECT 35 in 0.003 seconds
[0m13:32:57.966620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90f861f3-14cc-49df-976c-f06f69ba74d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e3bd0>]}
[0m13:32:57.966810 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:57.967206 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:57.967291 [debug] [MainThread]: On master: BEGIN
[0m13:32:57.967849 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:32:57.967940 [debug] [MainThread]: On master: COMMIT
[0m13:32:57.968023 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:57.968099 [debug] [MainThread]: On master: COMMIT
[0m13:32:57.968361 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:57.968445 [debug] [MainThread]: On master: Close
[0m13:32:57.969438 [debug] [Thread-1 (]: Began running node model.dbt_prod.hub_aircrafts
[0m13:32:57.969599 [info ] [Thread-1 (]: 1 of 1 START sql incremental model bookings_dbt.hub_aircrafts .................. [RUN]
[0m13:32:57.969757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_snapshot, now model.dbt_prod.hub_aircrafts)
[0m13:32:57.969869 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.hub_aircrafts
[0m13:32:57.982557 [info ] [Thread-1 (]: 13:32:57 + Loading dbt_course.bookings_dbt.hub_aircrafts from 1 source(s)
[0m13:32:58.002470 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.hub_aircrafts"
[0m13:32:58.002931 [debug] [Thread-1 (]: Began executing node model.dbt_prod.hub_aircrafts
[0m13:32:58.020701 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.hub_aircrafts"
[0m13:32:58.021052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_aircrafts"
[0m13:32:58.021162 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: BEGIN
[0m13:32:58.021257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:58.029578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:32:58.029908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_aircrafts"
[0m13:32:58.030045 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_aircrafts"} */

      
  
    

  create  table "dbt_course"."bookings_dbt"."hub_aircrafts"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRPORT_HK) rr.AIRPORT_HK, rr.airport_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "dbt_course"."bookings_dbt"."v_stg_flights__aircrafts" AS rr
    WHERE rr.AIRPORT_HK IS NOT NULL
    ORDER BY rr.AIRPORT_HK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRPORT_HK, a.airport_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:32:58.030913 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bookings_dbt.v_stg_flights__aircrafts" does not exist
LINE 19:     FROM "dbt_course"."bookings_dbt"."v_stg_flights__aircraf...
                  ^

[0m13:32:58.031070 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: ROLLBACK
[0m13:32:58.031530 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: Close
[0m13:32:58.033603 [debug] [Thread-1 (]: Database Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  relation "bookings_dbt.v_stg_flights__aircrafts" does not exist
  LINE 19:     FROM "dbt_course"."bookings_dbt"."v_stg_flights__aircraf...
                    ^
  compiled code at target/run/dbt_prod/models/raw_vault/hubs/hub_aircrafts.sql
[0m13:32:58.034315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f861f3-14cc-49df-976c-f06f69ba74d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106526270>]}
[0m13:32:58.034688 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model bookings_dbt.hub_aircrafts ......... [[31mERROR[0m in 0.06s]
[0m13:32:58.034935 [debug] [Thread-1 (]: Finished running node model.dbt_prod.hub_aircrafts
[0m13:32:58.035128 [debug] [Thread-7 (]: Marking all children of 'model.dbt_prod.hub_aircrafts' to be skipped because of status 'error'.  Reason: Database Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  relation "bookings_dbt.v_stg_flights__aircrafts" does not exist
  LINE 19:     FROM "dbt_course"."bookings_dbt"."v_stg_flights__aircraf...
                    ^
  compiled code at target/run/dbt_prod/models/raw_vault/hubs/hub_aircrafts.sql.
[0m13:32:58.035783 [info ] [MainThread]: 
[0m13:32:58.035920 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:58.036003 [debug] [MainThread]: On master: BEGIN
[0m13:32:58.036078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:58.042139 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:32:58.042318 [debug] [MainThread]: On master: COMMIT
[0m13:32:58.042416 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:58.042496 [debug] [MainThread]: On master: COMMIT
[0m13:32:58.042899 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:58.047144 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:32:58.047293 [info ] [MainThread]: 

[0m13:32:58.047523 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m13:32:58.048891 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m13:32:58.049053 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.01s]
[0m13:32:58.049204 [debug] [MainThread]: On master: Close
[0m13:32:58.049407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:58.049492 [debug] [MainThread]: Connection 'model.dbt_prod.hub_aircrafts' was properly closed.
[0m13:32:58.049563 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt' was properly closed.
[0m13:32:58.049628 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m13:32:58.049710 [info ] [MainThread]: 
[0m13:32:58.049807 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:32:58.050131 [debug] [MainThread]: Command end result
[0m13:32:58.086872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:32:58.087760 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:32:58.089765 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m13:32:58.089869 [info ] [MainThread]: 
[0m13:32:58.089999 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:32:58.090098 [info ] [MainThread]: 
[0m13:32:58.090222 [error] [MainThread]:   Database Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  relation "bookings_dbt.v_stg_flights__aircrafts" does not exist
  LINE 19:     FROM "dbt_course"."bookings_dbt"."v_stg_flights__aircraf...
                    ^
  compiled code at target/run/dbt_prod/models/raw_vault/hubs/hub_aircrafts.sql
[0m13:32:58.090491 [info ] [MainThread]: 
[0m13:32:58.090625 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:32:58.091792 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.55189234, "process_in_blocks": "0", "process_kernel_time": 0.118994, "process_mem_max_rss": "134660096", "process_out_blocks": "0", "process_user_time": 0.886721}
[0m13:32:58.091936 [debug] [MainThread]: Command `cli build` failed at 13:32:58.091904 after 0.55 seconds
[0m13:32:58.092062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eece90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065359c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106535860>]}
[0m13:32:58.092180 [debug] [MainThread]: Flushing usage events
[0m13:32:58.762979 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:58.266858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ffed0>]}


============================== 13:33:58.269191 | a67f889f-987c-44bf-95e6-d7d8971dca09 ==============================
[0m13:33:58.269191 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:33:58.269429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:33:58.327892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a67f889f-987c-44bf-95e6-d7d8971dca09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dd5b0>]}
[0m13:33:58.348985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a67f889f-987c-44bf-95e6-d7d8971dca09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106426f10>]}
[0m13:33:58.349614 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:33:58.392438 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:33:58.489439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:58.489623 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:58.520269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a67f889f-987c-44bf-95e6-d7d8971dca09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741ce50>]}
[0m13:33:58.603687 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:33:58.605185 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:33:58.623649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a67f889f-987c-44bf-95e6-d7d8971dca09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b06f30>]}
[0m13:33:58.623862 [info ] [MainThread]: Found 77 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m13:33:58.625419 [info ] [MainThread]: 
[0m13:33:58.625563 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:33:58.625677 [info ] [MainThread]: 
[0m13:33:58.625956 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:33:58.626300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m13:33:58.646468 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m13:33:58.646724 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m13:33:58.646840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:58.664405 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.018 seconds
[0m13:33:58.665080 [debug] [ThreadPool]: On list_dbt_course: Close
[0m13:33:58.668157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_bookings_dbt)
[0m13:33:58.670403 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:33:58.670576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m13:33:58.670710 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m13:33:58.670861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_snapshot'
[0m13:33:58.671600 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:33:58.671710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:58.672418 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:33:58.672514 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m13:33:58.672661 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m13:33:58.672767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:58.672858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:58.680378 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:33:58.680475 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:33:58.680561 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m13:33:58.680672 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:33:58.680778 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:33:58.680873 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:33:58.680963 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:33:58.681055 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m13:33:58.681157 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m13:33:58.683489 [debug] [ThreadPool]: SQL status: SELECT 84 in 0.003 seconds
[0m13:33:58.683614 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m13:33:58.684519 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m13:33:58.684626 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m13:33:58.685267 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m13:33:58.685836 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m13:33:58.685954 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m13:33:58.689113 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m13:33:58.689203 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m13:33:58.693082 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:58.693190 [debug] [MainThread]: On master: BEGIN
[0m13:33:58.693264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:58.698683 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:33:58.698816 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:58.698931 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:33:58.701613 [debug] [MainThread]: SQL status: SELECT 35 in 0.003 seconds
[0m13:33:58.703833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a67f889f-987c-44bf-95e6-d7d8971dca09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107627310>]}
[0m13:33:58.704011 [debug] [MainThread]: On master: ROLLBACK
[0m13:33:58.704415 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:58.704509 [debug] [MainThread]: On master: BEGIN
[0m13:33:58.705363 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:33:58.705449 [debug] [MainThread]: On master: COMMIT
[0m13:33:58.705526 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:58.705607 [debug] [MainThread]: On master: COMMIT
[0m13:33:58.706126 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:33:58.706283 [debug] [MainThread]: On master: Close
[0m13:33:58.708209 [debug] [Thread-1 (]: Began running node model.dbt_prod.v_stg_flights__aircrafts
[0m13:33:58.708376 [info ] [Thread-1 (]: 1 of 1 START sql view model bookings_dbt.v_stg_flights__aircrafts .............. [RUN]
[0m13:33:58.708524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_bookings_dbt, now model.dbt_prod.v_stg_flights__aircrafts)
[0m13:33:58.708709 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.v_stg_flights__aircrafts
[0m13:33:58.726310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:33:58.726491 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: BEGIN
[0m13:33:58.726591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:58.734538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:33:58.734687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:33:58.734789 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m13:33:58.741384 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m13:33:58.759917 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:33:58.760130 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m13:33:58.763329 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m13:33:58.784056 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:33:58.784472 [debug] [Thread-1 (]: Began executing node model.dbt_prod.v_stg_flights__aircrafts
[0m13:33:58.795979 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:33:58.796382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:33:58.796541 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */

  create view "dbt_course"."bookings_dbt"."v_stg_flights__aircrafts__dbt_tmp"
    
    
  as (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date

    FROM "dbt_course"."bookings_dbt"."raw_aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date,
    '1' AS SOURCE,
    LOAD_DATE AS LOAD_DATETIME,
    LOAD_DATE::date AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date,
    SOURCE,
    LOAD_DATETIME,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS AIRPORT_HK,

    DECODE(MD5(CONCAT_WS('||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'),
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRPORT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date,
    SOURCE,
    LOAD_DATETIME,
    EFFECTIVE_FROM,
    AIRPORT_HK,
    AIRPORT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
[0m13:33:58.798183 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "airport_code" does not exist
LINE 55:     DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHA...
                                               ^

[0m13:33:58.798291 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: ROLLBACK
[0m13:33:58.798958 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: Close
[0m13:33:58.802773 [debug] [Thread-1 (]: Database Error in model v_stg_flights__aircrafts (models/stage/v_stg_flights__aircrafts.sql)
  column "airport_code" does not exist
  LINE 55:     DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHA...
                                                 ^
  compiled code at target/run/dbt_prod/models/stage/v_stg_flights__aircrafts.sql
[0m13:33:58.803547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a67f889f-987c-44bf-95e6-d7d8971dca09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae3ee0>]}
[0m13:33:58.803788 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model bookings_dbt.v_stg_flights__aircrafts ..... [[31mERROR[0m in 0.09s]
[0m13:33:58.803991 [debug] [Thread-1 (]: Finished running node model.dbt_prod.v_stg_flights__aircrafts
[0m13:33:58.804223 [debug] [Thread-7 (]: Marking all children of 'model.dbt_prod.v_stg_flights__aircrafts' to be skipped because of status 'error'.  Reason: Database Error in model v_stg_flights__aircrafts (models/stage/v_stg_flights__aircrafts.sql)
  column "airport_code" does not exist
  LINE 55:     DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHA...
                                                 ^
  compiled code at target/run/dbt_prod/models/stage/v_stg_flights__aircrafts.sql.
[0m13:33:58.804950 [info ] [MainThread]: 
[0m13:33:58.805116 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:58.805260 [debug] [MainThread]: On master: BEGIN
[0m13:33:58.805364 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:58.812300 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:33:58.812422 [debug] [MainThread]: On master: COMMIT
[0m13:33:58.812515 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:58.812593 [debug] [MainThread]: On master: COMMIT
[0m13:33:58.812884 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:33:58.817450 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:33:58.817645 [info ] [MainThread]: 

[0m13:33:58.817980 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m13:33:58.819432 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m13:33:58.819585 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.01s]
[0m13:33:58.819697 [debug] [MainThread]: On master: Close
[0m13:33:58.819846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:58.819919 [debug] [MainThread]: Connection 'model.dbt_prod.v_stg_flights__aircrafts' was properly closed.
[0m13:33:58.820009 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m13:33:58.820107 [debug] [MainThread]: Connection 'list_dbt_course_snapshot' was properly closed.
[0m13:33:58.820201 [info ] [MainThread]: 
[0m13:33:58.820300 [info ] [MainThread]: Finished running 1 project hook, 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m13:33:58.820655 [debug] [MainThread]: Command end result
[0m13:33:58.846161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:33:58.847176 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:33:58.849201 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m13:33:58.849297 [info ] [MainThread]: 
[0m13:33:58.849427 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:33:58.849526 [info ] [MainThread]: 
[0m13:33:58.849702 [error] [MainThread]:   Database Error in model v_stg_flights__aircrafts (models/stage/v_stg_flights__aircrafts.sql)
  column "airport_code" does not exist
  LINE 55:     DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHA...
                                                 ^
  compiled code at target/run/dbt_prod/models/stage/v_stg_flights__aircrafts.sql
[0m13:33:58.849853 [info ] [MainThread]: 
[0m13:33:58.850000 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:33:58.851561 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.606261, "process_in_blocks": "0", "process_kernel_time": 0.143343, "process_mem_max_rss": "134578176", "process_out_blocks": "0", "process_user_time": 0.902943}
[0m13:33:58.851722 [debug] [MainThread]: Command `cli build` failed at 13:33:58.851685 after 0.61 seconds
[0m13:33:58.851860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a72200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a71ff0>]}
[0m13:33:58.851989 [debug] [MainThread]: Flushing usage events
[0m13:33:59.603280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:32.556150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b7ed0>]}


============================== 13:34:32.557799 | 82df7529-c1a1-4f2c-a38e-435aa65d6d1a ==============================
[0m13:34:32.557799 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:34:32.558047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'version_check': 'True', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:34:32.614907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82df7529-c1a1-4f2c-a38e-435aa65d6d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e955b0>]}
[0m13:34:32.636063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82df7529-c1a1-4f2c-a38e-435aa65d6d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e2f10>]}
[0m13:34:32.636484 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:32.675444 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:34:32.751548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:34:32.751999 [debug] [MainThread]: Partial parsing: updated file: dbt_prod://models/stage/v_stg_flights__aircrafts.sql
[0m13:34:32.940905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82df7529-c1a1-4f2c-a38e-435aa65d6d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184bdf50>]}
[0m13:34:33.002085 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:34:33.003374 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:34:33.018232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82df7529-c1a1-4f2c-a38e-435aa65d6d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6af30>]}
[0m13:34:33.018476 [info ] [MainThread]: Found 77 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m13:34:33.020025 [info ] [MainThread]: 
[0m13:34:33.020174 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:33.020289 [info ] [MainThread]: 
[0m13:34:33.020563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:34:33.020984 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m13:34:33.038264 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m13:34:33.038458 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m13:34:33.038558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:33.056887 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.018 seconds
[0m13:34:33.057607 [debug] [ThreadPool]: On list_dbt_course: Close
[0m13:34:33.061105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_snapshot)
[0m13:34:33.061340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m13:34:33.063514 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:34:33.063703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt'
[0m13:34:33.064407 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:34:33.064541 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m13:34:33.066340 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:34:33.066471 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m13:34:33.066565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:33.066732 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m13:34:33.066899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:33.067074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:33.074846 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:34:33.074969 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:34:33.075106 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:34:33.075265 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:34:33.075397 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:34:33.075513 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m13:34:33.075614 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:34:33.075721 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m13:34:33.075880 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m13:34:33.078513 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m13:34:33.078617 [debug] [ThreadPool]: SQL status: SELECT 84 in 0.003 seconds
[0m13:34:33.078711 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m13:34:33.079195 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m13:34:33.079920 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m13:34:33.080285 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m13:34:33.080966 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m13:34:33.081069 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m13:34:33.081179 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m13:34:33.088253 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:33.088371 [debug] [MainThread]: On master: BEGIN
[0m13:34:33.088448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:33.094996 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:34:33.095123 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:33.095234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:34:33.100449 [debug] [MainThread]: SQL status: SELECT 35 in 0.005 seconds
[0m13:34:33.102710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82df7529-c1a1-4f2c-a38e-435aa65d6d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a90c90>]}
[0m13:34:33.102891 [debug] [MainThread]: On master: ROLLBACK
[0m13:34:33.103361 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:33.103441 [debug] [MainThread]: On master: BEGIN
[0m13:34:33.104018 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:34:33.104094 [debug] [MainThread]: On master: COMMIT
[0m13:34:33.104167 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:33.104237 [debug] [MainThread]: On master: COMMIT
[0m13:34:33.104616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:33.104695 [debug] [MainThread]: On master: Close
[0m13:34:33.105645 [debug] [Thread-1 (]: Began running node model.dbt_prod.v_stg_flights__aircrafts
[0m13:34:33.105946 [info ] [Thread-1 (]: 1 of 1 START sql view model bookings_dbt.v_stg_flights__aircrafts .............. [RUN]
[0m13:34:33.106097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_snapshot, now model.dbt_prod.v_stg_flights__aircrafts)
[0m13:34:33.106208 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.v_stg_flights__aircrafts
[0m13:34:33.114296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:34:33.114483 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: BEGIN
[0m13:34:33.114594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:33.121289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:34:33.121473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:34:33.121585 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m13:34:33.126922 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m13:34:33.129718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:34:33.129882 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_course".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'bookings_dbt'
        
      order by ordinal_position

  
[0m13:34:33.131884 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.002 seconds
[0m13:34:33.133601 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:34:33.134316 [debug] [Thread-1 (]: Began executing node model.dbt_prod.v_stg_flights__aircrafts
[0m13:34:33.147011 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:34:33.147365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:34:33.147492 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */

  create view "dbt_course"."bookings_dbt"."v_stg_flights__aircrafts__dbt_tmp"
    
    
  as (
    

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date

    FROM "dbt_course"."bookings_dbt"."raw_aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date,
    '1' AS SOURCE,
    LOAD_DATE AS LOAD_DATETIME,
    LOAD_DATE::date AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date,
    SOURCE,
    LOAD_DATETIME,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS AIRPORT_HK,

    DECODE(MD5(CONCAT_WS('||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'),
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS AIRPORT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    record_source,
    load_date,
    SOURCE,
    LOAD_DATETIME,
    EFFECTIVE_FROM,
    AIRPORT_HK,
    AIRPORT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
[0m13:34:33.152615 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:34:33.154820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:34:33.154929 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */
alter table "dbt_course"."bookings_dbt"."v_stg_flights__aircrafts__dbt_tmp" rename to "v_stg_flights__aircrafts"
[0m13:34:33.155410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:34:33.161538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:34:33.161723 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'v_stg_flights__aircrafts'
);
      
[0m13:34:33.162431 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m13:34:33.163169 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m13:34:33.163347 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m13:34:33.163490 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m13:34:33.163606 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m13:34:33.163718 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m13:34:33.163827 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m13:34:33.163938 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m13:34:33.164046 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m13:34:33.164151 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m13:34:33.164261 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m13:34:33.164376 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m13:34:33.164484 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m13:34:33.164594 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m13:34:33.164703 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m13:34:33.164807 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m13:34:33.164908 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m13:34:33.165015 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m13:34:33.165118 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m13:34:33.165226 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m13:34:33.165329 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m13:34:33.165434 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m13:34:33.165544 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m13:34:33.165648 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m13:34:33.165751 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m13:34:33.165857 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m13:34:33.165959 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m13:34:33.166065 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m13:34:33.166166 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m13:34:33.166270 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m13:34:33.166373 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m13:34:33.166473 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m13:34:33.166689 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m13:34:33.166885 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: COMMIT
[0m13:34:33.166986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:34:33.167076 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: COMMIT
[0m13:34:33.168279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:34:33.170672 [debug] [Thread-1 (]: Applying DROP to: "dbt_course"."bookings_dbt"."v_stg_flights__aircrafts__dbt_backup"
[0m13:34:33.172583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.v_stg_flights__aircrafts"
[0m13:34:33.172700 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.v_stg_flights__aircrafts"} */
drop view if exists "dbt_course"."bookings_dbt"."v_stg_flights__aircrafts__dbt_backup" cascade
[0m13:34:33.173295 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:34:33.174326 [debug] [Thread-1 (]: On model.dbt_prod.v_stg_flights__aircrafts: Close
[0m13:34:33.174932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82df7529-c1a1-4f2c-a38e-435aa65d6d1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192f0050>]}
[0m13:34:33.175138 [info ] [Thread-1 (]: 1 of 1 OK created sql view model bookings_dbt.v_stg_flights__aircrafts ......... [[32mCREATE VIEW[0m in 0.07s]
[0m13:34:33.175309 [debug] [Thread-1 (]: Finished running node model.dbt_prod.v_stg_flights__aircrafts
[0m13:34:33.175946 [info ] [MainThread]: 
[0m13:34:33.176143 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:33.176291 [debug] [MainThread]: On master: BEGIN
[0m13:34:33.176392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:33.182819 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:34:33.182923 [debug] [MainThread]: On master: COMMIT
[0m13:34:33.183003 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:33.183163 [debug] [MainThread]: On master: COMMIT
[0m13:34:33.183631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:33.187977 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:34:33.188110 [info ] [MainThread]: 

[0m13:34:33.188217 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m13:34:33.189443 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m13:34:33.189579 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.01s]
[0m13:34:33.189671 [debug] [MainThread]: On master: Close
[0m13:34:33.189804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:33.189873 [debug] [MainThread]: Connection 'model.dbt_prod.v_stg_flights__aircrafts' was properly closed.
[0m13:34:33.189935 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m13:34:33.189994 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt' was properly closed.
[0m13:34:33.190075 [info ] [MainThread]: 
[0m13:34:33.190161 [info ] [MainThread]: Finished running 1 project hook, 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m13:34:33.190397 [debug] [MainThread]: Command end result
[0m13:34:33.215880 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:34:33.216850 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:34:33.219102 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m13:34:33.219205 [info ] [MainThread]: 
[0m13:34:33.219342 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:34:33.219471 [info ] [MainThread]: 
[0m13:34:33.219704 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:34:33.221055 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.6865508, "process_in_blocks": "0", "process_kernel_time": 0.135064, "process_mem_max_rss": "145342464", "process_out_blocks": "0", "process_user_time": 1.020239}
[0m13:34:33.221187 [debug] [MainThread]: Command `cli build` succeeded at 13:34:33.221156 after 0.69 seconds
[0m13:34:33.221304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118aedb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118aedf40>]}
[0m13:34:33.221412 [debug] [MainThread]: Flushing usage events
[0m13:34:33.888982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:37.706258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0d940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b7ed0>]}


============================== 13:34:37.707882 | cec6f4c4-271c-47b5-94d9-470bb56ecbaa ==============================
[0m13:34:37.707882 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:34:37.708111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:34:37.762442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cec6f4c4-271c-47b5-94d9-470bb56ecbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055955b0>]}
[0m13:34:37.782814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cec6f4c4-271c-47b5-94d9-470bb56ecbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062def10>]}
[0m13:34:37.783233 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:37.821903 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:34:37.881756 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:34:37.881982 [debug] [MainThread]: previous checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m13:34:37.882119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cec6f4c4-271c-47b5-94d9-470bb56ecbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107281e50>]}
[0m13:34:38.543041 [warn ] [MainThread]: Invalid `scale`. Got: -2
[0m13:34:38.751635 [info ] [MainThread]: 13:34:38 + МОЕ сообщение 
[0m13:34:38.853109 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:34:38.853350 [info ] [MainThread]: 

[0m13:34:39.270915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cec6f4c4-271c-47b5-94d9-470bb56ecbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ee6c0>]}
[0m13:34:39.328950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:34:39.330128 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:34:39.343934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cec6f4c4-271c-47b5-94d9-470bb56ecbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708d0f0>]}
[0m13:34:39.344136 [info ] [MainThread]: Found 77 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m13:34:39.345696 [info ] [MainThread]: 
[0m13:34:39.345843 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:39.345965 [info ] [MainThread]: 
[0m13:34:39.346215 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:34:39.346561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m13:34:39.359831 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m13:34:39.360008 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m13:34:39.360102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:39.378976 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.019 seconds
[0m13:34:39.379667 [debug] [ThreadPool]: On list_dbt_course: Close
[0m13:34:39.382796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_bookings_dbt)
[0m13:34:39.382992 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m13:34:39.385498 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:34:39.385690 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_snapshot'
[0m13:34:39.386360 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:34:39.386484 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m13:34:39.387164 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:34:39.387256 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m13:34:39.387337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:39.387415 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m13:34:39.387488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:39.387630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:39.397729 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:34:39.397859 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:34:39.397954 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:34:39.398035 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:34:39.398122 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:34:39.398203 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:34:39.398291 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m13:34:39.398389 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m13:34:39.398485 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m13:34:39.401854 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m13:34:39.401971 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m13:34:39.402445 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m13:34:39.402535 [debug] [ThreadPool]: SQL status: SELECT 85 in 0.004 seconds
[0m13:34:39.402885 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m13:34:39.403659 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m13:34:39.403754 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m13:34:39.404260 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m13:34:39.404346 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m13:34:39.410755 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:39.410850 [debug] [MainThread]: On master: BEGIN
[0m13:34:39.410921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:39.417517 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:34:39.417601 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:39.417705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:34:39.422308 [debug] [MainThread]: SQL status: SELECT 36 in 0.004 seconds
[0m13:34:39.424499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec6f4c4-271c-47b5-94d9-470bb56ecbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e1640>]}
[0m13:34:39.424667 [debug] [MainThread]: On master: ROLLBACK
[0m13:34:39.425045 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:39.425147 [debug] [MainThread]: On master: BEGIN
[0m13:34:39.425651 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:34:39.425773 [debug] [MainThread]: On master: COMMIT
[0m13:34:39.425865 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:39.425947 [debug] [MainThread]: On master: COMMIT
[0m13:34:39.426189 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:39.426280 [debug] [MainThread]: On master: Close
[0m13:34:39.427225 [debug] [Thread-1 (]: Began running node model.dbt_prod.hub_aircrafts
[0m13:34:39.427391 [info ] [Thread-1 (]: 1 of 1 START sql incremental model bookings_dbt.hub_aircrafts .................. [RUN]
[0m13:34:39.427549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_bookings_dbt, now model.dbt_prod.hub_aircrafts)
[0m13:34:39.427659 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.hub_aircrafts
[0m13:34:39.431008 [info ] [Thread-1 (]: 13:34:39 + Loading dbt_course.bookings_dbt.hub_aircrafts from 1 source(s)
[0m13:34:39.432293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.hub_aircrafts"
[0m13:34:39.432646 [debug] [Thread-1 (]: Began executing node model.dbt_prod.hub_aircrafts
[0m13:34:39.451022 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.hub_aircrafts"
[0m13:34:39.451391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_aircrafts"
[0m13:34:39.451492 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: BEGIN
[0m13:34:39.451584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:39.459271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:34:39.459373 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_aircrafts"
[0m13:34:39.459469 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_aircrafts"} */

      
  
    

  create  table "dbt_course"."bookings_dbt"."hub_aircrafts"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRPORT_HK) rr.AIRPORT_HK, rr.airport_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "dbt_course"."bookings_dbt"."v_stg_flights__aircrafts" AS rr
    WHERE rr.AIRPORT_HK IS NOT NULL
    ORDER BY rr.AIRPORT_HK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRPORT_HK, a.airport_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:34:39.460712 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column rr.airport_code does not exist
LINE 18: ...SELECT DISTINCT ON (rr.AIRPORT_HK) rr.AIRPORT_HK, rr.airport...
                                                              ^

[0m13:34:39.460814 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: ROLLBACK
[0m13:34:39.461207 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: Close
[0m13:34:39.463196 [debug] [Thread-1 (]: Database Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  column rr.airport_code does not exist
  LINE 18: ...SELECT DISTINCT ON (rr.AIRPORT_HK) rr.AIRPORT_HK, rr.airport...
                                                                ^
  compiled code at target/run/dbt_prod/models/raw_vault/hubs/hub_aircrafts.sql
[0m13:34:39.463812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec6f4c4-271c-47b5-94d9-470bb56ecbaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107040050>]}
[0m13:34:39.464020 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model bookings_dbt.hub_aircrafts ......... [[31mERROR[0m in 0.04s]
[0m13:34:39.464208 [debug] [Thread-1 (]: Finished running node model.dbt_prod.hub_aircrafts
[0m13:34:39.464406 [debug] [Thread-7 (]: Marking all children of 'model.dbt_prod.hub_aircrafts' to be skipped because of status 'error'.  Reason: Database Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  column rr.airport_code does not exist
  LINE 18: ...SELECT DISTINCT ON (rr.AIRPORT_HK) rr.AIRPORT_HK, rr.airport...
                                                                ^
  compiled code at target/run/dbt_prod/models/raw_vault/hubs/hub_aircrafts.sql.
[0m13:34:39.465021 [info ] [MainThread]: 
[0m13:34:39.465137 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:39.465243 [debug] [MainThread]: On master: BEGIN
[0m13:34:39.465316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:39.472657 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:34:39.472758 [debug] [MainThread]: On master: COMMIT
[0m13:34:39.472836 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:39.472912 [debug] [MainThread]: On master: COMMIT
[0m13:34:39.473270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:39.474473 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:34:39.474597 [info ] [MainThread]: 

[0m13:34:39.474765 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m13:34:39.476613 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m13:34:39.476827 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.00s]
[0m13:34:39.476952 [debug] [MainThread]: On master: Close
[0m13:34:39.477149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:39.477251 [debug] [MainThread]: Connection 'model.dbt_prod.hub_aircrafts' was properly closed.
[0m13:34:39.477335 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m13:34:39.477401 [debug] [MainThread]: Connection 'list_dbt_course_snapshot' was properly closed.
[0m13:34:39.477485 [info ] [MainThread]: 
[0m13:34:39.477586 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m13:34:39.477899 [debug] [MainThread]: Command end result
[0m13:34:39.505038 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:34:39.505936 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:34:39.507835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m13:34:39.507932 [info ] [MainThread]: 
[0m13:34:39.508051 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:34:39.508141 [info ] [MainThread]: 
[0m13:34:39.508262 [error] [MainThread]:   Database Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  column rr.airport_code does not exist
  LINE 18: ...SELECT DISTINCT ON (rr.AIRPORT_HK) rr.AIRPORT_HK, rr.airport...
                                                                ^
  compiled code at target/run/dbt_prod/models/raw_vault/hubs/hub_aircrafts.sql
[0m13:34:39.508356 [info ] [MainThread]: 
[0m13:34:39.508454 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:34:39.509590 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.823015, "process_in_blocks": "0", "process_kernel_time": 0.133982, "process_mem_max_rss": "152092672", "process_out_blocks": "0", "process_user_time": 2.13977}
[0m13:34:39.509714 [debug] [MainThread]: Command `cli build` failed at 13:34:39.509686 after 1.82 seconds
[0m13:34:39.509832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10859ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f16d0>]}
[0m13:34:39.509937 [debug] [MainThread]: Flushing usage events
[0m13:34:40.278461 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:51.938306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d55940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa7ed0>]}


============================== 13:34:51.940021 | 635b770b-cfb4-450d-84bb-c6f1bc1b540a ==============================
[0m13:34:51.940021 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:34:51.940269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:34:51.994765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '635b770b-cfb4-450d-84bb-c6f1bc1b540a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f855b0>]}
[0m13:34:52.014489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '635b770b-cfb4-450d-84bb-c6f1bc1b540a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cef10>]}
[0m13:34:52.014872 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:52.053002 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m13:34:52.128173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:34:52.128581 [debug] [MainThread]: Partial parsing: updated file: dbt_prod://models/raw_vault/hubs/hub_aircrafts.sql
[0m13:34:52.291693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '635b770b-cfb4-450d-84bb-c6f1bc1b540a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e9f50>]}
[0m13:34:52.352359 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:34:52.353573 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:34:52.367719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '635b770b-cfb4-450d-84bb-c6f1bc1b540a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070aef30>]}
[0m13:34:52.367936 [info ] [MainThread]: Found 77 models, 4 snapshots, 11 analyses, 3 seeds, 1 operation, 32 data tests, 8 sources, 909 macros
[0m13:34:52.369393 [info ] [MainThread]: 
[0m13:34:52.369542 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:52.369646 [info ] [MainThread]: 
[0m13:34:52.369935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:34:52.370391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course'
[0m13:34:52.384901 [debug] [ThreadPool]: Using postgres connection "list_dbt_course"
[0m13:34:52.385064 [debug] [ThreadPool]: On list_dbt_course: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course"} */

    select distinct nspname from pg_namespace
  
[0m13:34:52.385153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:52.403153 [debug] [ThreadPool]: SQL status: SELECT 168 in 0.018 seconds
[0m13:34:52.403876 [debug] [ThreadPool]: On list_dbt_course: Close
[0m13:34:52.407494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_course, now list_dbt_course_snapshot)
[0m13:34:52.409747 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:34:52.409912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt'
[0m13:34:52.410008 [debug] [ThreadPool]: On list_dbt_course_snapshot: BEGIN
[0m13:34:52.410171 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_course_bookings_dbt_seeds'
[0m13:34:52.410884 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:34:52.410995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:52.411717 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:34:52.411818 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: BEGIN
[0m13:34:52.411978 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: BEGIN
[0m13:34:52.412069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:52.412159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:52.420238 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:34:52.420371 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:34:52.420460 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt_seeds"
[0m13:34:52.420553 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_bookings_dbt"
[0m13:34:52.420658 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt_seeds"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt_seeds'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt_seeds'
  
[0m13:34:52.420806 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_bookings_dbt"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bookings_dbt'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bookings_dbt'
  
[0m13:34:52.421415 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:34:52.421524 [debug] [ThreadPool]: Using postgres connection "list_dbt_course_snapshot"
[0m13:34:52.421616 [debug] [ThreadPool]: On list_dbt_course_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "list_dbt_course_snapshot"} */
select
      'dbt_course' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshot'
    union all
    select
      'dbt_course' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshot'
  
[0m13:34:52.423645 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m13:34:52.423753 [debug] [ThreadPool]: SQL status: SELECT 85 in 0.003 seconds
[0m13:34:52.424233 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: ROLLBACK
[0m13:34:52.424989 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: ROLLBACK
[0m13:34:52.425141 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m13:34:52.425781 [debug] [ThreadPool]: On list_dbt_course_snapshot: ROLLBACK
[0m13:34:52.425927 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt_seeds: Close
[0m13:34:52.426057 [debug] [ThreadPool]: On list_dbt_course_bookings_dbt: Close
[0m13:34:52.426288 [debug] [ThreadPool]: On list_dbt_course_snapshot: Close
[0m13:34:52.433710 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:52.433885 [debug] [MainThread]: On master: BEGIN
[0m13:34:52.433975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:52.439657 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:34:52.439788 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:52.439936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:34:52.442801 [debug] [MainThread]: SQL status: SELECT 36 in 0.003 seconds
[0m13:34:52.444933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '635b770b-cfb4-450d-84bb-c6f1bc1b540a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd6f90>]}
[0m13:34:52.445122 [debug] [MainThread]: On master: ROLLBACK
[0m13:34:52.445460 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:52.445551 [debug] [MainThread]: On master: BEGIN
[0m13:34:52.446151 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:34:52.446235 [debug] [MainThread]: On master: COMMIT
[0m13:34:52.446310 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:52.446379 [debug] [MainThread]: On master: COMMIT
[0m13:34:52.446610 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:52.446699 [debug] [MainThread]: On master: Close
[0m13:34:52.448108 [debug] [Thread-1 (]: Began running node model.dbt_prod.hub_aircrafts
[0m13:34:52.448329 [info ] [Thread-1 (]: 1 of 1 START sql incremental model bookings_dbt.hub_aircrafts .................. [RUN]
[0m13:34:52.448498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_course_snapshot, now model.dbt_prod.hub_aircrafts)
[0m13:34:52.448609 [debug] [Thread-1 (]: Began compiling node model.dbt_prod.hub_aircrafts
[0m13:34:52.457333 [info ] [Thread-1 (]: 13:34:52 + Loading dbt_course.bookings_dbt.hub_aircrafts from 1 source(s)
[0m13:34:52.458937 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_prod.hub_aircrafts"
[0m13:34:52.459384 [debug] [Thread-1 (]: Began executing node model.dbt_prod.hub_aircrafts
[0m13:34:52.478961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_prod.hub_aircrafts"
[0m13:34:52.479357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_aircrafts"
[0m13:34:52.479464 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: BEGIN
[0m13:34:52.479560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:52.486028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:34:52.486194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_aircrafts"
[0m13:34:52.486309 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_aircrafts"} */

      
  
    

  create  table "dbt_course"."bookings_dbt"."hub_aircrafts"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.AIRPORT_HK) rr.AIRPORT_HK, rr.aircraft_code, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "dbt_course"."bookings_dbt"."v_stg_flights__aircrafts" AS rr
    WHERE rr.AIRPORT_HK IS NOT NULL
    ORDER BY rr.AIRPORT_HK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.AIRPORT_HK, a.aircraft_code, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:34:52.490354 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m13:34:52.496538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_aircrafts"
[0m13:34:52.496676 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbt_prod", "target_name": "dev", "node_id": "model.dbt_prod.hub_aircrafts"} */

        create schema if not exists logs;
create table if not exists dbt_course.logs.dbt_logs (
  event_date timestamp,
  event_name varchar(100),
  node_name varchar(255)
);
insert into dbt_course.logs.dbt_logs
(event_date, event_name, node_name)
values(
  CURRENT_TIMESTAMP, 'run_model', 'hub_aircrafts'
);
      
[0m13:34:52.497526 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.001 seconds
[0m13:34:52.498182 [info ] [Thread-1 (]: ⚠️ Модель fct_tickets зависит от 2 объектов!
[0m13:34:52.498384 [info ] [Thread-1 (]: ⚠️ Модель stg_columns зависит от 2 объектов!
[0m13:34:52.498640 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_models зависит от 2 объектов!
[0m13:34:52.498785 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_sources зависит от 2 объектов!
[0m13:34:52.499016 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_source_tables зависит от 2 объектов!
[0m13:34:52.499174 [info ] [Thread-1 (]: ⚠️ Модель int_direct_relationships зависит от 4 объектов!
[0m13:34:52.499369 [info ] [Thread-1 (]: ⚠️ Модель int_all_graph_resources зависит от 6 объектов!
[0m13:34:52.499514 [info ] [Thread-1 (]: ⚠️ Модель fct_multiple_sources_joined зависит от 2 объектов!
[0m13:34:52.499675 [info ] [Thread-1 (]: ⚠️ Модель fct_root_models зависит от 2 объектов!
[0m13:34:52.499847 [info ] [Thread-1 (]: ⚠️ Модель fct_model_fanout зависит от 2 объектов!
[0m13:34:52.499989 [info ] [Thread-1 (]: ⚠️ Модель fct_unused_sources зависит от 2 объектов!
[0m13:34:52.500127 [info ] [Thread-1 (]: ⚠️ Модель fct_duplicate_sources зависит от 2 объектов!
[0m13:34:52.500278 [info ] [Thread-1 (]: ⚠️ Модель fct_source_fanout зависит от 2 объектов!
[0m13:34:52.500404 [info ] [Thread-1 (]: ⚠️ Модель fct_direct_join_to_source зависит от 2 объектов!
[0m13:34:52.500551 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_staging зависит от 2 объектов!
[0m13:34:52.500721 [info ] [Thread-1 (]: ⚠️ Модель fct_too_many_joins зависит от 2 объектов!
[0m13:34:52.500866 [info ] [Thread-1 (]: ⚠️ Модель fct_staging_dependent_on_marts_or_intermediate зависит от 2 объектов!
[0m13:34:52.500991 [info ] [Thread-1 (]: ⚠️ Модель fct_marts_or_intermediate_dependent_on_source зависит от 2 объектов!
[0m13:34:52.501155 [info ] [Thread-1 (]: ⚠️ Модель fct_hard_coded_references зависит от 2 объектов!
[0m13:34:52.501285 [info ] [Thread-1 (]: ⚠️ Модель fct_rejoining_of_upstream_concepts зависит от 2 объектов!
[0m13:34:52.501428 [info ] [Thread-1 (]: ⚠️ Модель fct_missing_primary_key_tests зависит от 2 объектов!
[0m13:34:52.501576 [info ] [Thread-1 (]: ⚠️ Модель fct_sources_without_freshness зависит от 2 объектов!
[0m13:34:52.501716 [info ] [Thread-1 (]: ⚠️ Модель int_model_test_summary зависит от 3 объектов!
[0m13:34:52.501844 [info ] [Thread-1 (]: ⚠️ Модель fct_undocumented_public_models зависит от 2 объектов!
[0m13:34:52.501979 [info ] [Thread-1 (]: ⚠️ Модель fct_exposures_dependent_on_private_models зависит от 2 объектов!
[0m13:34:52.502121 [info ] [Thread-1 (]: ⚠️ Модель fct_public_models_without_contract зависит от 2 объектов!
[0m13:34:52.502249 [info ] [Thread-1 (]: ⚠️ Модель fct_exposure_parents_materializations зависит от 2 объектов!
[0m13:34:52.502381 [info ] [Thread-1 (]: ⚠️ Модель fct_chained_views_dependencies зависит от 2 объектов!
[0m13:34:52.502516 [info ] [Thread-1 (]: ⚠️ Модель fct_source_directories зависит от 2 объектов!
[0m13:34:52.502650 [info ] [Thread-1 (]: ⚠️ Модель fct_test_directories зависит от 3 объектов!
[0m13:34:52.502949 [info ] [Thread-1 (]: ⚠️ Модель fct_model_naming_conventions зависит от 3 объектов!
[0m13:34:52.503097 [info ] [Thread-1 (]: ⚠️ Модель fct_model_directories зависит от 4 объектов!
[0m13:34:52.503299 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: COMMIT
[0m13:34:52.503418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_prod.hub_aircrafts"
[0m13:34:52.503510 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: COMMIT
[0m13:34:52.505284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:34:52.506019 [debug] [Thread-1 (]: On model.dbt_prod.hub_aircrafts: Close
[0m13:34:52.506662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635b770b-cfb4-450d-84bb-c6f1bc1b540a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a1cc0>]}
[0m13:34:52.506881 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model bookings_dbt.hub_aircrafts ............. [[32mSELECT 9[0m in 0.06s]
[0m13:34:52.507101 [debug] [Thread-1 (]: Finished running node model.dbt_prod.hub_aircrafts
[0m13:34:52.507834 [info ] [MainThread]: 
[0m13:34:52.508050 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:52.508174 [debug] [MainThread]: On master: BEGIN
[0m13:34:52.508252 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:52.514245 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:34:52.514409 [debug] [MainThread]: On master: COMMIT
[0m13:34:52.514508 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:52.514624 [debug] [MainThread]: On master: COMMIT
[0m13:34:52.514996 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:52.519055 [info ] [MainThread]: 
### List of issues raised by dbt_project_evaluator ###
[0m13:34:52.519181 [info ] [MainThread]: 

[0m13:34:52.519294 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_prod.dbt_prod-on-run-end-0"
[0m13:34:52.520640 [info ] [MainThread]: 1 of 1 START hook: dbt_prod.on-run-end.0 ....................................... [RUN]
[0m13:34:52.520785 [info ] [MainThread]: 1 of 1 OK hook: dbt_prod.on-run-end.0 .......................................... [[32mOK[0m in 0.01s]
[0m13:34:52.520884 [debug] [MainThread]: On master: Close
[0m13:34:52.521016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:52.521090 [debug] [MainThread]: Connection 'model.dbt_prod.hub_aircrafts' was properly closed.
[0m13:34:52.521155 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt' was properly closed.
[0m13:34:52.521216 [debug] [MainThread]: Connection 'list_dbt_course_bookings_dbt_seeds' was properly closed.
[0m13:34:52.521297 [info ] [MainThread]: 
[0m13:34:52.521376 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m13:34:52.521616 [debug] [MainThread]: Command end result
[0m13:34:52.548073 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/maksbolomoznov/dbt_prod/target/manifest.json
[0m13:34:52.548930 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/maksbolomoznov/dbt_prod/target/semantic_manifest.json
[0m13:34:52.550894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/maksbolomoznov/dbt_prod/target/run_results.json
[0m13:34:52.550988 [info ] [MainThread]: 
[0m13:34:52.551108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:34:52.551187 [info ] [MainThread]: 
[0m13:34:52.551281 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:34:52.552436 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.63466555, "process_in_blocks": "0", "process_kernel_time": 0.1192, "process_mem_max_rss": "141099008", "process_out_blocks": "0", "process_user_time": 0.968237}
[0m13:34:52.552564 [debug] [MainThread]: Command `cli build` succeeded at 13:34:52.552535 after 0.63 seconds
[0m13:34:52.552680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107856990>]}
[0m13:34:52.552789 [debug] [MainThread]: Flushing usage events
[0m13:34:53.217933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:58.232910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bab5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb7ed0>]}


============================== 16:19:58.235156 | 4d83dd8a-ffc7-4919-93b1-dfa10393afea ==============================
[0m16:19:58.235156 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:19:58.235443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/maksbolomoznov/dbt_prod', 'log_path': '/Users/maksbolomoznov/dbt_prod/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:19:58.272042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d83dd8a-ffc7-4919-93b1-dfa10393afea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf95f30>]}
[0m16:19:58.315178 [debug] [MainThread]: Set downloads directory='/var/folders/yp/69w4223n7pq42wk85kckfcrh0000gn/T/dbt-downloads-aub6y7oo'
[0m16:19:58.315404 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:19:58.824308 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:19:58.826357 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:19:59.034353 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:19:59.035817 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m16:19:59.283400 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m16:19:59.284973 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json
[0m16:19:59.547966 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_project_evaluator.json 200
[0m16:19:59.556019 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m16:19:59.914523 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m16:19:59.917786 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:20:00.584217 [info ] [MainThread]: Installed from version 1.3.0
[0m16:20:00.584457 [info ] [MainThread]: Up to date!
[0m16:20:00.584638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4d83dd8a-ffc7-4919-93b1-dfa10393afea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdee580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d06cc00>]}
[0m16:20:00.584980 [info ] [MainThread]: Installing dbt-labs/codegen
[0m16:20:01.029433 [info ] [MainThread]: Installed from version 0.13.1
[0m16:20:01.029729 [info ] [MainThread]: Up to date!
[0m16:20:01.029951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4d83dd8a-ffc7-4919-93b1-dfa10393afea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d012d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdd76b0>]}
[0m16:20:01.030381 [info ] [MainThread]: Installing dbt-labs/dbt_project_evaluator
[0m16:20:01.716509 [info ] [MainThread]: Installed from version 1.0.1
[0m16:20:01.716734 [info ] [MainThread]: Updated version available: 1.0.2
[0m16:20:01.716890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4d83dd8a-ffc7-4919-93b1-dfa10393afea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cffd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d098910>]}
[0m16:20:01.717063 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m16:20:02.353874 [info ] [MainThread]: Installed from version 0.11.2
[0m16:20:02.354074 [info ] [MainThread]: Up to date!
[0m16:20:02.354204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4d83dd8a-ffc7-4919-93b1-dfa10393afea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cde3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cde3350>]}
[0m16:20:02.354387 [info ] [MainThread]: 
[0m16:20:02.354573 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_project_evaluator']                 
Update your versions in packages.yml, then run dbt deps
[0m16:20:02.364565 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.154003, "process_in_blocks": "0", "process_kernel_time": 0.213081, "process_mem_max_rss": "109576192", "process_out_blocks": "0", "process_user_time": 0.581761}
[0m16:20:02.364847 [debug] [MainThread]: Command `cli deps` succeeded at 16:20:02.364796 after 4.15 seconds
[0m16:20:02.365014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdcbb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf88ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d081130>]}
[0m16:20:02.365141 [debug] [MainThread]: Flushing usage events
[0m16:20:03.162136 [debug] [MainThread]: An error was encountered while trying to flush usage events
